// For license information, see `http://img-prod-cms-rt-microsoft-com.akamaized.net/launch/store/launch-ENf7805d09fd1b455883333cdf34ee4ca2.js`.
window._satellite=window._satellite||{},window._satellite.container={buildInfo:{minified:!0,buildDate:"2024-07-03T19:59:05Z",turbineBuildDate:"2023-02-22T20:37:26Z",turbineVersion:"27.5.0"},environment:{id:"ENf7805d09fd1b455883333cdf34ee4ca2",stage:"production"},dataElements:{isSurfacePDP:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var t=new RegExp("/d/surface"),e=new RegExp("/p/surface");return t.test(window.location.pathname.toLowerCase())||e.test(window.location.pathname.toLowerCase())}}},isSurfaceCategory:{modulePath:"core/src/lib/dataElements/cookie.js",settings:{name:"test"}},isSurfaceBusiness:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return new RegExp("store/b/surfaceforbusiness").test(window.location.pathname.toLowerCase())}}},PageInfo:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){try{var t,e,n={pagename:"other",pageName:"other",pageType:"other",path:window.location.pathname.toLowerCase(),reflc:"",muid:"",pT:"",logRuleCall:function(t,e,n){if("object"==typeof _TMutils)_TMutils.logRuleCall(t,e,n);else try{_satellite.logger.error("error in logging and no _satellite obj")}catch(t){}},getQSParam:function(t,e){var n=0,o=t.length,a=[];for(n=0;n<o;n++)if((a=t[n].split("="))[0].toLowerCase()==e.toLowerCase()&&a[1])return a[1];return""},readCookie:function(t){for(var e=t+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var a=n[o];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(e))return a.substring(e.length,a.length)}return null},createCookie:function(t,e,n){var o,a="",r=~window.location.host.indexOf("microsoft.com")?"; domain=.microsoft.com; path=/; ":"; path=/; ";n&&((o=new Date).setTime(o.getTime()+24*n*60*60*1e3),a="; expires="+o.toGMTString()),document.cookie=t+"="+e+a+r}},o="",a=[],r={};if(document.referrer&&(reflc=document.referrer.toLowerCase()),0==(o=window.location.search?window.location.search:"").indexOf("?n=ensighten.html?")&&(o=o.substring(17)),0==o.indexOf("?")&&(o=o.substring(1)),a=(o=(o=o.replace(/%20&%20/g,"%20%26%20")).replace(/ & /g,"%20%26%20")).split("&"),~window.location.host.indexOf("compass-ssl.xboxlive.com")||~window.location.host.indexOf("query.prod.cms.rt.microsoft.com"))n.muid=n.getQSParam(a,"muid"),n.pageName=n.getQSParam(a,"pN"),n.pageType=n.pageName;else if("object"==typeof _pageBITags){e=(t=_pageBITags.pageTags).pageType.toLowerCase(),n.pageName=t.pageName,n.pageType=t.pageType;try{n.muid=n.readCookie("MUID")}catch(t){n.logRuleCall("muid err")}(~e.indexOf("pdp")||~e.indexOf("detail"))&&~n.path.indexOf("/configure/")&&(e="configure",n.pageType="configure")}try{(r={pdp:"detail","product details":"detail","sfw-pdp-pagetemplate":"detail","sfw-category-pagetemplate":"category","onestore-shoppingcart-template":"cart",congrats:"receipt"})[n.pageType.toLowerCase()]&&(n.pageType=r[n.pageType.toLowerCase()]),n.pT="receipt"==n.pageType?"rP":n.pageType,~window.location.pathname.indexOf("/b/")&&window.location.pathname.indexOf("RETg7o")<0&&(n.pageType="category")}catch(t){n.logRuleCall("pageTypeMapError",n.pageType)}n.pagename=n.pageName}catch(t){console.log("DataLayer: "+t.message)}}}},EventsHoliday:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return"div.card, div#coreui-contentplacement-f5d4afi, div#coreui-contentplacement-lzrgp5j, div#coreui-contentplacement-h1khlym, div#coreui-contentplacement-y1o0trq, div#coreui-contentplacement-qxreqji, div#StoreLocations-HighlightHero-6ywe7ix div div div div ul, div#coreui-contentplacement-zlfss3q, div#coreui-hero-npd01s8 div div div ul, div#coreui-contentplacement-a4imfpx, div#coreui-contentplacement-grqvg59, div#coreui-featurecollection-t1clixa div section ul, div#coreui-contentplacement-fiqwvm2, div#coreui-contentplacement-bkhqr5t, div#coreui-contentplacement-ntwsdzm, div#StoreLocations-HighlightHero-0qj0sa2, div#coreui-contentplacement-pwrxlcn, div.m-channel-placement a"}}},LocationInfo:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){try{var t,e,n,o={cc:"Unknown",geo:"",host:window.location.hostname.toLowerCase(),ll:"other",logRuleCall:function(t,e,n){if("object"==typeof _TMutils)_TMutils.logRuleCall(t,e,n);else try{_satellite.logger.error("error in logging and no _satellite obj")}catch(t){}},getQSParam:function(t,e){var n=0,o=t.length,a=[];for(n=0;n<o;n++)if((a=t[n].split("="))[0].toLowerCase()==e.toLowerCase()&&a[1])return a[1];return""},readCookie:function(t){for(var e=t+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var a=n[o];" "==a.charAt(0);)a=a.substring(1,a.length);if(0==a.indexOf(e))return a.substring(e.length,a.length)}return null},createCookie:function(t,e,n){var o,a="",r=~window.location.host.indexOf("microsoft.com")?"; domain=.microsoft.com; path=/; ":"; path=/; ";n&&((o=new Date).setTime(o.getTime()+24*n*60*60*1e3),a="; expires="+o.toGMTString()),document.cookie=t+"="+e+a+r}},a="",r=[],s="";if(0==(a=window.location.search?window.location.search:"").indexOf("?n=ensighten.html?")&&(a=a.substring(17)),0==a.indexOf("?")&&(a=a.substring(1)),r=(a=(a=a.replace(/%20&%20/g,"%20%26%20")).replace(/ & /g,"%20%26%20")).split("&"),~window.location.host.indexOf("compass-ssl.xboxlive.com")||~window.location.host.indexOf("query.prod.cms.rt.microsoft.com"))if(o.geo=o.getQSParam(r,"market"),o.ll=o.getQSParam(r,"culture")||o.getQSParam(r,"cl"),s=o.getQSParam(r,"orderLineItems"))try{s.indexOf("[")>-1?(s=(s=(s=(s=(s=(s=(s=(s=(s=s.replace(/%22%20Dis/g,"%20Dis")).replace(/portable%2013%22%20/g,"portable%2013%20")).replace(/%22%204K/g,"%204K")).replace(/%22Samsung%2049%22%20/g,"%22Samsung%2049%20")).replace(/%22%2F/g,"%2F")).replace(/5%22%20%2F/g,"5%2F")).replace(/%223%2F4%22%20/g,"%223%2F4%20")).replace(/15.6%22%20/g,"15.6%20")).replace(/%22/g,'"'),o.lineItems=JSON.parse(s)):(s=(s=(s=(s=(s=(s=(s=(s=s.replace(/%22%20Dis/g,"%20Dis")).replace(/portable%2013%22%20/g,"portable%2013%20")).replace(/%22Samsung%2049%22%20/g,"%22Samsung%2049%20")).replace(/%22%204K/g,"%204K")).replace(/%22%2F/g,"%2F")).replace(/5%22%20%2F/g,"5%2F")).replace(/%223%2F4%22%20/g,"%223%2F4%20")).replace(/15.6%22%20/g,"15.6%20"),o.lineItems=JSON.parse(decodeURIComponent(s)))}catch(t){o.logRuleCall("jsonparse error","jsonparse error",window.location.search),_satellite.logger.error("jsonparse error")}else o.logRuleCall("orderLineItems json missing");else"object"==typeof _pageBITags&&(n=(t=_pageBITags.pageTags).pageType.toLowerCase(),o.ll=t.mkt,o.lang=t.mkt.split("-")[0],o.geo=t.mkt.split("-")[1],(~n.indexOf("pdp")||~n.indexOf("detail"))&&"object"==typeof _pageBITags&&"object"==typeof _pageBITags.pageContracts&&"object"==typeof _pageBITags.pageContracts.ProductInfo&&(e=_pageBITags.pageContracts.ProductInfo,o.cc=e.cur));for(var i=0;i<o.lineItems.length;i++){try{decodeURIComponent(o.lineItems[i].ti)}catch(t){o.lineItems[i].ti&&o.lineItems[i].ti}o.lineItems[i].cur&&(o.cc=o.lineItems[i].cur)}var c="";"Unknown"==o.cc&&~window.location.host.indexOf("query.prod.cms.rt.microsoft.com")&&"receipt"==(c=~window.location.href.indexOf("pN=congrats")?"receipt":"cart")&&o.logRuleCall("missingCC"+c+"_"+o.geo,"missingCC_"+o.geo,window.location.search);var d={US:"USD",AU:"AUD",BR:"BRL",CA:"CAD",CH:"CHF",DK:"DKK",GB:"GBP",JP:"JPY",MX:"MXN",NO:"NOK",RU:"RUB",SE:"SEK",AT:"EUR",BE:"EUR",CY:"EUR",DE:"EUR",ES:"EUR",FI:"EUR",FR:"EUR",GR:"EUR",IR:"EUR",IT:"EUR",LU:"EUR",NL:"EUR",PT:"EUR",NEVERHIT:"Unknown"};if("Unknown"==o.cc||""==o.cc)try{d[o.geo.toUpperCase()]&&(o.cc=d[o.geo.toUpperCase()])}catch(t){}"Unknown"==o.cc&&(window.location.href.indexOf('"EUR"')>-1||window.location.href.indexOf("%22EUR%22")>-1)&&(o.cc="EUR"),o.pagename=o.pageName,window.location=window.location||o}catch(t){console.log("DataLayer: "+t.message)}}}},ProductInfo:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var t,e,n,o={busgrp:[],isprod:!1,itemprices:[],lineItems:[],pids:[],pidsku:[],pnames:[],prdCt:[],prdFam:[],prdPrCat:[],prdSecCat:[],prdSubCat:[],prdType:[],skus:[],quantities:[],totamount:0,totqty:0,purchaseID:""},a="",r=[],s="";if(document.referrer&&(reflc=document.referrer.toLowerCase()),0==(a=window.location.search?window.location.search:"").indexOf("?n=ensighten.html?")&&(a=a.substring(17)),0==a.indexOf("?")&&(a=a.substring(1)),r=(a=(a=a.replace(/%20&%20/g,"%20%26%20")).replace(/ & /g,"%20%26%20")).split("&"),~window.location.host.indexOf("compass-ssl.xboxlive.com")||~window.location.host.indexOf("query.prod.cms.rt.microsoft.com"))if(purchaseID=getQSParam(r,"orderId")||getQSParam(r,"id"),muid=getQSParam(r,"muid"),totamount=getQSParam(r,"totAmtWoTx"),s=getQSParam(r,"orderLineItems"),~reflc.indexOf("www.microsoft.com")&&window.navigator.userAgent.toLowerCase().indexOf("soasta")<0&&(isprod=!0),s)try{s.indexOf("[")>-1?(s=(s=(s=(s=(s=(s=(s=(s=(s=s.replace(/%22%20Dis/g,"%20Dis")).replace(/portable%2013%22%20/g,"portable%2013%20")).replace(/%22%204K/g,"%204K")).replace(/%22Samsung%2049%22%20/g,"%22Samsung%2049%20")).replace(/%22%2F/g,"%2F")).replace(/5%22%20%2F/g,"5%2F")).replace(/%223%2F4%22%20/g,"%223%2F4%20")).replace(/15.6%22%20/g,"15.6%20")).replace(/%22/g,'"'),lineItems=JSON.parse(s)):(s=(s=(s=(s=(s=(s=(s=(s=s.replace(/%22%20Dis/g,"%20Dis")).replace(/portable%2013%22%20/g,"portable%2013%20")).replace(/%22Samsung%2049%22%20/g,"%22Samsung%2049%20")).replace(/%22%204K/g,"%204K")).replace(/%22%2F/g,"%2F")).replace(/5%22%20%2F/g,"5%2F")).replace(/%223%2F4%22%20/g,"%223%2F4%20")).replace(/15.6%22%20/g,"15.6%20"),lineItems=JSON.parse(decodeURIComponent(s)))}catch(t){logRuleCall("jsonparse error","jsonparse error",window.location.search),_satellite.logger.error("jsonparse error")}else logRuleCall("orderLineItems json missing");else if("object"==typeof _pageBITags){e=_pageBITags.pageTags.pageType.toLowerCase(),~window.location.host.toLowerCase().indexOf("www.microsoft.com")&&window.navigator.userAgent.toLowerCase().indexOf("soasta")<0&&(isprod=!0);try{muid=readCookie("MUID")}catch(t){logRuleCall("muid err")}~e.indexOf("category")||((~e.indexOf("pdp")||~e.indexOf("detail"))&&"object"==typeof _pageBITags&&"object"==typeof _pageBITags.pageContracts&&"object"==typeof _pageBITags.pageContracts.ProductInfo?(t=_pageBITags.pageContracts.ProductInfo,pids.push(t.id),skus.push(t.sku),pidsku.push(t.id+"-"+t.sku),prdCt.push(t.prdCt),prdPrCat.push(t.priCat),prdSecCat.push(t.prdSecCat),prdSubCat.push(t.prdSubCat),prdType.push(t.family),pnames.push(t.title),quantities.push(1),sales.push(_pageBITags.pageContracts.ProductInfo.rtPrice),quantities.push(1),itemprices.push(sales[0])):(~e.indexOf("pdp")||~e.indexOf("detail"))&&~path.indexOf("/configure/")&&(e="configure",pageType="configure"))}for(var i=0;i<lineItems.length;i++){n="",pids.push(lineItems[i].pId?lineItems[i].pId:""),skus.push(lineItems[i].sku?lineItems[i].sku:"");try{n=decodeURIComponent(lineItems[i].ti)}catch(t){n=lineItems[i].ti?lineItems[i].ti:""}pnames.push(n),sales.push(lineItems[i].tot&&void 0!==lineItems[i].txA&&void 0!==lineItems[i].q?lineItems[i].tot-lineItems[i].q*lineItems[i].txA:lineItems[i].tot),prdPrCat.push(lineItems[i].pC?lineItems[i].pC:""),prdFam.push(lineItems[i].pF?lineItems[i].pF:""),prdType.push(lineItems[i].pT?lineItems[i].pT:""),pidsku.push(pids[i]+"-"+skus[i]),quantities.push(lineItems[i].q?lineItems[i].q:1),totqty+=quantities[i],itemprices.push(sales[i]/quantities[i])}return o}}},isPurchase:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}},isHoliday:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var t=window.location.pathname.toLowerCase(),e=new RegExp("(en-ca|fr-ca)/store/b/boxing-week"),n=new RegExp("(us|ca|jp|au)/store/b/cyber-monday"),o=new RegExp("(us|ca|jp|au)/store/b/black-friday"),a=new RegExp("/store/b/sale");return!!(e.test(t)||n.test(t)||o.test(t)||a.test(t))}}},isBusinessConsultation:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return new RegExp("store/b/business-consultation").test(window.location.pathname.toLowerCase())}}},isConsumerConsultation:{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){return new RegExp("store/b/online-computer-shopping-appointments").test(window.location.pathname.toLowerCase())}}},"Bing UET Custom - Amplify ":{modulePath:"core/src/lib/dataElements/customCode.js",settings:{source:function(){var t,e,n,o,a,r,s,i;t=window,e=document,n="script",o="//bat.bing.com/bat.js",t[a="uetq_Amplify"]=t[a]||[],r=function(){var e={ti:"149014572"};e.q=t[a],t[a]=new UET(e),t[a].push("pageLoad")},(s=e.createElement(n)).src=o,s.async=1,s.onload=s.onreadystatechange=function(){var t=this.readyState;t&&"loaded"!==t&&"complete"!==t||(r(),s.onload=s.onreadystatechange=null)},(i=e.getElementsByTagName(n)[0]).parentNode.insertBefore(s,i)}}}},extensions:{linkedin:{displayName:"LinkedIn Insight Tag",hostedLibFilesBaseUrl:"//img-prod-cms-rt-microsoft-com.akamaized.net/launch/store/5ef092d1efb5/21b18fecd107/0de9ba94be89/hostedLibFiles/EP56446adda5514f21aa663f9e3635ddaa/",settings:{insightTagID:"7850"},modules:{"linkedin/src/lib/actions/loadInsightTag.js":{name:"load-insight-tag",displayName:"Load Insight Tag",script:function(t,e,n,o){"use strict";t.exports=function(){var t=o.getExtensionSettings();if(t&&t.insightTagID){window._linkedin_data_partner_id=t.insightTagID;var e=document.getElementsByTagName("script")[0],n=document.createElement("script");n.type="text/javascript",n.async=!0,n.src="https://snap.licdn.com/li.lms-analytics/insight.min.js",e.parentNode.insertBefore(n,e)}}}}}},"google-adwords":{displayName:"Google Ads",hostedLibFilesBaseUrl:"//img-prod-cms-rt-microsoft-com.akamaized.net/launch/store/5ef092d1efb5/21b18fecd107/0de9ba94be89/hostedLibFiles/EP0c3eb682977f4498b44855d2e1d8c210/",modules:{}},"bing-ads-extension":{displayName:"Bing Ads UET Tag",hostedLibFilesBaseUrl:"//img-prod-cms-rt-microsoft-com.akamaized.net/launch/store/5ef092d1efb5/21b18fecd107/0de9ba94be89/hostedLibFiles/EP05eac6e292f1486a812623da300a51b4/",settings:{qname:"uetq_Amplify",tagid:"149014572",navTimingApi:!0,storeConvTrackCookies:!0},modules:{}},core:{displayName:"Core",hostedLibFilesBaseUrl:"//img-prod-cms-rt-microsoft-com.akamaized.net/launch/store/5ef092d1efb5/21b18fecd107/0de9ba94be89/hostedLibFiles/EP9f64ab5391d540b0bb8658a244bbeb36/",modules:{"core/src/lib/dataElements/customCode.js":{name:"custom-code",displayName:"Custom Code",script:function(t){"use strict";t.exports=function(t){return t.source()}}},"core/src/lib/dataElements/cookie.js":{name:"cookie",displayName:"Cookie",script:function(t,e,n){"use strict";var o=n("@adobe/reactor-cookie");t.exports=function(t){return o.get(t.name)}}},"core/src/lib/events/pageBottom.js":{name:"page-bottom",displayName:"Page Bottom",script:function(t,e,n){"use strict";var o=n("./helpers/pageLifecycleEvents");t.exports=function(t,e){o.registerPageBottomTrigger(e)}}},"core/src/lib/conditions/domain.js":{name:"domain",displayName:"Domain",script:function(t,e,n){"use strict";var o=n("@adobe/reactor-document"),a=n("../../../node_modules/escape-string-regexp/index.js");t.exports=function(t){var e=o.location.hostname;return t.domains.some((function(t){return e.match(new RegExp("(^|\\.)"+a(t)+"$","i"))}))}}},"core/src/lib/conditions/path.js":{name:"path",displayName:"Path Without Query String",script:function(t,e,n){"use strict";var o=n("@adobe/reactor-document"),a=n("../helpers/textMatch");t.exports=function(t){var e=o.location.pathname;return t.paths.some((function(t){var n=t.valueIsRegex?new RegExp(t.value,"i"):t.value;return a(e,n)}))}}},"core/src/lib/actions/customCode.js":{name:"custom-code",displayName:"Custom Code",script:function(t,e,n,o){"use strict";var a,r,s,i=n("@adobe/reactor-document"),c=n("./helpers/decorateCode"),d=n("./helpers/loadCodeSequentially"),u=n("../../../node_modules/postscribe/dist/postscribe"),l=(a=function(t){u(i.body,t,{error:function(t){o.logger.error(t.msg)}})},r=[],s=function(){if(i.body)for(;r.length;)a(r.shift());else setTimeout(s,20)},function(t){r.push(t),s()}),p=function(){if(i.currentScript)return i.currentScript.async;for(var t=i.querySelectorAll("script"),e=0;e<t.length;e++){var n=t[e];if(/(launch|satelliteLib)-[^\/]+.js(\?.*)?$/.test(n.src))return n.async}return!0}();t.exports=function(t,e){var n={settings:t,event:e},o=n.settings.source;if(o)return n.settings.isExternal?d(o).then((function(t){t&&l(c(n,t))})):void(p||"loading"!==i.readyState?l(c(n,o)):i.write?i.write(c(n,o)):l(c(n,o)))}}},"core/src/lib/events/libraryLoaded.js":{name:"library-loaded",displayName:"Library Loaded (Page Top)",script:function(t,e,n){"use strict";var o=n("./helpers/pageLifecycleEvents");t.exports=function(t,e){o.registerLibraryLoadedTrigger(e)}}},"core/src/lib/conditions/customCode.js":{name:"custom-code",displayName:"Custom Code",script:function(t){"use strict";t.exports=function(t,e){return t.source.call(e.element,e,e.target)}}},"core/src/lib/conditions/dateRange.js":{name:"date-range",displayName:"Date Range",script:function(t){"use strict";t.exports=function(t){var e=new Date;return!(t.start&&e<new Date(t.start)||t.end&&e>new Date(t.end))}}},"core/src/lib/conditions/sessions.js":{name:"sessions",displayName:"Sessions",script:function(t,e,n){"use strict";var o=n("../helpers/visitorTracking"),a=n("./helpers/compareNumbers");t.exports=function(t){return a(o.getSessionCount(),t.operator,t.count)}}},"core/src/lib/events/helpers/pageLifecycleEvents.js":{script:function(t,e,n){"use strict";var o=n("@adobe/reactor-window"),a=n("@adobe/reactor-document"),r=-1!==o.navigator.appVersion.indexOf("MSIE 10"),s="WINDOW_LOADED",i="DOM_READY",c="PAGE_BOTTOM",d=[c,i,s],u=function(t,e){return{element:t,target:t,nativeEvent:e}},l={};d.forEach((function(t){l[t]=[]}));var p=function(t,e){d.slice(0,g(t)+1).forEach((function(t){f(e,t)}))},m=function(){return"complete"===a.readyState?s:"interactive"===a.readyState?r?null:i:void 0},g=function(t){return d.indexOf(t)},f=function(t,e){l[e].forEach((function(e){h(t,e)})),l[e]=[]},h=function(t,e){var n=e.trigger,o=e.syntheticEventFn;n(o?o(t):null)};o._satellite=o._satellite||{},o._satellite.pageBottom=p.bind(null,c),a.addEventListener("DOMContentLoaded",p.bind(null,i),!0),o.addEventListener("load",p.bind(null,s),!0),o.setTimeout((function(){var t=m();t&&p(t)}),0),t.exports={registerLibraryLoadedTrigger:function(t){t()},registerPageBottomTrigger:function(t){l[c].push({trigger:t})},registerDomReadyTrigger:function(t){l[i].push({trigger:t,syntheticEventFn:u.bind(null,a)})},registerWindowLoadedTrigger:function(t){l[s].push({trigger:t,syntheticEventFn:u.bind(null,o)})}}}},"core/node_modules/escape-string-regexp/index.js":{script:function(t){"use strict";var e=/[|\\{}()[\]^$+*?.]/g;t.exports=function(t){if("string"!=typeof t)throw new TypeError("Expected a string");return t.replace(e,"\\$&")}}},"core/src/lib/helpers/textMatch.js":{script:function(t){"use strict";t.exports=function(t,e){if(null==e)throw new Error("Illegal Argument: Pattern is not present");return null!=t&&("string"==typeof e?t===e:e instanceof RegExp&&e.test(t))}}},"core/src/lib/actions/helpers/decorateCode.js":{script:function(t,e,n,o){"use strict";var a=0,r=function(t){return t.settings.isExternal},s=function(t,e){return"<script>\n"+e+"\n</script>"},i=function(t,e){var n="__runScript"+ ++a;return _satellite[n]=function(e){e.call(t.event.element,t.event,t.event.target),delete _satellite[n]},'<script>_satellite["'+n+'"](function(event, target) {\n'+e+"\n});</script>"},c={javascript:function(t,e){return t.settings.global?s(t,e):i(t,e)},html:function(t,e){return r(t)?o.replaceTokens(e,t.event):e}};t.exports=function(t,e){return c[t.settings.language](t,e)}}},"core/src/lib/actions/helpers/loadCodeSequentially.js":{script:function(t,e,n){"use strict";var o=n("@adobe/reactor-promise"),a=n("./getSourceByUrl"),r=o.resolve();t.exports=function(t){var e=new o((function(e){var n=a(t);o.all([n,r]).then((function(t){var n=t[0];e(n)}))}));return r=e,e}}},"core/node_modules/postscribe/dist/postscribe.js":{script:function(t,e){var n,o;n=this,o=function(){return function(t){function e(o){if(n[o])return n[o].exports;var a=n[o]={exports:{},id:o,loaded:!1};return t[o].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}var a=o(n(1));t.exports=a.default},function(t,e,n){"use strict";function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function a(t){return t&&t.__esModule?t:{default:t}}function r(){}function s(){var t=g.shift();if(t){var e=l.last(t);e.afterDequeue(),t.stream=i.apply(void 0,t),e.afterStreamStart()}}function i(t,e,n){function o(t){t=n.beforeWrite(t),f.write(t),n.afterWrite(t)}(f=new u.default(t,n)).id=m++,f.name=n.name||f.id,c.streams[f.name]=f;var a=t.ownerDocument,i={close:a.close,open:a.open,write:a.write,writeln:a.writeln};d(a,{close:r,open:r,write:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return o(e.join(""))},writeln:function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return o(e.join("")+"\n")}});var l=f.win.onerror||r;return f.win.onerror=function(t,e,o){n.error({msg:t+" - "+e+": "+o}),l.apply(f.win,[t,e,o])},f.write(e,(function(){d(a,i),f.win.onerror=l,n.done(),f=null,s()})),f}function c(t,e,n){if(l.isFunction(n))n={done:n};else if("clear"===n)return g=[],f=null,void(m=0);n=l.defaults(n,p);var o=[t=/^#/.test(t)?window.document.getElementById(t.substr(1)):t.jquery?t[0]:t,e,n];return t.postscribe={cancel:function(){o.stream?o.stream.abort():o[1]=r}},n.beforeEnqueue(o),g.push(o),f||s(),t.postscribe}e.__esModule=!0;var d=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t};e.default=c;var u=a(n(2)),l=o(n(4)),p={afterAsync:r,afterDequeue:r,afterStreamStart:r,afterWrite:r,autoFix:!0,beforeEnqueue:r,beforeWriteToken:function(t){return t},beforeWrite:function(t){return t},done:r,error:function(t){throw new Error(t.msg)},releaseAsync:!1},m=0,g=[],f=null;d(c,{streams:{},queue:g,WriteStream:u.default})},function(t,e,n){"use strict";function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function a(t){return t&&t.__esModule?t:{default:t}}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){var n=p+e,o=t.getAttribute(n);return u.existy(o)?String(o):o}function i(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=p+e;u.existy(n)&&""!==n?t.setAttribute(o,n):t.removeAttribute(o)}e.__esModule=!0;var c=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},d=a(n(3)),u=o(n(4)),l=!1,p="data-ps-",m="ps-style",g="ps-script",f=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,t),this.root=e,this.options=n,this.doc=e.ownerDocument,this.win=this.doc.defaultView||this.doc.parentWindow,this.parser=new d.default("",{autoFix:n.autoFix}),this.actuals=[e],this.proxyHistory="",this.proxyRoot=this.doc.createElement(e.nodeName),this.scriptStack=[],this.writeQueue=[],i(this.proxyRoot,"proxyof",0)}return t.prototype.write=function(){var t;for((t=this.writeQueue).push.apply(t,arguments);!this.deferredRemote&&this.writeQueue.length;){var e=this.writeQueue.shift();u.isFunction(e)?this._callFunction(e):this._writeImpl(e)}},t.prototype._callFunction=function(t){var e={type:"function",value:t.name||t.toString()};this._onScriptStart(e),t.call(this.win,this.doc),this._onScriptDone(e)},t.prototype._writeImpl=function(t){this.parser.append(t);for(var e=void 0,n=void 0,o=void 0,a=[];(e=this.parser.readToken())&&!(n=u.isScript(e))&&!(o=u.isStyle(e));)(e=this.options.beforeWriteToken(e))&&a.push(e);a.length>0&&this._writeStaticTokens(a),n&&this._handleScriptToken(e),o&&this._handleStyleToken(e)},t.prototype._writeStaticTokens=function(t){var e=this._buildChunk(t);return e.actual?(e.html=this.proxyHistory+e.actual,this.proxyHistory+=e.proxy,this.proxyRoot.innerHTML=e.html,l&&(e.proxyInnerHTML=this.proxyRoot.innerHTML),this._walkChunk(),l&&(e.actualInnerHTML=this.root.innerHTML),e):null},t.prototype._buildChunk=function(t){for(var e=this.actuals.length,n=[],o=[],a=[],r=t.length,s=0;s<r;s++){var i=t[s],c=i.toString();if(n.push(c),i.attrs){if(!/^noscript$/i.test(i.tagName)){var d=e++;o.push(c.replace(/(\/?>)/," "+p+"id="+d+" $1")),i.attrs.id!==g&&i.attrs.id!==m&&a.push("atomicTag"===i.type?"":"<"+i.tagName+" "+p+"proxyof="+d+(i.unary?" />":">"))}}else o.push(c),a.push("endTag"===i.type?c:"")}return{tokens:t,raw:n.join(""),actual:o.join(""),proxy:a.join("")}},t.prototype._walkChunk=function(){for(var t=void 0,e=[this.proxyRoot];u.existy(t=e.shift());){var n=1===t.nodeType;if(!n||!s(t,"proxyof")){n&&(this.actuals[s(t,"id")]=t,i(t,"id"));var o=t.parentNode&&s(t.parentNode,"proxyof");o&&this.actuals[o].appendChild(t)}e.unshift.apply(e,u.toArray(t.childNodes))}},t.prototype._handleScriptToken=function(t){var e=this,n=this.parser.clear();n&&this.writeQueue.unshift(n),t.src=t.attrs.src||t.attrs.SRC,(t=this.options.beforeWriteToken(t))&&(t.src&&this.scriptStack.length?this.deferredRemote=t:this._onScriptStart(t),this._writeScriptToken(t,(function(){e._onScriptDone(t)})))},t.prototype._handleStyleToken=function(t){var e=this.parser.clear();e&&this.writeQueue.unshift(e),t.type=t.attrs.type||t.attrs.TYPE||"text/css",(t=this.options.beforeWriteToken(t))&&this._writeStyleToken(t),e&&this.write()},t.prototype._writeStyleToken=function(t){var e=this._buildStyle(t);this._insertCursor(e,m),t.content&&(e.styleSheet&&!e.sheet?e.styleSheet.cssText=t.content:e.appendChild(this.doc.createTextNode(t.content)))},t.prototype._buildStyle=function(t){var e=this.doc.createElement(t.tagName);return e.setAttribute("type",t.type),u.eachKey(t.attrs,(function(t,n){e.setAttribute(t,n)})),e},t.prototype._insertCursor=function(t,e){this._writeImpl('<span id="'+e+'"/>');var n=this.doc.getElementById(e);n&&n.parentNode.replaceChild(t,n)},t.prototype._onScriptStart=function(t){t.outerWrites=this.writeQueue,this.writeQueue=[],this.scriptStack.unshift(t)},t.prototype._onScriptDone=function(t){t===this.scriptStack[0]?(this.scriptStack.shift(),this.write.apply(this,t.outerWrites),!this.scriptStack.length&&this.deferredRemote&&(this._onScriptStart(this.deferredRemote),this.deferredRemote=null)):this.options.error({msg:"Bad script nesting or script finished twice"})},t.prototype._writeScriptToken=function(t,e){var n=this._buildScript(t),o=this._shouldRelease(n),a=this.options.afterAsync;t.src&&(n.src=t.src,this._scriptLoadHandler(n,o?a:function(){e(),a()}));try{this._insertCursor(n,g),n.src&&!o||e()}catch(t){this.options.error(t),e()}},t.prototype._buildScript=function(t){var e=this.doc.createElement(t.tagName);return u.eachKey(t.attrs,(function(t,n){e.setAttribute(t,n)})),t.content&&(e.text=t.content),e},t.prototype._scriptLoadHandler=function(t,e){function n(){t=t.onload=t.onreadystatechange=t.onerror=null}function o(){n(),null!=e&&e(),e=null}function a(t){n(),s(t),null!=e&&e(),e=null}function r(t,e){var n=t["on"+e];null!=n&&(t["_on"+e]=n)}var s=this.options.error;r(t,"load"),r(t,"error"),c(t,{onload:function(){if(t._onload)try{t._onload.apply(this,Array.prototype.slice.call(arguments,0))}catch(e){a({msg:"onload handler failed "+e+" @ "+t.src})}o()},onerror:function(){if(t._onerror)try{t._onerror.apply(this,Array.prototype.slice.call(arguments,0))}catch(e){return void a({msg:"onerror handler failed "+e+" @ "+t.src})}a({msg:"remote script failed "+t.src})},onreadystatechange:function(){/^(loaded|complete)$/.test(t.readyState)&&o()}})},t.prototype._shouldRelease=function(t){return!/^script$/i.test(t.nodeName)||!!(this.options.releaseAsync&&t.src&&t.hasAttribute("async"))},t}();e.default=f},function(t){var e;e=function(){return function(t){function e(o){if(n[o])return n[o].exports;var a=n[o]={exports:{},id:o,loaded:!1};return t[o].call(a.exports,a,a.exports,e),a.loaded=!0,a.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}var a=o(n(1));t.exports=a.default},function(t,e,n){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}function a(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0;var s=a(n(2)),i=a(n(3)),c=o(n(6)),d=n(5),u={comment:/^<!--/,endTag:/^<\//,atomicTag:/^<\s*(script|style|noscript|iframe|textarea)[\s\/>]/i,startTag:/^</,chars:/^[^<]/},l=function(){function t(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r(this,t),this.stream=n;var a=!1,i={};for(var d in s)s.hasOwnProperty(d)&&(o.autoFix&&(i[d+"Fix"]=!0),a=a||i[d+"Fix"]);a?(this._readToken=(0,c.default)(this,i,(function(){return e._readTokenImpl()})),this._peekToken=(0,c.default)(this,i,(function(){return e._peekTokenImpl()}))):(this._readToken=this._readTokenImpl,this._peekToken=this._peekTokenImpl)}return t.prototype.append=function(t){this.stream+=t},t.prototype.prepend=function(t){this.stream=t+this.stream},t.prototype._readTokenImpl=function(){var t=this._peekTokenImpl();if(t)return this.stream=this.stream.slice(t.length),t},t.prototype._peekTokenImpl=function(){for(var t in u)if(u.hasOwnProperty(t)&&u[t].test(this.stream)){var e=i[t](this.stream);if(e)return"startTag"===e.type&&/script|style/i.test(e.tagName)?null:(e.text=this.stream.substr(0,e.length),e)}},t.prototype.peekToken=function(){return this._peekToken()},t.prototype.readToken=function(){return this._readToken()},t.prototype.readTokens=function(t){for(var e=void 0;e=this.readToken();)if(t[e.type]&&!1===t[e.type](e))return},t.prototype.clear=function(){var t=this.stream;return this.stream="",t},t.prototype.rest=function(){return this.stream},t}();for(var p in e.default=l,l.tokenToString=function(t){return t.toString()},l.escapeAttributes=function(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[n]=(0,d.escapeQuotes)(t[n],null));return e},l.supports=s,s)s.hasOwnProperty(p)&&(l.browserHasFlaw=l.browserHasFlaw||!s[p]&&p)},function(t,e){"use strict";e.__esModule=!0;var n=!1,o=!1,a=window.document.createElement("div");try{var r="<P><I></P></I>";a.innerHTML=r,e.tagSoup=n=a.innerHTML!==r}catch(t){e.tagSoup=n=!1}try{a.innerHTML="<P><i><P></P></i></P>",e.selfClose=o=2===a.childNodes.length}catch(t){e.selfClose=o=!1}a=null,e.tagSoup=n,e.selfClose=o},function(t,e,n){"use strict";function o(t){var e=t.indexOf("-->");if(e>=0)return new d.CommentToken(t.substr(4,e-1),e+3)}function a(t){var e=t.indexOf("<");return new d.CharsToken(e>=0?e:t.length)}function r(t){var e,n,o;if(-1!==t.indexOf(">")){var a=t.match(u.startTag);if(a){var r=(e={},n={},o=a[2],a[2].replace(u.attr,(function(t,a){arguments[2]||arguments[3]||arguments[4]||arguments[5]?arguments[5]?(e[arguments[5]]="",n[arguments[5]]=!0):e[a]=arguments[2]||arguments[3]||arguments[4]||u.fillAttr.test(a)&&a||"":e[a]="",o=o.replace(t,"")})),{v:new d.StartTagToken(a[1],a[0].length,e,n,!!a[3],o.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""))});if("object"===(void 0===r?"undefined":c(r)))return r.v}}}function s(t){var e=r(t);if(e){var n=t.slice(e.length);if(n.match(new RegExp("</\\s*"+e.tagName+"\\s*>","i"))){var o=n.match(new RegExp("([\\s\\S]*?)</\\s*"+e.tagName+"\\s*>","i"));if(o)return new d.AtomicTagToken(e.tagName,o[0].length+e.length,e.attrs,e.booleanAttrs,o[1])}}}function i(t){var e=t.match(u.endTag);if(e)return new d.EndTagToken(e[1],e[0].length)}e.__esModule=!0;var c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.comment=o,e.chars=a,e.startTag=r,e.atomicTag=s,e.endTag=i;var d=n(4),u={startTag:/^<([\-A-Za-z0-9_]+)((?:\s+[\w\-]+(?:\s*=?\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,endTag:/^<\/([\-A-Za-z0-9_]+)[^>]*>/,attr:/(?:([\-A-Za-z0-9_]+)\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))|(?:([\-A-Za-z0-9_]+)(\s|$)+)/g,
fillAttr:/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noresize|noshade|nowrap|readonly|selected)$/i}},function(t,e,n){"use strict";function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}e.__esModule=!0,e.EndTagToken=e.AtomicTagToken=e.StartTagToken=e.TagToken=e.CharsToken=e.CommentToken=e.Token=void 0;var a=n(5),r=(e.Token=function t(e,n){o(this,t),this.type=e,this.length=n,this.text=""},e.CommentToken=function(){function t(e,n){o(this,t),this.type="comment",this.length=n||(e?e.length:0),this.text="",this.content=e}return t.prototype.toString=function(){return"<!--"+this.content},t}(),e.CharsToken=function(){function t(e){o(this,t),this.type="chars",this.length=e,this.text=""}return t.prototype.toString=function(){return this.text},t}(),e.TagToken=function(){function t(e,n,a,r,s){o(this,t),this.type=e,this.length=a,this.text="",this.tagName=n,this.attrs=r,this.booleanAttrs=s,this.unary=!1,this.html5Unary=!1}return t.formatTag=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n="<"+t.tagName;for(var o in t.attrs)if(t.attrs.hasOwnProperty(o)){n+=" "+o;var r=t.attrs[o];void 0!==t.booleanAttrs&&void 0!==t.booleanAttrs[o]||(n+='="'+(0,a.escapeQuotes)(r)+'"')}return t.rest&&(n+=" "+t.rest),t.unary&&!t.html5Unary?n+="/>":n+=">",null!=e&&(n+=e+"</"+t.tagName+">"),n},t}());e.StartTagToken=function(){function t(e,n,a,r,s,i){o(this,t),this.type="startTag",this.length=n,this.text="",this.tagName=e,this.attrs=a,this.booleanAttrs=r,this.html5Unary=!1,this.unary=s,this.rest=i}return t.prototype.toString=function(){return r.formatTag(this)},t}(),e.AtomicTagToken=function(){function t(e,n,a,r,s){o(this,t),this.type="atomicTag",this.length=n,this.text="",this.tagName=e,this.attrs=a,this.booleanAttrs=r,this.unary=!1,this.html5Unary=!1,this.content=s}return t.prototype.toString=function(){return r.formatTag(this,this.content)},t}(),e.EndTagToken=function(){function t(e,n){o(this,t),this.type="endTag",this.length=n,this.text="",this.tagName=e}return t.prototype.toString=function(){return"</"+this.tagName+">"},t}()},function(t,e){"use strict";function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return t?t.replace(/([^"]*)"/g,(function(t,e){return/\\/.test(e)?e+'"':e+'\\"'})):e}e.__esModule=!0,e.escapeQuotes=n},function(t,e){"use strict";function n(t){return t&&"startTag"===t.type&&(t.unary=i.test(t.tagName)||t.unary,t.html5Unary=!/\/>$/.test(t.text)),t}function o(t,e){var o=t.stream,a=n(e());return t.stream=o,a}function a(t,e){var n=e.pop();t.prepend("</"+n.tagName+">")}function r(){var t=[];return t.last=function(){return this[this.length-1]},t.lastTagNameEq=function(t){var e=this.last();return e&&e.tagName&&e.tagName.toUpperCase()===t.toUpperCase()},t.containsTagName=function(t){for(var e,n=0;e=this[n];n++)if(e.tagName===t)return!0;return!1},t}function s(t,e,s){function i(){var e=o(t,s);e&&u[e.type]&&u[e.type](e)}var d=r(),u={startTag:function(n){var o=n.tagName;"TR"===o.toUpperCase()&&d.lastTagNameEq("TABLE")?(t.prepend("<TBODY>"),i()):e.selfCloseFix&&c.test(o)&&d.containsTagName(o)?d.lastTagNameEq(o)?a(t,d):(t.prepend("</"+n.tagName+">"),i()):n.unary||d.push(n)},endTag:function(n){d.last()?e.tagSoupFix&&!d.lastTagNameEq(n.tagName)?a(t,d):d.pop():e.tagSoupFix&&(s(),i())}};return function(){return i(),n(s())}}e.__esModule=!0,e.default=s;var i=/^(AREA|BASE|BASEFONT|BR|COL|FRAME|HR|IMG|INPUT|ISINDEX|LINK|META|PARAM|EMBED)$/i,c=/^(COLGROUP|DD|DT|LI|OPTIONS|P|TD|TFOOT|TH|THEAD|TR)$/i}])},t.exports=e()},function(t,e){"use strict";function n(t){return null!=t}function o(t){return"function"==typeof t}function a(t,e,n){var o=void 0,a=t&&t.length||0;for(o=0;o<a;o++)e.call(n,t[o],o)}function r(t,e,n){for(var o in t)t.hasOwnProperty(o)&&e.call(n,o,t[o])}function s(t,e){return t=t||{},r(e,(function(e,o){n(t[e])||(t[e]=o)})),t}function i(t){try{return Array.prototype.slice.call(t)}catch(o){var e=(n=[],a(t,(function(t){n.push(t)})),{v:n});if("object"===(void 0===e?"undefined":p(e)))return e.v}var n}function c(t){return t[t.length-1]}function d(t,e){return!(!t||"startTag"!==t.type&&"atomicTag"!==t.type||!("tagName"in t)||!~t.tagName.toLowerCase().indexOf(e))}function u(t){return d(t,"script")}function l(t){return d(t,"style")}e.__esModule=!0;var p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};e.existy=n,e.isFunction=o,e.each=a,e.eachKey=r,e.defaults=s,e.toArray=i,e.last=c,e.isTag=d,e.isScript=u,e.isStyle=l}])},"object"==typeof e&&"object"==typeof t?t.exports=o():"function"==typeof define&&define.amd?define([],o):"object"==typeof e?e.postscribe=o():n.postscribe=o()}},"core/src/lib/actions/helpers/getSourceByUrl.js":{script:function(t,e,n){"use strict";var o=n("@adobe/reactor-load-script"),a=n("@adobe/reactor-promise"),r={},s={},i=function(t){return s[t]||(s[t]=o(t)),s[t]};_satellite.__registerScript=function(t,e){r[t]=e},t.exports=function(t){return r[t]?a.resolve(r[t]):new a((function(e){i(t).then((function(){e(r[t])}),(function(){e()}))}))}}},"core/src/lib/helpers/visitorTracking.js":{script:function(t,e,n){"use strict";var o=n("@adobe/reactor-cookie"),a=n("@adobe/reactor-document"),r=n("@adobe/reactor-window"),s=n("./getNamespacedStorage"),i="_sdsat_",c="visitorTracking",d="cookiesMigrated",u=s("localStorage",c),l=s("sessionStorage",c),p=function(){var t=l.getItem("landingPage");return t||(l.setItem("landingPage",r.location.href),l.setItem("landingTime",(new Date).getTime())),!t},m=function(){return l.getItem("landingPage")},g=function(){return Number(l.getItem("landingTime"))},f=function(){return Number(u.getItem("sessionCount"))},h=function(){return Number(u.getItem("pagesViewed"))},_=function(){var t=(new Date).getTime();return Math.floor((t-g())/1e3/60)},v=function(){return l.getItem("trafficSource")},b=function(){return Number(l.getItem("pagesViewed"))},T=function(){return 1===f()},w=function(t){t&&u.setItem("sessionCount",f()+1)},y=function(){l.setItem("pagesViewed",b()+1)},C=function(){u.setItem("pagesViewed",h()+1)},x=function(){l.getItem("trafficSource")||l.setItem("trafficSource",a.referrer)},L=function(){var t=p();w(t),C(),y(),x()};(function(){if(!u.getItem(d)){var t=o.get(i+"session_count");t&&u.setItem("sessionCount",t);var e=o.get(i+"lt_pages_viewed");e&&u.setItem("pagesViewed",e),u.setItem(d,!0)}})(),L(),t.exports={getLandingPage:m,getLandingTime:g,getMinutesOnSite:_,getSessionCount:f,getLifetimePageViewCount:h,getSessionPageViewCount:b,getTrafficSource:v,getIsNewVisitor:T}}},"core/src/lib/conditions/helpers/compareNumbers.js":{script:function(t){"use strict";var e={GREATER_THAN:">",LESS_THAN:"<",EQUALS:"="},n=function(t,n,o){switch(n){case e.GREATER_THAN:return t>o;case e.LESS_THAN:return t<o;case e.EQUALS:return t===o}};t.exports=n}},"core/src/lib/helpers/getNamespacedStorage.js":{script:function(t,e,n){"use strict";var o=n("@adobe/reactor-window"),a="com.adobe.reactor.core";t.exports=function(t,e){var n=a+"."+e;return{getItem:function(e){try{return o[t].getItem(n+"."+e)}catch(t){return null}},setItem:function(e,a){try{return o[t].setItem(n+"."+e,a),!0}catch(t){return!1}}}}}}}},"twitter-uwt":{displayName:"Twitter Universal Website Tag",hostedLibFilesBaseUrl:"//img-prod-cms-rt-microsoft-com.akamaized.net/launch/store/5ef092d1efb5/21b18fecd107/0de9ba94be89/hostedLibFiles/EP0393ce01ac3540acb78f103d8e58a5a0/",settings:{account_id:"o4co9"},modules:{}},"gtag.js":{displayName:"Google gtag",hostedLibFilesBaseUrl:"//img-prod-cms-rt-microsoft-com.akamaized.net/launch/store/5ef092d1efb5/21b18fecd107/0de9ba94be89/hostedLibFiles/EPafb38e52c35f4c8e9725c5b669a4431d/",settings:{conversionIdList:["923371515"]},modules:{"gtag.js/src/lib/gtagCode.js":{script:function(t,e,n,o){"use strict";var a=n("@adobe/reactor-load-script"),r=o.getExtensionSettings(),s=r.conversionIdList,i=r.dataLayerName,c="https://www.googletagmanager.com/gtag/js?id="+s[0];i&&(c="https://www.googletagmanager.com/gtag/js?id="+s[0]+"&l="+i),a(c),!window.dataLayer||Array.isArray(window.dataLayer)||i||console.log("window.dataLayer already exists and is not an array. Visit the gtag extension configuration in Launch and provide a custom data layer name of your choosing."),i?(window[i]=window[i]||[],window.gtag=function(){window[i].push(arguments)}):(window.dataLayer=window.dataLayer||[],window.gtag=function(){dataLayer.push(arguments)}),gtag("js",new Date),s.forEach((function(t){gtag("config",t)}))}}}}},company:{orgId:"EA76ADE95776D2EC7F000101@AdobeOrg",dynamicCdnEnabled:!1},property:{name:"Store",settings:{domains:["microsoft.com"],undefinedVarsReturnEmpty:!1,ruleComponentSequencingEnabled:!1},id:"PRb55c9879b37e451cb2349365f439f194"},rules:[{id:"RL0850ad6b15104b70b962304589f9e22d",name:"Media_/en-us/b/ Snap Pixel",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/store/b/black-friday",valueIsRegex:!0},{value:"/en-us/store/b/black-friday/",valueIsRegex:!0},{value:"/en-us/store/b/cyber-monday",valueIsRegex:!0},{value:"/en-us/store/b/cyber-monday/",valueIsRegex:!0},{value:"/en-us/store/b/sale",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n    var timestamp = new Date();\n    var qs = "rand=" + Math.ceil(Math.random() * 99999999) + timestamp.getUTCFullYear() + timestamp.getUTCMonth()+ timestamp.getUTCDate() + timestamp.getUTCHours() + timestamp.getUTCMinutes() + timestamp.getUTCSeconds() + timestamp.getUTCMilliseconds();\n   image = new Image(1, 1);\n    image.src = "https://tr.snapchat.com/p?pid=c99b5ed8-ec61-4350-b6a8-77e2eabd90ab&ev=PAGE_VIEW&v=2.3&"+qs+"&pl="+_TMDL.host+_TMDL.path+"&u_hem=";\n  image2 = new Image(1, 1);\n    image2.src = "https://tr.snapchat.com/p?pid=0e03788f-4580-42d4-b751-693344c41c6f&ev=PAGE_VIEW&v=2.3&"+qs+"&pl="+_TMDL.host+_TMDL.path+"&u_hem=";\n   image3 = new Image(1, 1); \n    image3.src="https://tr.snapchat.com/cm/s?pnid=140";\n}\ncatch(err)\n{\n    _satellite.logger.error("Media_/en-us/b/SnapPixel");\n}',language:"javascript"}}]},{id:"RL089101967b1d49ea96b6e1eab85c9a84",name:"XboxGoog/UK-FR",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/(en-gb|fr-fr)/d/xbox-series-s-certified-refurbished/8p01kzxz5j21",valueIsRegex:!0},{value:"/en-gb/d/xbox-series-x-certified-refurbished/8zj26xj5cr3q",valueIsRegex:!0},{value:"/en-gb/d/Xbox-Series-S-1-TB-black/8zcbgtt29h9c",valueIsRegex:!0},{value:"/en-gb/d/xbox-series-x/8wj714n3rbtl",valueIsRegex:!0},{value:"/en-gb/d/xbox-series-s/942j774tp9jn",valueIsRegex:!0},{value:"/fr-fr/d/Pack-Xbox-Series-X-Diablo-IV/8N1BB8DSBKNT",valueIsRegex:!0},{value:"/fr-fr/d/pack-xbox-series-x-forza-horizon-5-premium/8v5cpws7xvk4",valueIsRegex:!0},{value:"/fr-fr/d/Xbox-Series-S-1-To-noir/8zcbgtt29h9c",valueIsRegex:!0},{value:"/fr-fr/d/xbox-series-x/8wj714n3rbtl",valueIsRegex:!0},{value:"/fr-fr/d/xbox-series-s/942j774tp9jn",valueIsRegex:!0},{value:"/fr-fr/d/xbox-series-x-reconditionnee-certifiee/8ZJ26XJ5CR3Q",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n    var\ta = "" + (Math.random() * 10000000000000);\n    var pageLoad = new Image(1, 1);\n    pageLoad.src = "https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=lp_std;u1=" + _TMDL.geo + ";u2=" + _TMDL.ll + ";u6=" + _TMDL.pagename +";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=" + a + "?" ;\n}\ncatch (err) {\n    _satellite.logger.error("Google-Xbox failed");\n}',language:"javascript"}}]},{id:"RL0bcfb7ed292f400495880750aaae4dbc",name:"ENSSHIM",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:-90}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!0,source:'if (typeof Bootstrapper !== \'object\') {\n\twindow.Bootstrapper = {};\n\tBootstrapper.imageRequest = function(a) {var c=new Image(0,0);c.src=a;return c};\n\tBootstrapper.insertScript = function(a, c, d, h) {\n                var p = document.getElementsByTagName("script"), g;\n                h = void 0 !== h ? h : !0;\n                if (void 0 !== c ? c : 1)\n                    for (g = 0; g < p.length; g++)\n                        if (p[g].src === a && p[g].readyState && /loaded|complete/.test(p[g].readyState))\n                            return;\n                if (d) {\n                    d = 1 == d && "object" == typeof b.scDataObj ? b.scDataObj : d;\n                    e.rand = Math.random() * ("1E" + (10 * Math.random()).toFixed(0));\n                    c = window.location.href;\n                    "object" === typeof d && d.PageID && (c = d.PageID,\n                    delete d.PageID);\n                    if ("object" === typeof d)\n                        for (g in d) {\n                            g = ~c.indexOf("#") ? c.slice(c.indexOf("#"), c.length) : "";\n                            c = c.slice(0, g.length ? c.length - g.length : c.length);\n                            c += ~c.indexOf("?") ? "&" : "?";\n                            for (k in d)\n                                c += k + "=" + d[k] + "&";\n                            c = c.slice(0, -1) + g;\n                            break\n                        }\n                    a += "?";\n                    h && (a += "r=" + e.rand + "&");\n                    a += "ClientID=" + encodeURIComponent(e.options.clientId) + "&PageID=" + encodeURIComponent(c)\n                }\n                (function(a, c, b) {\n                    var d = c.head || c.getElementsByTagName("head");\n                    setTimeout(function() {\n                        if ("item"in d) {\n                            if (!d[0]) {\n                                setTimeout(arguments.callee, 25);\n                                return\n                            }\n                            d = d[0]\n                        }\n                        var a = c.createElement("script");\n                        a.src = b;\n                        a.onload = a.onerror = function() {\n                            this.addEventListener && (this.readyState = "loaded")\n                        }\n                        ;\n                        d.insertBefore(a, d.firstChild)\n                    }, 0)\n                }\n                )(window, document, a)\n            }\n            ;\n            Bootstrapper.loadScriptCallback = function(a, c, b) {\n                var d = document.getElementsByTagName("script"), e;\n                b = d[0];\n                for (e = 0; e < d.length; e++)\n                    if (d[e].src === a && d[e].readyState && /loaded|complete/.test(d[e].readyState))\n                        try {\n                            c()\n                        } catch (g) {\n                            //window[ensightenOptions.ns].reportException(g)\n                        } finally {\n                            return\n                        }\n                d = document.createElement("script");\n                d.type = "text/javascript";\n                d.async = !0;\n                d.src = a;\n                d.onerror = function() {\n                    this.addEventListener && (this.readyState = "loaded")\n                }\n                ;\n                d.onload = d.onreadystatechange = function() {\n                    if (!this.readyState || "complete" === this.readyState || "loaded" === this.readyState) {\n                        this.onload = this.onreadystatechange = null;\n                        this.addEventListener && (this.readyState = "loaded");\n                        try {\n                            c.call(this)\n                        } catch (g) {\n                            //window[ensightenOptions.ns].reportException(g)\n                        }\n                    }\n                }\n                ;\n                b.parentNode.insertBefore(d, b)\n            }\n            ;\n}\n\n\nwindow._TMutils = {\n\tgetQueryParam : function (p,url) {\n\t\t\t//var url = window.location.search,\n\t\t\tvar match;\n\t\t\tif (window.location.href.indexOf("#") !== -1) {\n\t\t\t\turl += "&" + window.location.href.split("#")[1]\n\t\t\t}\n\t\t\tmatch = new RegExp("[?&]" + p + "=([^&]*)", "i").exec(url);\n\t\t\treturn match ? IRF.util.safeDecodeURIComponent(match[1].replace(/\\+/g, " ")) : null\n\t},\n  readCookie : function(name) {\n\t\tvar nameEQ = name + "=";\n\t\tvar ca = document.cookie.split(\';\');\n\t\tfor(var i=0;i < ca.length;i++) {\n\t\t\tvar c = ca[i];\n\t\t\twhile (c.charAt(0)==\' \') c = c.substring(1,c.length);\n\t\t\tif (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length,c.length);\n\t\t}\n\t\treturn null;\n\t},\n\tcreateCookie : function(name,value,days) {\n\t\tvar expires = "";\n\t\tvar date;\n\t\tvar domainstr = (~window.location.host.indexOf("microsoft.com")) ? "; domain=.microsoft.com; path=/; " : "; path=/; ";\n\t\tif (days) {\n\t\t\tdate = new Date();\n\t\t\tdate.setTime(date.getTime()+(days*24*60*60*1000));\n\t\t\texpires = "; expires="+date.toGMTString();\n\t\t}\n\t\tdocument.cookie = name+"="+value+expires+domainstr;\n\t},\n\tsafeDecodeURIComponent : function (s) {\n\t\tif (s) {\n\t\t\ts = s.replace(/%([EF][0-9A-F])%([89AB][0-9A-F])%([89AB][0-9A-F])/gi, function (code, hex1, hex2, hex3) {\n\t\t\t\t\tvar n1 = parseInt(hex1, 16) - 224;\n\t\t\t\t\tvar n2 = parseInt(hex2, 16) - 128;\n\t\t\t\t\tif (n1 == 0 && n2 < 32) {\n\t\t\t\t\t\treturn code\n\t\t\t\t\t}\n\t\t\t\t\tvar n3 = parseInt(hex3, 16) - 128;\n\t\t\t\t\tvar n = (n1 << 12) + (n2 << 6) + n3;\n\t\t\t\t\tif (n > 65535) {\n\t\t\t\t\t\treturn code\n\t\t\t\t\t}\n\t\t\t\t\treturn String.fromCharCode(n)\n\t\t\t\t});\n\t\t\ts = s.replace(/%([CD][0-9A-F])%([89AB][0-9A-F])/gi, function (code, hex1, hex2) {\n\t\t\t\t\tvar n1 = parseInt(hex1, 16) - 192;\n\t\t\t\t\tif (n1 < 2) {\n\t\t\t\t\t\treturn code\n\t\t\t\t\t}\n\t\t\t\t\tvar n2 = parseInt(hex2, 16) - 128;\n\t\t\t\t\treturn String.fromCharCode((n1 << 6) + n2)\n\t\t\t\t});\n\t\t\ts = s.replace(/%([0-7][0-9A-F])/gi, function (code, hex) {\n\t\t\t\t\treturn String.fromCharCode(parseInt(hex, 16))\n\t\t\t\t});\n\t\t\ts = s.replace("+", " ")\n\t\t}\n\t\treturn s\n\t},\n\tlogRuleCall : function (ruleName,debugParams,imageURL) {\n\t\tvar pType = "other";var market = "en-us";var cookieMSFPC = "msfpc";\n\t\tvar ff2,ff3,ff4,ff5,ff6;ff2=ff3=ff4=ff5=ff6="";\n\t\tvar jsDomain = encodeURIComponent(window.location.hostname.toLowerCase());\n        if (typeof _TMDL == "object") {pType = _TMDL.pageType;market = _TMDL.ll;}\n        function impGuid() {var result,i,j;result="";\n            for (j = 0; j < 32; j++) {if (j == 8 || j == 12 || j == 16 || j == 20)result = result + "-";\n                i = Math.floor(Math.random() * 16).toString(16).toUpperCase();result=result+i;}return result;}\n\t\t(function(imageURL){\t\n\t\tvar climit,temp2,temp3,temp4,URLlen;climit=255;URLlen=imageURL.length;\n\t\tif (URLlen <= climit) {ff2=imageURL;}\n\t\tif (URLlen > climit){ff2 = imageURL.slice(0,climit);temp2 = imageURL.slice(climit,URLlen);if (temp2.length <= climit){ff3=temp2;}else {ff3 = temp2.slice(0,climit);temp3 = temp2.slice(climit,URLlen);if (temp3.length <= climit) {ff4=temp3;}else{ff4 = temp3.slice(0,climit);temp4 = temp3.slice(climit,URLlen);if (temp4.length <= climit) {ff5=temp4;}else{ff5=temp4.slice(0,climit);ff6= temp4.slice(climit,URLlen);}}}}})(encodeURIComponent(imageURL));\n\t\tvar dtUTCTime = new Date;\n        var curUTCTime = dtUTCTime.getUTCFullYear() + "-" + dtUTCTime.getUTCMonth() + 1 + "-" + dtUTCTime.getUTCDate() + "T" + dtUTCTime.getUTCHours() + ":" + dtUTCTime.getUTCMinutes() + ":" + dtUTCTime.getUTCSeconds() + "." + dtUTCTime.getUTCMilliseconds() + "Z";\n        var str = "https://web.vortex.data.microsoft.com/collect/v1/t.js?ver\\x3d%272.1%27\\x26name\\x3d%27Ms.Webi.PageView%27\\x26";\n        str += "time\\x3d\'" + curUTCTime + "\'" + "\\x26appId\\x3d%27JS%3AUniStore%27\\x26-ver\\x3d%271.0%27\\x26-" + "impressionGuid\\x3d%27" + impGuid() + "%27" + "\\x26-pageName\\x3d%27" + encodeURIComponent(ruleName) + "%27" + "\\x26-pageType\\x3d%27" + pType + "%27" + "\\x26-market\\x3d%27" + encodeURIComponent(market) + "%27" + "\\x26-uri\\x3d%27" + encodeURIComponent(document.URL) + "%27" + "\\x26-referrerUri\\x3d%27" + encodeURIComponent(document.referrer) + "%27" + "\\x26-pageTags\\x3d%27%7B%22flightring%22%3A%22" + encodeURIComponent(debugParams) + "%22" + ",%22field2%22%3A%22" + encodeURIComponent(ff2) + "%22,%22field3%22%3A%22" + encodeURIComponent(ff3) +"%22,%22field4%22%3A%22" + encodeURIComponent(ff4) + "%22,%22field5%22%3A%22" + encodeURIComponent(ff5) +"%22,%22field6%22%3A%22" + encodeURIComponent(ff6) +"%22%7D%27\\x26-behavior\\x3d0" + "\\x26*baseType\\x3d%27Ms.Content.PageView%27\\x26*cookieEnabled\\x3dtrue\\x26*isJs\\x3dtrue" + "\\x26*title\\x3d%27" + encodeURIComponent(document.title) + "%27" + "\\x26*isLoggedIn\\x3dfalse\\x26*flashInstalled\\x3dfalse\\x26ext-app-env\\x3d%27DEV%27\\x26ext-javascript-libVer\\x3d%274.2.11%27" + "\\x26ext-javascript-domain\\x3d%27" + jsDomain + "%27" + "\\x26ext-javascript-msfpc\\x3d%27" + cookieMSFPC + "%27" + "\\x26ext-javascript-userConsent\\x3dfalse";\n        var imgTag = new Image;imgTag.src = str;\n\t}\n};\n',language:"javascript"}}]},{id:"RL11bcd2cc8bc2418f87c203a3c8580113",name:"DCMCVF",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{
source:"try\n{\n\tvar doFloodlights = function(debug) {\n\t\t_TMDL.dcmcat = [];\n\n\t\tvar pnames, pids, pidsku, sales, quantities, totqty, totamt, imgsrc1;\n\t\tvar\ta = \"\" + (Math.random() * 10000000000000);\n\t\tvar mc1 = \"\";\n\t\tvar floodlights = {};\n\n\n\t\tvar cartFloodlights = {\n\t\t\t\twindowsdevices : \"/src=8406115;type=wndv;cat=crtv_std\",\n\t\t\t\twindowssoftware : \"/src=8406727;type=wsft;cat=crtv_std\",\n\t\t\t\tothersoftware : \"/src=8406724;type=sftw;cat=crtv_std\",\n\t\t\t\tsurface : \"/src=8400690;type=surf;cat=crtv_std\",\n\t\t\t\txboxplatform : \"/src=8391491;type=xbxp;cat=crtv_std\",\n\t\t\t\txboxgames : \"exclude\",\n\t\t\t\txboxdesignlabs : \"/src=8404966;type=xdl;cat=crtv_std\",\n\t\t\t\txboxgamepass : \"/src=8406391;type=xgpg;cat=crtv_std\",\n\t\t\t\txboxlive : \"/src=8391497;type=xlg;cat=crtv_std\",\n\t\t\t\thololens : \"/src=8391509;type=hll;cat=crtv_std\",\n\t\t\t\toffice : \"/src=8406097;type=ofco;cat=crtv_std\",\n\t\t\t\tminecraft : \"/src=8400687;type=mc;cat=crtv_std\",\n\t\t\t\tother : \"/src=8406157;type=stoth;cat=crtv_std\",\n\t\t\t\txboxdigitalgames : \"/src=8406391;type=xgpg;cat=crtd_std\",\n\t\t\t\twinsoftdigital : \"/src=8406727;type=wsft;cat=pdv_dgtl\"\n\t\t};\n\n\t\tvar purchaseFloodlights = {\n\t\t\twindowsdevices : \"/src=8406115;type=wndv_sls;cat=pch_phy\",\n\t\t\twindowssoftware : \"/src=8406727;type=wsft_sls;cat=pch_phy\",\n\t\t\tothersoftware : \"/src=8406724;type=sftw_sls;cat=pch_phy\",\n\t\t\tsurface : \"/src=8400690;type=surf_sls;cat=pch_phy\",\n\t\t\txboxplatform : \"/src=8391491;type=xbxp_sls;cat=pch_phy\",\n\t\t\txboxgames : \"exclude\",\n\t\t\txboxdesignlabs : \"/src=8404966;type=xdl_sls;cat=pch_phy\",\n\t\t\txboxgamepass : \"/src=8406391;type=xgpg_sls;cat=pch_phy\",\n\t\t\txboxlive : \"/src=8391497;type=xlg_sale;cat=pch_phy\",\n\t\t\thololens : \"/src=8391509;type=hll_sls;cat=pch_phy\",\n\t\t\toffice : \"/src=8406097;type=ofco_sls;cat=pch_phy\",\n\t\t\tminecraft : \"/src=8400687;type=mc_sls;cat=pch_phy\",\n\t\t\tother : \"/src=8406157;type=stot_sl;cat=pch_phy\",\n\t\t\txboxdigitalgames : \"/src=8406391;type=xgpg_sls;cat=pch_dgtl\",\n\t\t\twinsoftdigital : \"/src=8406727;type=wsft_sls;cat=pch_dgtl\"\n\t\t};\n\t\t\n\t\tvar categoryAmounts = {\n\t\t\twindowsdevices : 0,\n\t\t\twindowssoftware : 0,\n\t\t\tothersoftware : 0,\n\t\t\tsurface : 0,\n\t\t\txboxplatform : 0,\n\t\t\txboxgames : 0,\n\t\t\txboxdesignlabs : 0,\n\t\t\txboxgamepass : 0,\n\t\t\txboxlive : 0,\n\t\t\thololens : 0,\n\t\t\toffice : 0,\n\t\t\tminecraft : 0,\n\t\t\tother : 0,\n\t\t\txboxdigitalgames : 0,\n\t\t\twinsoftdigital : 0\n\t\t};\n\t\t\n\t\tvar categoryOrders = {\n\t\t\twindowsdevices : 0,\n\t\t\twindowssoftware : 0,\n\t\t\tothersoftware : 0,\n\t\t\tsurface : 0,\n\t\t\txboxplatform : 0,\n\t\t\txboxgames : 0,\n\t\t\txboxdesignlabs : 0,\n\t\t\txboxgamepass : 0,\n\t\t\txboxlive : 0,\n\t\t\thololens : 0,\n\t\t\toffice : 0,\n\t\t\tminecraft : 0,\n\t\t\tother : 0,\n\t\t\txboxdigitalgames : 0,\n\t\t\twinsoftdigital : 0\n\t\t};\n\n\t\tvar pidexclude = {\n\t\t};\n\t\tvar skulist = {\n          '8MXP0HW2H8GR-8JK6' : 'surface',\n          '8MXP0HW2H8GR-9T1P' : 'surface',\n          '8MXP0HW2H8GR-LVMX' : 'surface'\t\t\t\n\t\t};\n\t\t\n\t\tvar matchWindowBrand = function(pname) {\n\t\t\tvar brandnames = [\n\t\t\t\t\"acer\",\n\t\t\t\t\"alienware\",\n\t\t\t\t\"asus\",\n\t\t\t\t\"cyberpowerpc\",\n\t\t\t\t\"dell\",\n\t\t\t\t\"hp\",\n\t\t\t\t\"huawei\",\n\t\t\t\t\"ibuypower\",\n\t\t\t\t\"lenovo\",\n\t\t\t\t\"linx\",\n\t\t\t\t\"logah\",\n\t\t\t\t\"millet\",\n\t\t\t\t\"razer\",\n\t\t\t\t\"porsche\",\n\t\t\t\t\"samsung\",\n\t\t\t\t\"toshiba\"\n\t\t\t\t];\n\t\t\tfor (var i=0; i<brandnames.length; i++){\n\t\t\t\tif (~pname.toLowerCase().indexOf(brandnames[i])) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\t\n\t\tvar matchXboxBrand = function(pname) {\n\t\t\tvar brandnames = [\n\t\t\t\t\"forza\",\n\t\t\t\t\"call of duty\",\n\t\t\t\t\"tomb raider\",\n\t\t\t\t\"toy soldiers war chest\",\n\t\t\t\t\"red dead\",\n\t\t\t\t\"halo\",\n\t\t\t\t\"state of decay\",\n\t\t\t\t\"fifa\",\n\t\t\t\t\"sea of thieves\",\n\t\t\t\t\"fallout\",\n\t\t\t\t\"playerunknown\"\n\t\t\t\t];\n\t\t\tfor (var i=0; i<brandnames.length; i++){\n\t\t\t\tif (~pname.toLowerCase().indexOf(brandnames[i])) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\n\t\t// update pidlist\n\t\tvar pidlist={\n\t\t\t\n\t\t'D76QX4BZNWK4' : 'windowssoftware',\n\t\t'DF77X4D43RKT' : 'windowssoftware',\n\t\t'DG7GMGF0DS12' : 'windowssoftware',\n\t\t'DG7GMGF0DS1H' : 'windowssoftware',\n\t  'DG7GMGF0DT05' : 'windowssoftware',\n\t\t'DG7GMGF0DT06' : 'windowssoftware',\n\t\t\n\t\t'DG7GMGF0DST3' : 'othersoftware',\n\t\t'DG7GMGF0DST4' : 'othersoftware',\n\t\t'DG7GMGF0DST5' : 'othersoftware',\n\t\t'DG7GMGF0DST6' : 'othersoftware',\n\t\t'DG7GMGF0DWP2' : 'othersoftware',  // sql server\n\n\n\t\t'8MB6CR05S1QD' : 'xboxplatform',\n\t  '8W68VXXMN260' : 'xboxplatform', // forza\n\t\t'9NV34NLCLG81' : 'xboxplatform', // forza\n\t\t'8SVG47RPZDDN' : 'xboxplatform', \n\n\t\t'8MC6K8M228SK' : 'surface',\n\t\t'8MCPZJJCC98C' : 'surface',\n\t\t'8N1V4QJ3GQ5X' : 'surface',\n\t\t'8NKT9WTTRBJK' : 'surface',\n\t\t'8RKCLMWPW1PP' : 'surface',\n\t\t'8XCW9BBPVFV9' : 'surface',\n\t\t'907TDS4DGWWV' : 'surface',\n\t\t'90FC23DV6SNZ' : 'surface',\n\t\t'93LTM69S3RFF' : 'surface',\n\n\t\t'8XF18PQZ17TS' : 'hololens',\n\t\t'90MDTZVL02K9' : 'hololens',\n\t\t'944XGCF64Z5B' : 'hololens',\n          \n        '91PNZZZNZWCP' : 'hololens', //device\n        '8TQMXX9XJFLL' : 'hololens', //acc\n        '8WXL8WMK1F7Z' : 'hololens', //acc\n        '8VJ21F2Z8PK5' : 'hololens', //acc\n\t\t\n\t\t'900WZDF9XJVG' : 'xboxdesignlabs',\n\t\t'93JLLWMDZ0V7' : 'xboxdesignlabs',\n\t\t'941H3FP99RM3' : 'xboxdesignlabs',\n\t\t'8TBJW32WJF8C' : 'xboxdesignlabs',\n\t\t'90T6CGN08P38' : 'xboxdesignlabs',\n\t\t'90K4SGTLSKML' : 'xboxdesignlabs',\n\t\t'8VK59S4SSLWD' : 'xboxdesignlabs',\n\t\t'8TVCQSJ7V6PT' : 'xboxdesignlabs',\n\t\t'8T07Q5SRTV11' : 'xboxdesignlabs',\n\t\t'8VKFWF7M03NJ' : 'xboxdesignlabs',\n\t\t'90GBR9CZBHJ9' : 'xboxdesignlabs',\n\t\t'9355VZP4KXB8' : 'xboxdesignlabs',\n\t\t'8QT59S4FDX8Z' : 'xboxdesignlabs',\n\t\t'936X3M90WS2S' : 'xboxdesignlabs', // configs\n\t\t'9102F5Z9J68L' : 'xboxdesignlabs', // configs\n\t\t'8ST76B99KP7D' : 'xboxdesignlabs', // configs\n\t\t'90SX28477R3L' : 'xboxdesignlabs', // configs\n\t\t\n\t\t'CFQ7TTC0K5ZM' : 'xboxlive',\n\t  'CFQ7TTC0K5DJ' : 'xboxlive',\n\t\t\n\t\t'CFQ7TTC0K5F8' : 'office',\n\t\t'CFQ7TTC0K5FD' : 'office',\n\t\t'CFQ7TTC0K5FF' : 'office',\n\t\t'CFQ7TTC0K5BB' : 'office',\n\t\t'CFQ7TTC0K5BC' : 'office',\n\t\t'CFQ7TTC0K5BD' : 'office',\n\t\t'8N0LL43Q1H85' : 'office',\n\t\t'CFQ7TTC0K5DZ' : 'office',\n\t\t'CFQ7TTC0K5F2' : 'office',\n\t\t'CFQ7TTC0K5F3' : 'office',\n\t\t'CFQ7TTC0K5BH' : 'office',\n\t\t'CFQ7TTC0K5D6' : 'office',\n\t\t'CFQ7TTC0K5D7' : 'office',\n\t\t'CFQ7TTC0K5CD' : 'office',\n\t\t'CFQ7TTC0K5CF' : 'office',\n\t\t'CFQ7TTC0K5CP' : 'office',\n\t\t'CFQ7TTC0K5CS' : 'office',\n\t\t'CFQ7TTC0K5CT' : 'office',\n\t\t'CFQ7TTC0K5D0' : 'office',\n\t\t'CFQ7TTC0K5DN' : 'office',\n\t\t'CFQ7TTC0K5DM' : 'office',\n\t\t'CFQ7TTC0K5BF' : 'office',\n\t\t'CFQ7TTC0K5FB' : 'office',\n\t\t'CFQ7TTC0K5FC' : 'office',\n\t\t'CFQ7TTC0K5D2' : 'office',  // project  4/2/18\n\t\t'CFQ7TTC0K5DB' : 'office',  // visio  4/2/18\n\t\t'CFQ7TTC0K5CW' : 'office',  // visio  4/2/18\n          \n         // added 4/20/20 for alta\n\t\t'8PC5BJBHN74P' : 'office',\n\t\t'94CM694VJ57P' : 'office',\n\t\t'900RPBX20TS6' : 'office',\n\t\t'93R684WJ71VJ' : 'office',\n\t\t'8V9J0T4JFZ6W' : 'office',\n\t\t'8NFJC88FKMRZ' : 'office',\n\t\t'8SZWM812T6N1' : 'office',\n\t\t'CFQ7TTC0K5BG' : 'office',\n\t\t'8V883X3J1V40' : 'office',\n        // end alta\n\n         // post-alta\n        '8Q3ZWVGG3FQC' : 'office',\n        '8N98X0XQT2FQ' : 'office',\n        '8PRQ1VSC8Q22' : 'office',\n        '8NVJD5ZKHMFX' : 'office',\n        '94924XCG402M' : 'xboxplatform',\n        '942ZHD9DCWXM' : 'xboxplatform',\n        // end post-alta\n          \n\t  '8V9DP4LNKNSZ' : 'surface',  // surface go added 7/10/18\n\t  \n\t\t// xbox games  9/27/18\n\t\t'8XMZ4ZZX5JT8' : 'xboxplatform',\n\t\t'8N4KPS2M97J6' : 'xboxplatform',\n\t\t'BTH9X5LM11MV' : 'xboxplatform',\n\t\t'8MSBS8Q55DBG' : 'xboxplatform',\n\t\t'BR8QZQXJVQD0' : 'xboxplatform',\n\n\t\t// 10/8/18\n\t\t'8Z1WM755TWGX' : 'xboxplatform', \n\t\t'C3C71TV51SQC' : 'xboxplatform', \n\t\t'8TSHP571GP11' : 'xboxplatform',\n\t\t'CFQ7TTC0K7Q8' : 'office',  \n\t\t'CFQ7TTC0K7DX' : 'office', \n\t\t'CFQ7TTC0K7C4' : 'office',\n\t\t'CFQ7TTC0K7C6' : 'office',\n\t\t'CFQ7TTC0K7C3' : 'office',\n\t\t'CFQ7TTC0K7C7' : 'office',\n\t\t'DG7GMGF0DW9S' : 'windowssoftware',\n\t\t'DG7GMGF0DS1G' : 'windowssoftware',\n\t\t'CFQ7TTC0K7CJ' : 'othersoftware',\n\t\t'CFQ7TTC0K7CH' : 'othersoftware',\n\t\t'CFQ7TTC0K7CF' : 'othersoftware',\n\t\t\n\t\t// 10/15/18\n\t\t'CFQ7TTC0K7C9': 'office',\n\t\t'CFQ7TTC0K7CG': 'office',\n\t\t'CFQ7TTC0K7CK': 'office',\n\t\t\n\t\t// 11/5/18\n\t\t'BPSWGQBW7R3G': 'xboxplatform', // red dead redemption 2\n\t\t'9NBLGGH4PBBM': 'xboxplatform', // Gears of War 4\n\t\t\n\t\t// 11/9/18\n\t\t'92594H05TKL3': 'xboxplatform', // fortnite bundle\n\t\t'8VDVCNF9F65W': 'xboxplatform', // playerunknowns battleground\n\t\t\n\t\t// 11/23/2018\n\t\t//'C0MN5DN8KR3F': 'xboxplatform', // playerunknowns full release\n\t\t'9PB2MZ1ZMB1S': 'winsoftdigital', // itunes\n\t\t'9WZDNCRFJ3TJ': 'winsoftdigital', // netflix\n\t\t'8NPV33DJ370P': 'xboxdesignlabs',\n\t\t'8Z1WFX3PP9BP': 'xboxdesignlabs',\n\t\t'8TN029PXKRTV': 'xboxdesignlabs',\n\t\t'8TMZXJV9D39G': 'xboxdesignlabs',\n          \n        // 10/21/19 -- all of the variations are for these BigIDs \n        'CFQ7TTC0K61W' : 'other',\t\n        'CFQ7TTC0K64F' : 'other',\t\n        'CFQ7TTC0K56K' : 'other',\n          \n        // 10/6/20 - Xbox Series X & S \n        '8T65QFQQ4K01' : 'xboxplatform',\t\n        '8RRVZ1VF9SF3' : 'xboxplatform',\n\n        // 10/12/20 - Xbox Game Pass (cfq7ttc0k6l8,CFQ7TTC0KGQ8,CFQ7TTC0KHS0)\n        'cfq7ttc0k6l8' : 'xboxgamepass',\t\n        'CFQ7TTC0KGQ8' : 'xboxgamepass',\n        'CFQ7TTC0KHS0' : 'xboxgamepass',\n\n\t\t// leave this as last\n\t\t'SHOULDNEVERMATCH' : 'pc'\n\t\t};\n\n\t\t// _TMDL.prdType and _TMDL.prdFam\n\t\t\n\t\tif (_TMDL.pids) {\n\t\t\tfor (var i = 0; i < _TMDL.pids.length; i++) {\n\t\t\t\tif (_TMDL.pids && _TMDL.pids[i] && pidexclude[_TMDL.pids[i]]) {\n\t\t\t\t\t// do nothing, not commissionable\n\t\t\t\t\t_TMDL.dcmcat[i]=\"excluded\";\n\t\t\t\t} else if (_TMDL.pidsku && _TMDL.pidsku[i] && skulist[_TMDL.pidsku[i]]) {\n\t\t\t\t\t// sku lookup based eventID\n\t\t\t\t\t_TMDL.dcmcat[i]=skulist[_TMDL.pidsku[i]];\n\t\t\t\t\tcategoryOrders[skulist[_TMDL.pidsku[i]]]++;\n\t\t\t\t\tcategoryAmounts[skulist[_TMDL.pidsku[i]]]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pids && _TMDL.pids[i] && pidlist[_TMDL.pids[i]]) {\n\t\t\t\t\t_TMDL.dcmcat[i]=pidlist[_TMDL.pids[i]];\n\t\t\t\t\tcategoryOrders[pidlist[_TMDL.pids[i]]]++;\n\t\t\t\t\tcategoryAmounts[pidlist[_TMDL.pids[i]]]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pnames && ~_TMDL.pnames[i].toLowerCase().indexOf(\"surface\") ) {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"surface\";\n\t\t\t\t\tcategoryOrders[\"surface\"]++;\n\t\t\t\t\tcategoryAmounts[\"surface\"]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pnames && (~_TMDL.pnames[i].toLowerCase().indexOf(\"office\") || ~_TMDL.pnames[i].toLowerCase().indexOf(\"o365\"))) {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"office\";\n\t\t\t\t\tcategoryOrders[\"office\"]++;\n\t\t\t\t\tcategoryAmounts[\"office\"]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pnames && ~_TMDL.pnames[i].toLowerCase().indexOf(\"minecraft\") ) {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"minecraft\";\n\t\t\t\t\tcategoryOrders[\"minecraft\"]++;\n\t\t\t\t\tcategoryAmounts[\"minecraft\"]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pnames && ~_TMDL.pnames[i].toLowerCase().indexOf(\"xbox\")) {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"xboxplatform\";\n\t\t\t\t\tcategoryOrders[\"xboxplatform\"]++;\n\t\t\t\t\tcategoryAmounts[\"xboxplatform\"]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pnames && matchXboxBrand(_TMDL.pnames[i]) ) {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"xboxplatform\";\n\t\t\t\t\tcategoryOrders[\"xboxplatform\"]++;\n\t\t\t\t\tcategoryAmounts[\"xboxplatform\"]+=_TMDL.sales[i];\n\t\t\t\t} else if (_TMDL.pnames && matchWindowBrand(_TMDL.pnames[i]) ) {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"windowsdevices\";\n\t\t\t\t\tcategoryOrders[\"windowsdevices\"]++;\n\t\t\t\t\tcategoryAmounts[\"windowsdevices\"]+=_TMDL.sales[i];\n\t\t\t\t} else if ((typeof _TMDL.prdType == \"object\") && (typeof _TMDL.prdType[i] == \"string\") && ~_TMDL.prdType[i].toLowerCase().indexOf(\"game\") && (~_TMDL.pnames[i].toLowerCase().indexOf(\"xbox\") || matchXboxBrand(_TMDL.pnames[i]) || _TMDL.sales[i]>0)) {\n\t\t\t\t\t// look for digital goods\n\t\t\t\t\t_TMDL.dcmcat[i]=\"xboxdigitalgames\";\n\t\t\t\t\tcategoryOrders[\"xboxdigitalgames\"]++;\n\t\t\t\t\tcategoryAmounts[\"xboxdigitalgames\"]+=_TMDL.sales[i];\n\t\t\t\t} else if ((typeof _TMDL.prdType == \"object\") && (typeof _TMDL.prdType[i] == \"string\") && _TMDL.prdType[i].toLowerCase().indexOf(\"device\")<0 && _TMDL.prdType[i].toLowerCase().indexOf(\"pass\")<0) {\n\t\t\t\t\t// look for digital goods\n\t\t\t\t\t_TMDL.dcmcat[i]=\"winsoftdigital\";\n\t\t\t\t\tcategoryOrders[\"winsoftdigital\"]++;\n\t\t\t\t\tcategoryAmounts[\"winsoftdigital\"]+=_TMDL.sales[i];\n\t\t\t\t} else {\n\t\t\t\t\t_TMDL.dcmcat[i]=\"other\";\n\t\t\t\t\tcategoryOrders[\"other\"]++;\n\t\t\t\t\tcategoryAmounts[\"other\"]+=_TMDL.sales[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\t\n\t\ttry {\n\t\t\tif (_TMutils.readCookie(\"MC1\")) {\n\t\t\t\tmc1 = _TMutils.readCookie(\"MC1\").split(\"&\")[0].split(\"=\")[1]; //use in u58\n\t\t\t}\n\t\t} catch(mc1err) {}\t\n\n\t\t// set the floodlights based on the page\n\t\tif (_TMDL.pageType==\"receipt\" || _TMDL.pageType==\"congrats\") {\n\t\t\tfloodlights = purchaseFloodlights;\n\t\t} else if (~_TMDL.pageType.indexOf(\"cart\")) {\n\t\t\tfloodlights = cartFloodlights;\n\t\t}\n\t\t\n\t\t// iterate through line items\n\t\tfor (key in categoryOrders) {\n\t\t\tif (categoryOrders[key]>0 && floodlights[key] !== \"exclude\") {\t\t\n\t\t\t\tpnames=[]; pids=[]; pidsku=[]; sales=[]; quantities=[]; totqty=0; totamt=0;\n\t\t\t\tconsole.log(key,categoryOrders[key],categoryAmounts[key],\"\\n\"); // make sure formatted as xx.xx\n\n\t\t\t\tfor (var line=0; line < _TMDL.pids.length; line++) {\n\t\t\t\t\tif (_TMDL.dcmcat[line] == key) {\t\n\t\t\t\t\t\tpnames.push(_TMDL.pnames[line]);\n\t\t\t\t\t\tpids.push(_TMDL.pids[line]);\n\t\t\t\t\t\tpidsku.push(_TMDL.pidsku[line]);\n\t\t\t\t\t\tsales.push(_TMDL.sales[line]);\n\t\t\t\t\t\tquantities.push(_TMDL.quantities[line]);\n\t\t\t\t\t\ttotqty+=_TMDL.quantities[line];\n\t\t\t\t\t\ttotamt+=_TMDL.sales[line];\t\n\t\t\t\t\t}\t\t\t\t\n\t\t\t\t}\n\n\t\t\t\timgsrc1 = \"https://ad.doubleclick.net/ddm/activity\"+floodlights[key]+\";qty=1;cost=\"+totamt+\";u1=\"+_TMDL.geo.toUpperCase()+\";u2=\"+_TMDL.ll\n\t\t\t\t\t//+\";u5=\"+encodeURIComponent(document.referrer)\n\t\t\t\t\t+\";u25=\"+pids.join(\"_\")\n\t\t\t\t\t+\";u26=\"+encodeURIComponent(pnames.join(\"_\"))\n\t\t\t\t\t+\";u58=\"+mc1\n\t\t\t\t\t+\";u31=\"+_TMDL.cc+\";u32=\"+pids.join(\"_\")+\";u33=\"+pidsku.join(\"_\")+\";u34=\"+_TMDL.purchaseID+\";u35=\"+totqty\n\t\t\t\t\t+\";u39=\"+sales.join(\"_\")+\";u40=\"+quantities.join(\"_\")\n\t\t\t\t\t+\";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=\"+_TMDL.purchaseID+\"?\";\n\t\t\t\timgsrc = imgsrc1;\n\t\t\t\tif (debug) {\n\t\t\t\t\tconsole.log(key,pnames.join(\"_\"),\"\\n\");\n\t\t\t\t\tconsole.log(imgsrc1,\"\\n\");\n\t\t\t\t} \n\t\t\t\tBootstrapper.imageRequest(imgsrc1);\n\t\t\t}\n\t\t}\n\n\t};\n\n\tdoFloodlights(0);var imgsrc=\"\";\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== \"undefined\") {_TMutils.logRuleCall(\"DCM Cart and Purchase\",err.message,imgsrc);}\n\t_satellite.logger.error(\"DCM Cart and Purchase\");\n}\n",language:"javascript"}}]},{id:"RL15699aee762d46598e7641f7823efcba",name:"OffAdobeCV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/* Office Adobe DCO CV\n*/\n\ntry\n{\n\tvar inScope=0;\n\tvar ps;\n\tvar rand = parseInt(1E5 * 1E4 * Math.random() * Math.random());\n\tvar u="";\n\tvar totunits = 0;\n\t//var lang = (_TMDL.ll.indexOf("-")>-1) ? _TMDL.ll.split("-")[0].toLowerCase() : "";\n\t//var utstring = "&ut1="+_TMDL.pidsku.join("%2C")+"&ut2="+lang+"&ut3="+_TMDL.geo.toLowerCase()+"&cachebuster="+rand;\n\n\tfor (var i=0; i<_TMDL.pidsku.length; i++) {\n\t\tps = _TMDL.pidsku[i].toUpperCase();\n\t\tif (ps=="CFQ7TTC0K5DM-007R" || ps=="CFQ7TTC0K5DM-007W"){\n\t\t\t// Home Annual\n\t\t\tinScope=1;\n\t\t\ttotunits+=parseInt(_TMDL.quantities[i],10);\n\t\t} else if (ps=="CFQ7TTC0K5FB-0002" || ps=="CFQ7TTC0K5FC-0002" || ps=="CFQ7TTC0K5FB-000D" || ps=="CFQ7TTC0K5FC-000C") {\n\t\t\t// Home and Student 2016 (for Mac and Windows SKUs)\n\t\t\tinScope=1;\t\t\n\t\t\ttotunits+=parseInt(_TMDL.quantities[i],10);\n\t\t} \n\t}\n\n\tif (~_TMDL.pageType.indexOf("receipt") && _TMDL.isprod && inScope) {\n\t\t// purchase\n\t\tu="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50106&ActionName=Microsoft_Store_Office_Conversion_Pixel"\n\t\t\t//+"&Revenue="+_TMDL.totamount  // updated by request from Carat <NAME REMOVED> on 11/8/18\n\t\t\t+"&Revenue="+totunits\n\t\t\t+"&TransactionID="+_TMDL.purchaseID\n\t\t\t+"&Currency="+_TMDL.cc\n\t\t\t+"&cachebuster="+rand;\n\t\tBootstrapper.imageRequest(u); \n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("OffAdobeCV",err.message,u);}\n\t_satellite.logger.error("OffAdobeCV");\t\n}\n',language:"javascript"}}]},{id:"RL157bd311b6164957a5cb7ea6964a05e9",name:"AMOCV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"// AMOCV\n\ntry \n{\n\tvar marketMap = {\n\t\"TR\" : \"MEA_TR\",\n\t\"KE\" : \"MEA_KE\",\n\t\"ZA\" : \"MEA_ZA\",\n\t\"IL\" : \"MEA_IL\",\n\t\"AE\" : \"MEA_AE\",\n\t\"EG\" : \"MEA_EG\",\n\t\"SA\" : \"MEA_SA\",\n\t\"PK\" : \"MEA_PK\",\n\t\"NG\" : \"MEA_NG\",\n\t\"QA\" : \"MEA_QA\",\n\t\"KW\" : \"MEA_KW\",\n\t\"LE\" : \"MEA_LE\",\n\t\"ZW\" : \"MEA_ZW\",\n\t// phase 2 and 3\n\n\t'BE' : 'WE_BE',\n\t'CN' : 'APAC_CHINA',\n\t'CZ' : 'CEE_CZ',\n\t'GR' : 'WE_GR',\n\t'HU' : 'CEE_HU',\n\t'LU' : 'WE_LU',\n\t'NL' : 'WE_NL',\n\t'PL' : 'CEE_PL',\n\t'RO' : 'CEE_RO',\n\t'RU' : 'CEE_RU',\n\t'SK' : 'CEE_SK',\n\t'CL' : 'LATAM_CL',\n\t'CR' : 'LATAM_CR',\n\t'DK' : 'WE_DK',\n\t'FI' : 'WE_FI',\n\t'MX' : 'LATAM_MX',\n\t'NO' : 'WE_NO',\n\t'PE' : 'LATAM_PE',\n\t'PR' : 'LATAM_PR',\n\t'SE' : 'WE_SE',\n\t'TT' : 'LATAM_TT',\n\t'AR' : 'LATAM_AR',\n\t'AT' : 'WE_AT',\n\t'BR' : 'LATAM_BR',\n\t'CO' : 'LATAM_CO',\n\t'FR' : 'WE_FR',\n\t'ID' : 'APAC_ID',\n\t'IE' : 'WE_IE',\n\t'IT' : 'WE_IT',\n\t'MY' : 'SEA_MY',\n\t'PH' : 'SEA_PH',\n\t'PT' : 'WE_PT',\n\t'SG' : 'SEA_SG',\n\t'ES' : 'WE_ES',\n\t'CH' : 'WE_CH',\n\t'TH' : 'APAC_TH',\n\t'AU' : 'SEA_AU',\n\t'DE' : 'WE_DE',\n\t'IN' : 'INDIA_IN',\n\t'NZ' : 'SEA_NZ',\n\t'GB' : 'WE_GB',\n\t'CA' : 'NA_CA',\n\t'HK' : 'SEA_HK',\n\t'JP' : 'APAC_JP',\n\t'KR' : 'SEA_KO',\n\t'TW' : 'GCR_TW',\n\t'US' : 'NA_US',\n\n\t// added 2/28/18\n\t'AZ' : 'CEE_CZ',\n\t'BY' : 'CEE_CZ',\n\t'BG' : 'CEE_CZ',\n\t'HR' : 'CEE_CZ',\n\t'KZ' : 'CEE_CZ',\n\t'LV' : 'CEE_CZ',\n\t'SI' : 'CEE_CZ',\n\t'UA' : 'CEE_CZ',\n\t'EE' : 'CEE_CZ',\n\n\t// added 3/27/18\n\t'VN' : 'SEA_VN'\n\n\t};\n\n\tvar prefix=\"\",userid=\"4249\";\n\n\ttry {\n\t\tif(_TMDL && marketMap[(_TMDL.geo).toUpperCase()] ){\n\t\t\tprefix = marketMap[(_TMDL.geo).toUpperCase()].toLowerCase();\n\t\t}\n\t} catch(err) {if (typeof(_TMutils) !== \"undefined\") {_TMutils.logRuleCall(\"AMO CV\",err.message,\"No AMO GEO Match\");}}\n\n\t//var prefix = 'SEA_SG';  // hardcode for now until next wave of markets \n\n\tif ((_TMDL.geo).toUpperCase()==\"CN\") {userid=\"4559\";}\n\n\tvar imgurl=\"\",\n\ttotamount=0,\n\tdebugstring=\"\",\n\tcc=(_TMDL.cc)?_TMDL.cc.toLowerCase() : \"\",\n\tclvamount=0;\n\n\t//var skus2update=[[\"P2W-00004\",10],[\"QR2-00011\",10],[\"RU2-00004\",10],[\"6GQ-00364\",5],[\"QQ2-00031\",5],[\"6GQ-00241\",5],[\"AAA-04580\",5],[\"R4T-00009\",5],[\"R4T-00010\",5]]; // updated 11/17/15\n\tvar skus2update=[[\"P2W-00004\",1]];\n\n\tvar clvlineitem=0;\n\n\tfor (var i=0; i<_TMDL.sales.length;i++) {\n\t\tif (parseFloat(_TMDL.sales[i]) > 0) {\n\t\t\ttotamount += parseFloat(_TMDL.sales[i]);\n\t\t}\n\t\t// check for a match against the SKUs with a multiplier\n\t\tclvlineitem=parseFloat(_TMDL.sales[i]);\n\t\tfor (var j=0; j<skus2update.length; j++) {\t\t\t\n\t\t\tif (_TMDL.skus[i].toLowerCase()==skus2update[j][0].toLowerCase()) {\n\t\t\t\t// sku matches, update price by applying multiplier\n\t\t\t\t// multiplier is second item in the nested array\n\t\t\t\tclvlineitem = parseFloat(skus2update[j][1]*_TMDL.sales[i]);\n\t\t\t} \n\t\t}\n\t\tclvamount+=clvlineitem;\n\t}\n\n\t//---------------------------------------\n\t// added for Office CPA bidding 8/9/17\n\t//---------------------------------------\n\n\tvar ev_officeHomeAnnual=\"\",\n\t\tev_officePersonalAnnual=\"\",\n\t\tev_officeHomeStudent=\"\",\n\t\tev_officeHomeMonthly=\"\",\n\t\tev_officePersonalMonthly=\"\",\n\t\tev_officeOther=\"\";\n\n\tvar ev_officeHomeAnnual_rev=0,\n\t\tev_officePersonalAnnual_rev=0,\n\t\tev_officeHomeStudent_rev=0,\n\t\tev_officeHomeMonthly_rev=0,\n\t\tev_officePersonalMonthly_rev=0,\n\t\tev_officeOther_rev=0;\n\t\n\tvar otherSKUS=[\n\t['CFQ7TTC0K5F8'],\n\t['CFQ7TTC0K5FD'],\n\t['CFQ7TTC0K5FF'],\n\t['CFQ7TTC0K5BB'],\n\t['CFQ7TTC0K5BC'],\n\t['CFQ7TTC0K5BD'],\n\t['8N0LL43Q1H85'],\n\t['CFQ7TTC0K5DZ'],\n\t['CFQ7TTC0K5F2'],\n\t['CFQ7TTC0K5F3'],\n\t['CFQ7TTC0K5BH'],\n\t['CFQ7TTC0K5D6'],\n\t['CFQ7TTC0K5D7'],\n\t['CFQ7TTC0K5CD'],\n\t['CFQ7TTC0K5CF'],\n\t['CFQ7TTC0K5CP'],\n\t['CFQ7TTC0K5CS'],\n\t['CFQ7TTC0K5CT'],\n\t['CFQ7TTC0K5D0'],\n\t['CFQ7TTC0K5DN']\n\t];\n\n\tvar ps=\"\",officeCPAstring=\"\";\n\n\tfor (var i=0; i<_TMDL.pids.length; i++) {\n\t\tif (_TMDL.pidsku.length > i) {\n\t\t\tps = _TMDL.pidsku[i].toUpperCase();\n\t\t\tif (ps==\"CFQ7TTC0K5DM-007R\" || ps==\"CFQ7TTC0K5DM-007W\"){\n\t\t\t\tev_officeHomeAnnual=1;\n\t\t\t\tev_officeHomeAnnual_rev+=parseFloat(_TMDL.sales[i]);\n\t\t\t} else if (ps==\"CFQ7TTC0K5BF-007R\" || ps==\"CFQ7TTC0K5BF-007V\"){\n\t\t\t\tev_officePersonalAnnual=1;\n\t\t\t\tev_officePersonalAnnual_rev+=parseFloat(_TMDL.sales[i]);\n\t\t\t} else if (ps==\"CFQ7TTC0K5FB-0002\" || ps==\"CFQ7TTC0K5FC-0002\" || ps==\"CFQ7TTC0K5FB-000D\" || ps==\"CFQ7TTC0K5FC-000C\") {\n\t\t\t\tev_officeHomeStudent=1;\t\t\n\t\t\t\tev_officeHomeStudent_rev+=parseFloat(_TMDL.sales[i]);\n\t\t\t} else if (ps==\"CFQ7TTC0K5DM-007P\" || ps==\"CFQ7TTC0K5DM-007V\"){\n\t\t\t\tev_officeHomeMonthly=1;\n\t\t\t\tev_officeHomeMonthly_rev+=parseFloat(_TMDL.sales[i]);\n\t\t\t} else if (ps==\"CFQ7TTC0K5BF-007Q\" || ps==\"CFQ7TTC0K5BF-007S\"){\n\t\t\t\tev_officePersonalMonthly=1;\t\t\t\n\t\t\t\tev_officePersonalMonthly_rev+=parseFloat(_TMDL.sales[i]);\n\t\t\t}\n\t\t}\n\t\tfor (var j=0; j<otherSKUS.length; j++) {                                \n\t\t\tif (_TMDL.pids[i].toLowerCase()==otherSKUS[j][0].toLowerCase()) { \n\t\t\t\tev_officeOther = 1;\n\t\t\t\tev_officeOther_rev+=parseFloat(_TMDL.sales[i]);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tif (ev_officeHomeAnnual) {\n\t\tofficeCPAstring+=\"&ev_officeHomeAnnual=1\";\n\t\tofficeCPAstring+=\"&ev_officeHomeAnnual_rev=\"+ev_officeHomeAnnual_rev;\n\t}\n\tif (ev_officePersonalAnnual) {\n\t\tofficeCPAstring+=\"&ev_officePersonalAnnual=1\";\n\t\tofficeCPAstring+=\"&ev_officePersonalAnnual_rev=\"+ev_officePersonalAnnual_rev;\n\t}\n\tif (ev_officeHomeStudent) {\n\t\tofficeCPAstring+=\"&ev_officeHomeStudent=1\";\n\t\tofficeCPAstring+=\"&ev_officeHomeStudent_rev=\"+ev_officeHomeStudent_rev;\n\t}\n\tif (ev_officeHomeMonthly) {\n\t\tofficeCPAstring+=\"&ev_officeHomeMonthly=1\";\n\t\tofficeCPAstring+=\"&ev_officeHomeMonthly_rev=\"+ev_officeHomeMonthly_rev;\n\t}\n\tif (ev_officePersonalMonthly) {\n\t\tofficeCPAstring+=\"&ev_officePersonalMonthly=1\";\n\t\tofficeCPAstring+=\"&ev_officePersonalMonthly_rev=\"+ev_officePersonalMonthly_rev;\n\t}\n\tif (ev_officeOther) {\n\t\tofficeCPAstring+=\"&ev_officeOther=1\";\n\t\tofficeCPAstring+=\"&ev_officeOther_rev=\"+ev_officeOther_rev;\n\t}\n\n\t//---------------------------\n\t// end office CPA addition\n\t//---------------------------\n\n\tif (_TMDL.pageType==\"receipt\" && _TMDL.isprod) {\n\t\t//imgurl=\"//pixel.everesttech.net/px2/4249?px_evt=t&ev_\"+prefix+\"_order=1&ev_revenue=\"+totamount+\"&ev_\"+prefix+\"_revenue=\"+totamount+\"&ev_currency_code=\"+_TMDL.cc+\"&ev_transid=\"+_TMDL.purchaseID;\n\t\timgurl=\"https://pixel.everesttech.net/px2/\"+userid+\"?px_evt=t\"\n\t\t\t+\"&ev_order=1\"\n\t\t\t+\"&ev_revenue=\"+totamount\n\t\t\t+\"&ev_clv_revenue=\"+clvamount\n\t\t\t+\"&ev_\"+cc+\"_currency_code=1\"\n\t\t\t+\"&ev_\"+prefix+\"_order=1\"\n\t\t\t+\"&ev_\"+prefix+\"_revenue=\"+totamount\n\t\t\t+\"&ev_\"+prefix+\"_clv_revenue=\"+clvamount\n\t\t\t+\"&ev_transid=\"+_TMDL.purchaseID\n\t\t\t+officeCPAstring;\n\t}\n\n\t//SAMPLE:  http://pixel.everesttech.net/px2/4249?px_evt=t&ev_order=1&ev_revenue=2.38&ev_clv_revenue=2.38&ev_mkd_currency_code=1&ev_mea_tr_order=1&ev_mea_tr_revenue=2.38&ev_mea_tr_clv_revenue=2.38&ev_transid=test999999\n\n\tdebugstring=\"\"+totamount+\": \"+_TMDL.totamount+\"   clv: \"+clvamount;\n\n\tif (imgurl && prefix && _TMDL.isprod && _TMDL.pageType==\"receipt\") {\n\t\tBootstrapper.imageRequest(imgurl);\n\t}\n} catch(err)\n{\n\t_satellite.logger.error(\"AMO CV\");\t\n}\n\n\n",language:"javascript"}}]},{id:"RL196282a7049b4306b949e6d84db2f30c",name:"TradeDesk SurfacePDP-Config FY24 US/UK/EN-CA",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/d/.*surface",valueIsRegex:!0},{value:"/en-ca/d/.*surface",valueIsRegex:!0},{value:"/en-gb/d/.*surface",valueIsRegex:!0},{value:"/en-gb/store/configure/.*Surface",valueIsRegex:!0},{value:"/en-ca/store/configure/.*Surface",valueIsRegex:!0},{value:"/en-us/store/configure/.*Surface",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2024-07-31T00:00:00Z",start:"2024-01-01T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n    var pageLoad = new Image(1, 1);\n    pageLoad.src = "https://insight.adsrvr.org/track/pxl/?adv=f0kcflz&ct=0:myqgpx6&fmt=3";\n}\ncatch (err) {\n    console.log("Trade Desk PDP Failed");\n}',language:"javascript"}}]},{id:"RL1bac9301bddd4040a68d4da634322e02",name:"FBCVF",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n\tvar marketMap = {\n\t\t"AT": "562684790554330",  \n\t\t"AU": "284489665351238", // iProspect\n\t\t"BE": "1441341485948213", // iProspect  (FR) \n\t\t"BR": "1351385668312384", // iProspect\n\t\t"CA": "822106911286239", // iProspect\n\t\t"CH": "1701617263415580",   \n\t\t"CN": "1675926909345981", \n\t\t"DE": "108292966463738",  // iProspect\n\t\t"DK": "254705608267657",  // iProspect\n\t\t"ES": "1626525834066953",  // iProspect\n\t\t"FI": "1719588481615214", \n\t\t"FR": "824192544408978", // iProspect\n\t\t"GB": "120587825211084", // iProspect\n\t\t"HK": "539267979583843", \n\t\t"IE": "249404655562787", // IProspect (added 9/13/17)\n\t\t"IN": "1974106256199230",  // (EN) iProspect\n\t\t"IR": "172987109739933",  \n\t\t"IT": "1598310580201695",  // iProspect\n\t\t"JP": "288860468248601", // iProspect\n\t\t"KR": "1413279412072377", // iProspect\n\t\t"MX": "113583175941450",  // iProspect\n\t\t"NL": "656219287899900", // iProspect\n\t\t"NO": "1675926909345981",  \n\t\t"NZ": "1925863447693257", // iProspect 9/13/17\n\t\t"PH" : "109126313071654", // iProspect  (NEW)\n\t\t"PT" : "1368140109922230",\n\t\t"RU": "514282922073511",  \n\t\t"SE": "1400129366740315", // iProspect\n\t\t"SG": "1240252356085595", // iProspect\n\t\t"TW": "266771177060777",  // iProspect\n\t\t"US": "141890703034968" // iProspect\n\t};\n\n\tvar llfbmap = {\n\t\t"fr-ca": "165913903949482",  \n\t\t"hi-in": "1419329368162069", \n\t\t"nl-be": "129122374248830", \n\t\t"de-ch": "1674321202841213", // iProspect\n\t\t"never": "1111111111111111"\n\t};\n\n\tvar feedID="";\n\tvar baseurl="",imgurl="";\n\tvar ts = new Date().valueOf();\n\tvar contentIDs="";\n\tvar i=0;\n\tvar pidstringarr=[];\n\tvar pnamearr=[];\n\n\ttry {\n\t\tif(_TMDL && marketMap[(_TMDL.geo).toUpperCase()] ){\n\t\t\tfeedID = marketMap[(_TMDL.geo).toUpperCase()].toLowerCase();\n\t\t}\n\t} catch(err) {}\n\n\ttry {\n\t\tif(_TMDL && llfbmap[(_TMDL.ll).toLowerCase()]){\n\t\t\tfeedID = llfbmap[(_TMDL.ll).toLowerCase()].toLowerCase();\n\t\t}\n\t} catch(llerr) {}\n\n\n\tif (_TMDL.cc=="Unknown" && _TMDL.geo=="US") {\n\t\t_TMDL.cc="USD";\n\t}\n\n\n\tfor (i=0; i<_TMDL.pidsku.length;i++){\n\t\tpidstringarr.push(\'"\'+_TMDL.pidsku[i]+\'"\');\n\t\tpnamearr.push(\'"\'+_TMDL.pnames[i]+\'"\');\n\t}\n\n\n\tif (feedID && _TMDL.isprod) {\n\t\tbaseurl = "https://www.facebook.com/tr?id="; \n\t\tif (_TMDL.pageType=="cart") {\n\t\t\timgurl = "&ev=AddToCart"+"&dpo=LDU&dpoco=0&dpost=0"\n\t\t\t\t+"&ts="+ts\n\t\t\t\t+"&cd[content_ids]=["+encodeURIComponent(pidstringarr.join(",").toLowerCase()) + "]"\n\t\t\t\t+"&cd[content_names]=["+encodeURIComponent(pnamearr.join(",")) + "]"\n\t\t\t\t+"&cd[content_type]=product";\n\n\t\t\t   \tBootstrapper.imageRequest(baseurl+"1770559986549030"+imgurl);\n\t\n\t\t} else if (_TMDL.pageType=="receipt") {\t\n\t\t\timgurl = "&ev=Purchase"+"&dpo=LDU&dpoco=0&dpost=0"\n\t\t\t\t+"&ts="+ts\n\t\t\t\t+"&cd[currency]="+_TMDL.cc\n\t\t\t\t+"&cd[value]="+_TMDL.totamount\n\t\t\t\t+"&cd[content_ids]=["+encodeURIComponent(pidstringarr.join(",").toLowerCase()) + "]"\n\t\t\t\t+"&cd[content_names]=["+encodeURIComponent(pnamearr.join(",")) + "]"\n\t\t\t\t+"&cd[content_type]=product"\n\t\t\t\t+"&cd[order_id]="+_TMDL.purchaseID;\n\n\t\t\t          \tBootstrapper.imageRequest(baseurl+"1770559986549030"+imgurl);\n          \n\t\t\tif (_TMDL.geo.toLowerCase()=="sg") {\n\t\t\t\t// SG CMO pixel\n\t\t\t\tBootstrapper.imageRequest("https://www.facebook.com/tr?id=1264846640217138&ev=PageView&noscript=1");\n\t\t\t\tBootstrapper.imageRequest(baseurl+"1264846640217138"+imgurl);\t\t\t\n\t\t\t}\n\t\t\t\n\t\t\tif (_TMDL.geo.toLowerCase()=="gb") {\n\t\t\t\tBootstrapper.imageRequest(baseurl+"1093198564158197"+imgurl);\t\n\t\t\t}\n\n\t\t}\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("FB CVF",err.message,imgurl);}\n\t_satellite.logger.error("FB CVF");\t\n}',language:"javascript"}}]},{id:"RL1bd4a77a2f604eb69d942ed8e47a1507",name:"Media_/fr-fr/store/b/sale",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/fr-fr/store/b/sale"},{value:"/fr-fr/store/b/sale/"}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{
source:'try\n{\n  \n// ADNXS\n   //Carousel\n jQuery("div:eq(31)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n});\n //Featured Product Image Links\njQuery(".m-content-placement-item:lt(3)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n});\n //Product Cards  \njQuery("div.m-channel-placement-item.f-wide.f-full-bleed-image").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n});\n  \n\n\n//DoubleClick\n  //Carousel\n jQuery("div:eq(31)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Deals"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n  \n  //Featured Product Image Links\njQuery(".m-content-placement-item:lt(3)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Shop Now"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n  \n  //Product Cards  \njQuery("div.m-channel-placement-item.f-wide.f-full-bleed-image").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Product Options"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n  \n  \n//Yahoo\n  //Carousel\n jQuery("div:eq(31)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick");\n});\n  \n  //Featured Product Image Links\njQuery(".m-content-placement-item:lt(3)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick");\n});\n  \n  //Product Cards  \njQuery("div.m-channel-placement-item.f-wide.f-full-bleed-image").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick");\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("Media_/fr-fr/store/b/sale");\n}\n  ',language:"javascript"}}]},{id:"RL1cd84423be164e20b3a15f9776da8f69",name:"GlobalSurfaceEngagements/Yahoo-Xndr-Adobe",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"(us|gb|jp|ca|de|au|es|nl|fr)/.*surface",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/sessions.js",settings:{count:1,operator:"="}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"// GlobalSurfaceEngagements/Yahoo-Xndr-Adobe\nvar micClick = 'p > a[href]';\nvar micClick2 = 'div > a[href]';\nvar micClick3 = 'span > a[href]';\nvar micClick3 = 'u > a[href]';\nvar micClick4 = 'font > a[href]';\nvar secondConfig = 'button[data-action*=\"Configure\"]';\nvar cardClick = 'div[class*=\"slide-item\"]';\nvar cardClick2 = 'div[class*=\"material-card\"]';\nvar hasClicked = false;\n\nfunction attachPixels(elementAddress) {\n    $(document).on('mousedown', elementAddress, '', function () {\n        if (!hasClicked) {\n            let varInt = parseInt(Math.random() * 10000000000000);;\n            var image1 = new Image(1, 1);\n            image1.src = 'https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=MSFT_Store_SiteEngagement&custom1=$$SOME_CP_MACRO$$&cachebuster=' + varInt;\n\n            var image2 = new Image(1, 1);\n            image2.src = \"https://secure.adnxs.com/px?id=1268102&t=2\";\n\n            var image3 = new Image(1, 1);\n            image3.src = \"https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick\";\n            hasClicked = true;\n        }\n\n    });\n}\n\ntry {\n    attachPixels(micClick);\n    attachPixels(micClick2);\n    attachPixels(micClick3);\n    attachPixels(micClick4);\n    attachPixels(secondConfig);\n    attachPixels(cardClick);\n    attachPixels(cardClick2);\n}\ncatch (err) {\n    _satellite.logger.error(\"Global Engagements\");\n}",language:"javascript"}}]},{id:"RL245098dcb50d40aebde2378195845fec",name:"US-SurfaceAddToCart-TikTok",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2024-01-31T00:00:00Z",start:"2023-10-09T00:00:00Z"}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/d/.*surface",valueIsRegex:!0},{value:"/en-us/store/configure/.*surface",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n    var firstConfig = \'a[href*="/store/configure"]\';\n    var secondConfig = \'button[data-action*="Configure"]\';\n    var addToCart = \'button[data-automation-test-id*="configuratorV3-BottomBar-button"]\';\n\n    attachPixels(firstConfig);\n    attachPixels(secondConfig);\n    attachPixels(addToCart);\n}\ncatch (err) {\n    _satellite.logger.error("TikTok Add to Cart Failed");\n}\n\nfunction attachPixels(elementAddress) {\n    $(document).on(\'mousedown\', elementAddress, \'\', function () {\n        var\ta = "" + (Math.random() * 10000000000000);\n        var pageLoad = new Image(1, 1);\n        pageLoad.src = "https://analytics.tiktok.com/api/v2/pixel_event_track?pixel_code=IDCKEOVFBC77U6580FHDM0&event=AddToCart&event_id=" + a;\n    });\n}\n',language:"javascript"}}]},{id:"RL245f9ce34bfa4f3d8082b7eaf6a88731",name:"OFF_AMO_ADNXS_CV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/* OFF_AMO_ADNXS_CV */\n\n\nvar isTrial=0;\nvar inScope=0;\nvar trialskus = {\n\t"cfq7ttc0k5bc-0003" : 1,\n\t"cfq7ttc0k5dm-007n" : 1,\n\t"cfq7ttc0k5dm-007q" : 1,\n\t"cfq7ttc0k5dm-007s" : 1,\n\t"cfq7ttc0k5dm-00hq" : 1,\n\t"cfq7ttc0k5dm-00hr" : 1\n};\n\n// added for Alta\nvar office365bigids = {\n\t"cfq7ttc0k5bf" : 1,\n\t"cfq7ttc0k5dm" : 1,\n\t"cfq7ttc0k5bc" : 1,\n\t"8pc5bjbhn74p" : 1, //new\n\t"94cm694vj57p" : 1, //new\n\t"900rpbx20ts6" : 1, //new\n\t"93r684wj71vj" : 1, //new\n\t"8v9j0t4jfz6w" : 1, //new\n\t"cfq7ttc0k5bd" : 1,\n\t"8nfjc88fkmrz" : 1, //new\n\t"8szwm812t6n1" : 1, //new\n\t"cfq7ttc0k5bg" : 1, //new\n\t"8v883x3j1v40" : 1  //new\n};\n\nfor (var i = 0; i < _TMDL.pidsku.length; i++) {\n  // update check to also look for office365bigids to adapt to Alta\n\tif (_TMDL.pnames && (~_TMDL.pnames[i].toLowerCase().indexOf("office") || ~_TMDL.pnames[i].toLowerCase().indexOf("o365") || ~_TMDL.pnames[i].toLowerCase().indexOf("off365") || office365bigids[_TMDL.pids[i].toLowerCase()]==1 )  && trialskus[_TMDL.pidsku[i].toLowerCase()]!==1) {\n\t\tinScope=1;\n\t}\n}\n\nvar amourl,adnxurl;\n\ntry {\n  if (inScope) {\n      adnxurl = "https://secure.adnxs.com/px?id=1089341&order_id="+_TMDL.purchaseID+"&other="+_TMDL.pidsku.join("_")+"&t=2";\n      Bootstrapper.imageRequest(adnxurl);\n\n      amourl = "https://pixel.everesttech.net/px2/5584?px_evt=t&ev_ConsPurchase=1"+\n          "&ev_transaction_market_"+_TMDL.geo+"=1"+\n          "&ev_items="+_TMDL.totqty+\n          "&ev_currency_"+_TMDL.cc+"=1"+\n          "&ev_revenue="+_TMDL.totamount+\n          "&ev_transid="+_TMDL.purchaseID;\n      Bootstrapper.imageRequest(amourl);\n  }\n} catch(err) {_satellite.logger.log("OFF_AMO_ADNXS_CV ERR");}\n\n\n',language:"javascript"}}]},{id:"RL289b7578fe5749c98866fb2212076816",name:"Surface_XANDR /d/ LP",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/d/surface-go/8v9dp4lnknsz",valueIsRegex:!0},{value:"/en-us/d/surface-book-2/8mcpzjjcc98c",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'if (~window.location.pathname.toLowerCase().indexOf("surface") && ~window.location.pathname.toLowerCase().indexOf("/d/")) {\n\tif (~window.location.pathname.toLowerCase().indexOf("/en-us/d/surface-go/8v9dp4lnknsz")){\n\t\tBootstrapper.imageRequest("https://secure.adnxs.com/px?id=1182093&seg=19686450&t=2");\t\n\t} else if (~window.location.pathname.toLowerCase().indexOf("/en-us/d/surface-book-2/8mcpzjjcc98c")){\n\t\tBootstrapper.imageRequest("https://secure.adnxs.com/px?id=1182149&seg=19686725&t=2");\t\t\n\t} \t\n}',language:"javascript"}}]},{id:"RL2e354527c27c461fb61aa31ea1bf6cad",name:"XboxGrCPE_XDLConfig",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"(us|ca|au|gb)\\/store\\/configure\\/xbox-design-lab\\/900WZDF9XJVG",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'var debug=0,fireDCM=1;\nvar ll=_TMDL.geo.toLowerCase();\n\nif (ll=="us" || ll=="ca" || ll=="gb" || ll=="au") {\n\ttry {\n\t\t$(document).on(\'mousedown\',\'button.f-primary\',\'\', function() {\n\t\t\tif (typeof $(this).data(\'bi-mto\') === \'undefined\') {\n    \t\t\t// data attribute doesn\'t exist\n    \t\t\treturn;\n\t\t\t}\n\n\n\t\t\tif (debug) { \n\t\t\t\tconsole.log("Add to cart"); \n\t\t\t}\n\n\t\t\tvar j={},pid="",cN="",u="",hr="";\n\t\t\tvar\ta = "" + (Math.random() * 10000000000000);\n\n\t\t\ttry {\n\t\t\t\tj=JSON.parse($(this).attr("data-m"));\n\t\t\t\tpid = j.pid;\n\t\t\t\tcN= j.cN;\n\t\t\t\t//hr=this.href;\n\t\t\t} catch(proderr) {\n\t\t\t\tif (debug) { \n\t\t\t\t\tconsole.log("catch Add to cart "+hr); \n\t\t\t\t}\n\t\t\t}\n\n\t\t\tu="https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=pchn_std;u1="\n\t\t\t+_TMDL.geo\n\t\t\t+";u2="+_TMDL.ll\n\t\t\t+";u6="+encodeURIComponent(window.location.pathname)\n\t\t\t+";u25="+pid\n\t\t\t+";u26="+encodeURIComponent(cN)\n\t\t\t+";u50="+encodeURIComponent(cN)\n\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="\t+ a + "?";\n\n\t\t\tif (debug) { \n\t\t\t\tconsole.log("Add to cart: u25="+pid+" u26="+cN+"\\t"+u); \n\t\t\t}\n\n\t\t\tif (fireDCM) {\n\t\t\t\tBootstrapper.imageRequest(u);\n\t\t\t}\n\t\t});\n\t} catch(clkerr) {\n\t\tconsole.log("Xbox Design Lab");\n\t}\n}',language:"javascript"}}]},{id:"RL3120769ceec2468f9ad7b16e9f56087b",name:"LinkedIn Surface - CA",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-ca/store/b/surfaceforbusiness",valueIsRegex:!0},{value:"/en-ca/d/Surface-Laptop-5-for-Business",valueIsRegex:!0},{value:"/en-ca/d/Surface-Pro-9-for-Business",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2023-04-30T00:00:00Z",start:"2023-02-09T00:00:00Z"}},{modulePath:"core/src/lib/conditions/sessions.js",settings:{count:1,operator:"="}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"// START OF LINKED IN\nvar micClick = 'a[href]';\nvar secondConfig = 'button[data-action*=\"Configure\"]';\nvar hasClicked = false;\n\nfunction attachPixels(elementAddress) {\n    $(document).on('mousedown', elementAddress, '', function () {\n        if (!hasClicked) {\n            var image1 = new Image(1, 1);\n            image1.src = \"https://px.ads.linkedin.com/collect/?pid=7850&conversionId=10944332&fmt=gif\";\n            hasClicked = true;\n        }\n        \n    });\n} \n\ntry {\n    attachPixels(micClick);\n    attachPixels(secondConfig);\n}\ncatch (err) {\n    _satellite.logger.error(\"CA-LinkedIn\");\n}",language:"javascript"}}]},{id:"RL31a7aedc0d414d348830e9091f084726",name:"Media_/en-au/store/b/business Tax Day",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-au/store/b/business",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'\ntry\n{\n\njQuery("div.m-multi-hero, div.m-channel-placement:Lt(1), div.m-content-placement:Lt(1)").on("mousedown", function(){  \nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u50=CTA;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=1?";\n\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("Media_/en-au/store/b/business Tax Day");\n}\n\n',language:"javascript"}}]},{id:"RL325bf34eaeac4b8e8ae3b9fac3cf4c62",name:"BoostSurfacePDPs",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/d/",valueIsRegex:!0},{value:"/en-us/store/configure/",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"var allClicks = '[href]';\nvar buildButton = 'button[data-action*=\"ConfigureDevice\"]';\nvar addToCart = 'button[data-automation-test-id*=\"configurator\"]';\n\nfunction attachPixels(elementAddress) {\n    $(document).on('mousedown', elementAddress, '', function () {\n        window.uetq_Amplify = window.uetq_Amplify || [];\n        if (_TMDL.pageName === \"Configure\") {\n            window.uetq_Amplify.push('event', 'click', { 'event_label': _TMDL.path.split('/')[4] });\n        } else {\n            window.uetq_Amplify.push('event', 'click', { 'event_label': _TMDL.pageName });\n        }\n\n    });\n} \n\ntry {\n    (function (w, d, t, r, u) {\n        var f, n, i; w[u] = w[u] || [], f = function () {\n            var o = { ti: \"149014572\" }; o.q = w[u], w[u] = new UET(o), w[u].push(\"pageLoad\")\n        },\n            n = d.createElement(t), n.src = r, n.async = 1,\n            n.onload = n.onreadystatechange = function () {\n                var s = this.readyState; s && s !== \"loaded\" && s !== \"complete\" || (f(), n.onload = n.onreadystatechange = null)\n            }, i = d.getElementsByTagName(t)[0], i.parentNode.insertBefore(n, i)\n    })(window, document, \"script\", \"//bat.bing.com/bat.js\", \"uetq_Amplify\");\n\n    attachPixels(allClicks);\n    attachPixels(buildButton);\n    attachPixels(addToCart);\n}\ncatch (err) {\n    _satellite.logger.error(\"Boost Surface PDP\");\n}",language:"javascript"}}]},{id:"RL3329950363d843f9a5524bfff31f3b56",name:"Media_/en-au/store/b/surface-accessories Tax Day",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-au/store/b/surface-accessories",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'\ntry\n{\n\njQuery("div.herohighlight, div.c-carousel, div.m-content-placement.x-clearfix").on("mousedown", function(){  \nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u50=CTA;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=1?";\n\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("Media_/en-au/store/b/surface-accessories Tax Day");\n}\n\n',language:"javascript"}}]},{id:"RL3846f5bb89ac402c9528c708ad36d21f",name:"SurfaceGrowthCPE",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"(us|ca|de|au|gb|sg|fr|jp)\\/p\\/surface-book-3",valueIsRegex:!0},{value:"(us|ca|de|au|gb|sg|fr|jp)\\/p\\/surface-go-2",valueIsRegex:!0},{value:"(us|ca|de|au|gb|sg|fr|jp)\\/d\\/surface-book-3",valueIsRegex:!0},{value:"(us|ca|de|au|gb|sg|fr|jp)\\/d\\/surface-go-2",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// OVERWRITES jquery contains to make it case insensitive\njQuery.expr[\':\'].contains = function(a, i, m) {\n  return jQuery(a).text().toUpperCase()\n      .indexOf(m[3].toUpperCase()) >= 0;\n};\n\nvar debug=0,fireDCM=1;\nvar ll=_TMDL.geo.toLowerCase();\n\nfunction attachAnalyticsToElement(elementAddress, actionName, actionURL) {\n\t$(document).on(\'mousedown\', elementAddress, \'\', function() {\n\t\tif (debug) { \n\t\t\tconsole.log(actionName); \n\t\t}\n\n\t\tvar j={},pid="",cN="",u="",hr="";\n\t\tvar\ta = "" + (Math.random() * 10000000000000);\n\n\t\ttry {\n\t\t\tj=JSON.parse($(this).attr("data-m"));\n\t\t\tpid = j.pid;\n\t\t\tcN= j.cN;\n\t\t\t//hr=this.href;\n\t\t} catch(proderr) {\n\t\t\tif (debug) { \n\t\t\t\tconsole.log("catch "+ actionName + " " + hr); \n\t\t\t}\n\t\t}\n\n\t\tu=actionURL + ";u1="\n\t\t+_TMDL.geo\n\t\t+";u2="+_TMDL.ll\n\t\t+";u6="+encodeURIComponent(window.location.pathname)\n\t\t+";u25="+pid\n\t\t+";u26="+encodeURIComponent(cN)\n\t\t+";u50="+encodeURIComponent(cN)\n\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="\t+ a + "?";\n\n\t\tif (debug) { \n\t\t\tconsole.log(actionName+" u25="+pid+" u26="+cN+"\\t"+u); \n\t\t}\n\n\t\tif (fireDCM) {\n\t\t\tBootstrapper.imageRequest(u);\n\t\t}\n\t});\n}\n\ntry {\n\tattachAnalyticsToElement(\n\t\t"div#coreui-contentplacement-25bhfyl section.m-content-placement-item, div#coreui-contentplacement-34ednys section.m-content-placement-item, div#coreui-banner-0drta14 a",\n\t\t\'Configurations Add to Cart\',\n\t\t\'https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std\');\n} catch(clkerr) {\n\tconsole.log("Surface PDP Configs CPE Error");\n}\n\n\n',language:"javascript"}}]},{id:"RL39439012f01b464592c200a1997c464c",name:"AMOSurfCV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/* \nRule: AMOSurfCV\n\nOriginally placed for Klarna\n\n<img src="https://pixel.everesttech.net/px2/4249?px_evt=t&ev_Surface_Plus_Consumer_purchase_orders=1&ev_Surface_Plus_Consumer_purchase_products=&ev_Surface_Plus_Consumer_purchase_revenue=&ev_transid=" width="1" height="1"/>\n\nThe below updates can be made to the pixel macros to include transaction ID, order, products and revenue: \nev_transid= Unique transaction id, client should dynamically pass order id.\nev_Surface_Plus_Consumer_purchase_orders= Count should be 1, which has been hardcoded.\nev_Surface_Plus_Consumer_purchase_products= Should pass quantity of products in order.\nev_Surface_Plus_Consumer_purchase_revenue= Should pass the revenue for order.\n*/\n\n\ntry {\n\tvar i=0,inScope=0,totamt=0,totqty=0, imageURL="",cc="";\n\tfor (i=0; i<_TMDL.pidsku.length; i++) {\n\t\tif (~_TMDL.pnames[i].toLowerCase().indexOf("surface")) {\n\t\t\tinScope=1;\n\t\t\ttotamt+=_TMDL.sales[i];\n\t\t\ttotqty+=_TMDL.quantities[i]\n\t\t} \n\t}\n\tcc=(_TMDL.cc)?_TMDL.cc.toLowerCase() : "";\n\n\timageURL = "https://pixel.everesttech.net/px2/4249?px_evt=t"\n\t\t+"&ev_Surface_Plus_Consumer_purchase_orders=1"\n\t\t+"&ev_Surface_Plus_Consumer_purchase_products="+totqty\n\t\t+"&ev_"+cc+"_Surface_Plus_Consumer_purchase_revenue="+totamt\n\t\t+"&ev_transid="+_TMDL.purchaseID;\n\t\t\n\tif (_TMDL.pT=="rP" && inScope) {\n\t\tBootstrapper.imageRequest(imageURL);\n\t}\n} catch(e) {\n\tconsole.log("surfaceplusamoerr");\n}',language:"javascript"}}]},{id:"RL45841b807ebc4e208726abe1ec8503f4",name:"XboxGrCPE_PMP /EN-US/ (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/store/b/xbox",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'//OVERWRITES jquery contains to make it case insensitive\njQuery.expr[\':\'].contains = function(a, i, m) {\n  return jQuery(a).text().toUpperCase()\n      .indexOf(m[3].toUpperCase()) >= 0;\n};\n\nvar debug=0,fireDCM=1;\nvar ll=_TMDL.geo.toLowerCase();\n\nfunction attachAnalyticsToElement(elementAddress, actionName, actionURL) {\n\t$(document).on(\'mousedown\', elementAddress, \'\', function() {\n\t\tif (debug) { \n\t\t\tconsole.log(actionName); \n\t\t}\n\n\t\tvar j={},pid="",cN="",u="",hr="";\n\t\tvar\ta = "" + (Math.random() * 10000000000000);\n\n\t\ttry {\n\t\t\tj=JSON.parse($(this).attr("data-m"));\n\t\t\tpid = j.pid;\n\t\t\tcN= j.cN;\n\t\t\t//hr=this.href;\n\t\t} catch(proderr) {\n\t\t\tif (debug) { \n\t\t\t\tconsole.log("catch "+ actionName + " " + hr); \n\t\t\t}\n\t\t}\n\n\t\tu=actionURL + ";u1="\n\t\t+_TMDL.geo\n\t\t+";u2="+_TMDL.ll\n\t\t+";u6="+encodeURIComponent(window.location.pathname)\n\t\t+";u25="+pid\n\t\t+";u26="+encodeURIComponent(cN)\n\t\t+";u50="+encodeURIComponent(cN)\n\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="\t+ a + "?";\n\n\t\tif (debug) { \n\t\t\tconsole.log(actionName+" u25="+pid+" u26="+cN+"\\t"+u); \n\t\t}\n\n\t\tif (fireDCM) {\n\t\t\tBootstrapper.imageRequest(u);\n\t\t}\n\t});\n}\n\n\nif (ll=="us" || ll=="ca" || ll=="gb" || ll=="au") {\n\ttry {\n\t\tattachAnalyticsToElement(\n\t\t\t\'a.small-icon, a.f-image\',\n\t\t\t\'Hero banner click on Learn More or Free Return & Shipping Icons above the hero\',\n\t\t\t\'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=lrn_std\');\n\n\t\tattachAnalyticsToElement(\n\t\t\t"div[id*=\'oneStore-quicklinksmodule-\'] a.large-icon, div[id*=\'coreui-hero-\'] ul li:contains(\'SHOP NOW\'), div[id*=\'coreui-hero-\'] ul li:contains(\'Shop now\')",\n\t\t\t\'Hero banner click on Shop Now or icon menu below banner\',\n\t\t\t\'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=pchn_std\');\n\n\t\tattachAnalyticsToElement(\n\t\t\t"div[id*=\'coreui-hero-\'] ul li:contains(\'Learn more\')",\n\t\t\t\'Hero banner click on Learn More\',\n\t\t\t\'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=lrn_std\');\n\n\t\tattachAnalyticsToElement(\n\t\t\t"div:contains(\'Shop\') section.m-content-placement-item, div:contains(\'Join\') section.m-content-placement-item",\n\t\t\t\'Click on c-call-to-action Shop Now\',\n\t\t\t\'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=pchn_std\');\n\n\t\tattachAnalyticsToElement(\n\t\t\t"div[id*=\'coreui-productplacement\'] div.m-channel-placement-item, div[id*=\'coreui-productplacement\'] a.c-hyperlink",\n\t\t\t\'Click on m-channel-placement on the product trays\',\n\t\t\t\'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=pchn_std\');\n\n\t\tattachAnalyticsToElement(\n\t\t\t"div:contains(\'Learn more\') section.m-content-placement-item",\n\t\t\t\'Click on c-call-to-action Learn More\',\n\t\t\t\'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=lrn_std\');\n\t} catch(clkerr) {\n\t\tconsole.log("Xbox PMP CPE Error");\n\t}\n}',language:"javascript"}}]},{id:"RL463d31a0088348dfb14042f03eeb3071",name:"Facebook/TikTok SurfaceCopilot",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2024-10-31T00:00:00Z",start:"2024-06-02T00:00:00Z"}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/store/configure/.*/8tq2hq5xxkj9",valueIsRegex:!0},{value:"/en-us/store/configure/.*/8n9t09p96cmj",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n    var atc = \'button[data-automation-test-id*="checkout"]\';\n    attachPixels(atc);\n} catch (e) {\n    console.log("Rule has failed");\n}\n\nfunction attachPixels(elementAddress) {\n    $(document).on(\'mousedown\', elementAddress, \'\', function () {\n        var meta = new Image(1, 1);\n        meta.src = "https://www.facebook.com/tr?id=1770559986549030&ev=AddToCart&noscript=1";\n\n        var tiktok = new Image(1, 1);\n        var randnum = (Math.random() * 10000000000000000);\n        tiktok.src = "https://analytics.tiktok.com/api/v2/pixel_event_track?pixel_code=COSI0JRC77U1Q2BAH03G&event=AddtoCart&event_id=" + randnum;\n    });\n}',language:"javascript"}}]},{id:"RL4640885657f049d399cb5b426a59bb18",name:"LINKEDIN",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/*\nLinkedIn tag\n*/\ntry\n{\n\tvar c=new Image(0,0);\n\tc.src="https://px.ads.linkedin.com/collect/?pid=7850&fmt=gif";\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("LINKEDIN",err.message,c.src);}\n\t_satellite.logger.error("LINKEDIN");\t\n}\n',language:"javascript"}}]},{id:"RL4bdf667038384adf9295cffa45ec5c85",name:"Media_/en-gb/Small Business LinkedIn",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-gb/store/b/microsoft-small-business",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"linkedin/src/lib/actions/loadInsightTag.js",settings:{}}]},{id:"RL4d95565cb7de40e784c80ee275c7b124",name:"TikTok_LP",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"www.microsoft.com"==window.location.host.toLowerCase()}}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/(en-us|en-gb|fr-fr|de-de)",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n!function (w, d, t) {\n  w.TiktokAnalyticsObject=t;var ttq=w[t]=w[t]||[];ttq.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie"],ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}};for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);ttq.instance=function(t){for(var e=ttq._i[t]||[],n=0;n<ttq.methods.length;n++)ttq.setAndDefer(e,ttq.methods[n]);return e},ttq.load=function(e,n){var i="https://analytics.tiktok.com/i18n/pixel/events.js";ttq._i=ttq._i||{},ttq._i[e]=[],ttq._i[e]._u=i,ttq._t=ttq._t||{},ttq._t[e]=+new Date,ttq._o=ttq._o||{},ttq._o[e]=n||{};var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src=i+"?sdkid="+e+"&lib="+t;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(o,a)};\n\n//part2\n  ttq.load(\'C5S71GC247CAE4T3VM1G\');\n  ttq.page();\n}(window, document, \'ttq\');\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("TikTok LP");\n}',language:"javascript"}}]},{id:"RL4f01b047a2be429697daa3c33bfe186f",name:"SundaySkyPurchase",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")&&(-1!==window.location.search.indexOf("market=US")||-1!==window.location.search.indexOf("market=CA"))}}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2024-08-01T00:00:00Z",start:"2023-03-20T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// SundaySkyPurchase\ntry {\n    var rand1 = parseInt(Math.random() * 10000000000000);\n    var rand2 = parseInt(Math.random() * 10000000000000);\n    var rand3 = parseInt(Math.random() * 10000000000000);\n    var rand4 = parseInt(Math.random() * 10000000000000);\n\n    var image1 = new Image(1, 1);\n    image1.src = "https://s-vop.sundaysky.com/t/v1/img?a=microsoft&ap=1&pb=f&sp=https://www.microsoft.com/" + _TMDL.ll + "/store/congrats&cb=" + rand1 +"&m=conv&udt[segment]=[visitor,buyer]&udt[userid]=[USER_ID]&udt[sku]="+ _TMDL.pids.map(x => x.toUpperCase()) + "&udt[cat]="+ _TMDL.pnames + "&udt[ptype]=[cart]&udt[bu]=[surface]&udt[country]="+ _TMDL.geo + "&udt[language]=" + _TMDL.ll.substring(0,2) +"&el=ORDER_ID&ev=" + _TMDL.totamount;\n\n    var image2 = new Image(1, 1);\n    image2.src = "https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=" + rand2 +"&s=1";\n\n    var image3 = new Image(1, 1);\n    image3.src = "https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=" + rand3 +"&s=2";\n\n    var image4 = new Image(1, 1);\n    image4.src = "https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=" + rand4 +"&s=3";\n} catch {\n    console.log("Sunday Sky Purchase");\n}',language:"javascript"}}]},{id:"RL4f2bc935924f443e8a5d5f819389d319",name:"Media_/EN-US/Business Consultation Signup LinkedIn (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/store/b/business-consultation",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n// LinkedIn pixel\n$(\'a[href*="https://digitalreservations.microsoft.com/en-us/appointment/create"]\').on("mousedown", function () {\n  var image = new Image(1, 1);\n  image.src ="https://px.ads.linkedin.com/collect/?pid=7850&conversionId=4082786&fmt=gif";\n});\n  \n }\ncatch(err)\n{\n\t_satellite.logger.error("Media_/EN-US/Business Consultation Signup LinkedIn (AEM/RT)");\n}',language:"javascript"}}]},{id:"RL5340059915f54c6ca20016bf79db7c37",name:"LinkedIn/US/AddToCart",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/d/*.surface",valueIsRegex:!0},{value:"/en-us/store/configure/*.surface",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"try {\n    var firstConfig = 'a[href*=\"/store/configure\"]';\n    var secondConfig = 'button[data-action*=\"Configure\"]';\n    var addToCart = 'button[data-automation-test-id*=\"configuratorV3-BottomBar-button\"]';\n\n    attachPixels(firstConfig);\n    attachPixels(secondConfig);\n    attachPixels(addToCart);\n}\ncatch (err) {\n    _satellite.logger.error(\"LinkedIn Add to Cart Failed\");\n}\n\nfunction attachPixels(elementAddress) {\n    $(document).on('mousedown', elementAddress, '', function () {\n        var pageLoad = new Image(1, 1);\n        pageLoad.src = \"https://px.ads.linkedin.com/collect/?fmt=gif&url=https://www.microsoft.com/MSFTAddToCart&pid=7850\";\n    });\n}\n",language:"javascript"}}]},{id:"RL5495657f599a44fb901e913901431d97",name:"ADHOCCVF",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{
source:'/*\nADHOC CVF\n*/\ntry\n{\n\tvar geolc=_TMDL.geo.toLowerCase();\n\tvar adobedsp="";\n\tvar imgsrc="";\n\n\tif (_TMDL.isprod && _TMDL.pT=="rP")\n\t{\n\n\t\t// uses approach 2:  single pixel, concatenating the product IDs (rather than sending a separate pixel for each line\n\t\t// DE, FR, GB, US\n\t\tif (geolc=="de" || geolc=="fr" || geolc=="gb" || geolc=="us") {\n\t\t\tadobedsp="https://pixel.everesttech.net/px2/5584?px_evt=t&ev_"+_TMDL.pidsku.join("_")+"_count="+_TMDL.totqty\n\t\t\t\t+"&ev_"+_TMDL.pidsku.join("_")+"_revenue="+_TMDL.totamount\n\t\t\t\t+"&ev_transid="+_TMDL.purchaseID;\n\t\t\timgsrc=adobedsp;\n\t\t\tBootstrapper.imageRequest(adobedsp);\n\t\t}\n\t}\n\n\tvar twmarketMap = {\n\t"BE" : "o173t",\n\t"DK" : "nznex",\n\t"FI" : "nznez",\n\t"NO" : "nznf1",\n\t"SE" : "nznf3",\n\t"IT" : "o0287",\n\t"ES" : "o028a",\n\t"PT" : "o0289",\n\t"NL" : "nvq0j",\n\t"LU" : "o18ai"\n\t};\n\tvar twtagID="",twimg1="",twimg2="";\n\n\tif(_TMDL && twmarketMap[_TMDL.geo.toUpperCase()] ){twtagID = twmarketMap[_TMDL.geo.toUpperCase()];}\n\t\n\tif (twtagID && _TMDL.isprod && _TMDL.pT=="rp") \n\t{\n\t\ttwimg1 = "https://analytics.twitter.com/i/adsct?txn_id="+tagID+"&p_id=Twitter&tw_sale_amount="+_TMDL.totamount+"&tw_order_quantity=1";\n\t\ttwimg2 = "//t.co/i/adsct?txn_id="+tagID+"&p_id=Twitter&tw_sale_amount="+_TMDL.totamount+"&tw_order_quantity=1";\n\t\timgsrc=twimg1;\n\t\tBootstrapper.imageRequest(img1);\n\t\timgsrc=twimg2;\n\t\tBootstrapper.imageRequest(img2);\t\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("ADHOC CVF",err.message,imgsrc);}\n\t_satellite.logger.error("ADHOC CVF");\n}\n\n',language:"javascript"}}]},{id:"RL5558eb0cbd1d47428df9a2781e45365a",name:"Dstillery PDP",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"(us|gb|jp|ca|de|au|es|nl|fr)/d/.*surface",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2024-07-31T00:00:00Z",start:"2023-08-21T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n    var pageLoad = new Image(1, 1);\n    pageLoad.src = "//action.dstillery.com/orbserv/nspix?adv=cl1025915&ns=3495&nc=HomepageSiteview&ncv=47&dstOrderId=[OrderId]&dstOrderAmount=" + _TMDL.sales[0];\n}\ncatch (err) {\n    console.log("Dstillery PDP failed");\n}',language:"javascript"}}]},{id:"RL5c1f0ed8f9c64aa488ccab2558f160dc",name:"BingSurfClkCustom /d/ (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:80}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return~window.location.pathname.toLowerCase().indexOf("/d/")&&~window.location.pathname.toLowerCase().indexOf("surface")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"\n\nvar tempobj; \n\ntry {\n\n\tif (~window.location.pathname.toLowerCase().indexOf(\"surface\") && ~window.location.pathname.toLowerCase().indexOf(\"/d/\") && window.navigator.userAgent.toLowerCase().indexOf(\"soasta\")<0 && (typeof uetq=='object')) {\n\n\t\ttempobj={};\n\t\t\n\t\tif (_TMDL.pidsku.length > 0) {\n\t\t\ttempobj.ecomm_prodid = (_TMDL.pidsku.length>0) ? _TMDL.pidsku : \"\";\n\t\t\ttempobj.ecomm_pagetype = \"product\";\n\t\t\ttempobj.items = [\n\t\t\t\t{\n\t\t\t\t  'id': _TMDL.pidsku[0],\n\t\t\t\t  'category': 'surface',\n\t\t\t\t  'price' : _TMDL.sales[0]\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t\t\n\t\t// Configure Now CTA\n        /*\n\t\t$(document).on('mousedown','button[id*=\"ConfigureDeviceButton\"]','', function() {\n\t\t\twindow.uetq.push('event','configurenow', tempobj); \n\t\t});\n        */\n      \n\t\t// Configure Now CTA - Updated 7/19 to correct ID\n        jQuery(\"a:contains('Configure now'),button:contains('Configure now')\").on(\"mousedown\", function(){\n            window.uetq.push('event','configurenow', tempobj); \n         });\n      \n      \n\t\t// BuildYourBundle CTA\n        $(document).on('mousedown','button[id*=\"buttons_BuildABundleButton\"],a[href*=\"/store/build/\"]','', function() {\n\t\t\twindow.uetq.push('event','buildyourbundle', tempobj); \n\t\t});\n\t\t\t\n\t\t\n\t\t//check your eligibility CTA\n\t\t\n\t\t$(document).on('mousedown',\"a[href*='student-discounts?successurl']\",'', function() {\n\t\t\twindow.uetq.push('event','checkeligibility', tempobj); \n\t\t});\n      \n      \t// Add to Cart button, particularly needed for Surface Go PDP -- Update 7/19 Surface GO PDP and configurator page do not appear to have this ID. \"add to cart\" only exists after the bundle is created on the configurator. \n        //This should likely be updated to use: jQuery(\"a:contains('Add to cart'),button:contains('Add to cart')\");\n\t\t$(document).on('mousedown','button[id*=\"buttons_AddToCartButton\"]','', function() {\n\t\t\twindow.uetq.push('event','addtocartbutton', tempobj); \n\t\t});\t\t\n\t}\n} catch(bingerr) {console.log(\"bing onclick err\");}\n",language:"javascript"}}]},{id:"RL5eab5a9198f842fa8eb98ab1205d77aa",name:"AMOXbox",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/* \n  RULE NAME:  AMOXBOXPLATCV \n  add after DCM so categories are set\n  \t\t\txboxplatform (only this for now)\n\t\t\txboxgames \n\t\t\txboxdesignlabs \n\t\t\txboxgamepass \n\t\t\txboxlive \n\t\t\txboxdigitalgames \n*/\n\n\n(function(debug) {\n\tvar tot=0;\n\tvar units=0;\n\tvar inscope=0;\n\tvar imgurl="";\n\tif (_TMDL.pids) {\n\t\tfor (var i = 0; i < _TMDL.pids.length; i++) {\n\t\t\tif (_TMDL.dcmcat[i].indexOf("xboxplatform")>-1) {\n\t\t\t\tunits += _TMDL.quantities[i];\n\t\t\t\ttot += _TMDL.sales[i];\t\n\t\t\t\tinscope=1;\n\t\t\t}\n\t\t}\n\t}\n\t\n\tif (inscope && _TMDL.pageType=="receipt") {\n\t\t// fire AMO pixel\n\t\timgurl = "https://pixel.everesttech.net/px2/5584?px_evt=t&ev_store_xbox_purchase=1&ev_"+_TMDL.cc+"_store_xbox_purchase_value="+tot+"&ev_transid="+_TMDL.purchaseID;\n\t\tBootstrapper.imageRequest(imgurl);\n\t}\n})();\n\n',language:"javascript"}}]},{id:"RL6216f8312ce14cfeb3cf6fb09225775a",name:"Media_/en-au/store/collections Tax Day",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-au/store/collections/surfaceforbusiness",valueIsRegex:!0},{value:"/en-au/store/collections/accessoriesforbusiness",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'\ntry\n{\n\njQuery("div[id*=\'productPlacementList\']").on("mousedown", function(){  \nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u50=CTA;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=1?";\n\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("Media_/en-au/store/collections Tax Day");\n}\n\n',language:"javascript"}}]},{id:"RL64b67def4fa648f4b67cc6d001fac8f0",name:"XboxGrCPE_OneSCat",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"(us|ca|au|gb)\\/store\\/collections\\/xboxonesconsoles",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'var debug=0,fireDCM=1;\nvar ll=_TMDL.geo.toLowerCase();\n\nif (ll=="us" || ll=="ca" || ll=="gb" || ll=="au") {\n\ttry {\n\t\t$(document).on(\'mousedown\',\'div.m-channel-placement-item\',\'\', function() {\n\t\t\tif (debug) { \n\t\t\t\tconsole.log("Xbox One S consoles"); \n\t\t\t}\n\n\t\t\tvar j={},pid="",cN="",u="",hr="";\n\t\t\tvar\ta = "" + (Math.random() * 10000000000000);\n\n\t\t\ttry {\n\t\t\t\tj=JSON.parse($(this).attr("data-m"));\n\t\t\t\tpid = j.pid;\n\t\t\t\tcN= j.cN;\n\t\t\t\t//hr=this.href;\n\t\t\t} catch(proderr) {\n\t\t\t\tif (debug) { \n\t\t\t\t\tconsole.log("catch Xbox One S consoles "+hr); \n\t\t\t\t}\n\t\t\t}\n\n\t\t\tu="https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=pchn_std;u1="\n\t\t\t+_TMDL.geo\n\t\t\t+";u2="+_TMDL.ll\n\t\t\t+";u6="+encodeURIComponent(window.location.pathname)\n\t\t\t+";u25="+pid\n\t\t\t+";u26="+encodeURIComponent(cN)\n\t\t\t+";u50="+encodeURIComponent(cN)\n\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="\t+ a + "?";\n\n\t\t\tif (debug) { \n\t\t\t\tconsole.log("Xbox One S consoles: u25="+pid+" u26="+cN+"\\t"+u); \n\t\t\t}\n\n\t\t\tif (fireDCM) {\n\t\t\t\tBootstrapper.imageRequest(u);\n\t\t\t}\n\t\t});\n\t} catch(clkerr) {\n\t\tconsole.log("Xbox One S consoles");\n\t}\n}',language:"javascript"}}]},{id:"RL68235348568040d4bda4a81492fce87f",name:"AUStudentStore",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"en-au/store/b/student",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"// JavaScript source code section.m-multi-hero-item, div.m-channel-placement-item, section.m-content-placement-item,\nvar debug = 0, fireTags = 1;\nvar elements = \"section.m-multi-hero-item, div#coreui-feature-fuhlmyn section div a, a#coreui-highlightfeature-q04bez3-0, ul.c-group, section.m-content-placement-item\";\n\ntry {\n\t$(document).on('mousedown', elements, '', function () {\n\t\tif (debug) { console.log(\"Tag is running\") }\n\n\t\tvar rand = parseInt(Math.random() * 10000000000000);\n\t\tif (fireTags) {\n\t\t\tBootstrapper.imageRequest('https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster=' + rand);\n\t\t\tBootstrapper.imageRequest('https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick');\n\t\t\tBootstrapper.imageRequest(\"https://secure.adnxs.com/px?id=1268102&t=2\");\n\t\t}\n\n\n\t});\n} catch (clkerr) { console.log(\"au student store error\"); }",language:"javascript"}}]},{id:"RL683ad07cec0f4be5a6c44515d9d77917",name:"Media_/LL-LL/Surface- Configurations (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/p/surface-pro-x/",valueIsRegex:!0},{value:"/p/surface-laptop-go/",valueIsRegex:!0},{value:"/d/surface-pro-x/",valueIsRegex:!0},{value:"/d/surface-laptop-go/",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n//See all configurations button\n jQuery("[href*=\'/configure/Surface-Pro-X/8qg3bmrhnwhk\']").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u32=" + _TMDL.skus[0] + ";u50=View all configurations"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?";\n});\n  \njQuery("[href*=\'/configure/surface-laptop-go/94FC0BDGQ7WV\']").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u32=" + _TMDL.skus[0] + ";u50=View all configurations"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?";\n});  \n  \n//The Surface Book 3 Page is no longer required to be tagged as this element is duplicated in an already existing rule (SurfaceGrowthCPE)\n// jQuery("[href*=\'/configure/Surface-Book-3/8XBW9G3Z71F1\']").on("mousedown", function(){\n//var image = new Image(1, 1);\n//image.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u32=" + _TMDL.skus[0] + ";u50=View all configurations"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?";\n//});   \n    \n  \n }\ncatch(err)\n{\n\t_satellite.logger.error("Media_/LL-LL/Surface- Configurations");\n}\n',language:"javascript"}}]},{id:"RL68ed140e62e94d2db9455a01d87bffcf",name:"OffTryCV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/*\nOfficeTrialCompletionPixels\n*/\ntry\n{\n\tvar inScope=0;\n\n\tvar MSFPC="";  \n\n\tvar skulist = {\n\t\t"cfq7ttc0k5bc-0003" : 1,\n\t\t"cfq7ttc0k5dm-007n" : 1,\n\t\t"cfq7ttc0k5dm-007q" : 1,\n\t\t"cfq7ttc0k5dm-007s" : 1,\n\t\t"cfq7ttc0k5dm-00hq" : 1,\n\t\t"cfq7ttc0k5dm-00hr" : 1\n\t};\n\n\tfor (var j = 0; j < _TMDL.pidsku.length; j++) {\n\t\tif (skulist[_TMDL.pidsku[j].toLowerCase()]==1) {\n\t\t\tinScope=1;\n\t\t}\n\t}\n\n\tif (inScope) {\n\t\tBootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8406097;type=ofco;cat=tsu_uni;u17=OfficeConsumerTrial;u59=" + MSFPC + ";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1;num=" + Math.random());\n\t\t//MediaMath\n\t\tBootstrapper.imageRequest("https://pixel.mathtag.com/event/img?mt_id=1259909&mt_adid=166372&product_name=Office365HomeTrial&s26=Office365HomeTrial&v1=OfficeConsTrial");\n\t\t//Quantcast\n\t\tBootstrapper.imageRequest("https://pixel.quantserve.com/pixel/p-tTB93UFC5vepM.gif?labels=_fp.event.OfficeConsTrial,_fp.productname.Office365HomeTrial");\n\t\t//Bidtellect\n\t\tBootstrapper.imageRequest("https://bttrack.com/pixel/uconversion/2682");\n\t\t//Facebook\n\t\tBootstrapper.imageRequest("https://www.facebook.com/tr?id=535974873423448&ev=Lead&noscript=1");\n\t\t//Amobee\n\t\tBootstrapper.imageRequest("https://d.turn.com/r/dd/id/L21rdC84ODQvY2lkLzE3NDc0Nzk4MzYvdC8y/kv/orderid=[ORDER_ID],product=Office365HomeTrial,conversio=OfficeConsTrial,offerid=cfq7ttc0k5dm-007n");\n\t\tBootstrapper.imageRequest("https://r.turn.com/r/beacon?b2=UQ33J2E3GCSx7-KKGp5vpXBNpsaOMjkmcU2_M7zYy7_ou6cxrU_k3avmwgRgF-V19uqO5Y8wqz4CcEqYo96czw&cid=&bprice=");\n\t\t//MediaIQ\n\t\tBootstrapper.imageRequest("https://secure.adnxs.com/px?id=930630&seg=10824846&redir=https%3A%2F%2Fsecure.adnxs.com%2Fgetuid%3Fhttps%3A%2F%2Fpixel.mediaiqdigital.com%2Fpixel%3Fu1%3DOfficeConsTrial%26pixel_id%3D930630%26uid%3D%24UID&t=2");\n\t\t//AMO\n\t\tBootstrapper.imageRequest("https://pixel.everesttech.net/px2/4249?px_evt=t&ev_officetrial=1");\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("OffTryCV",err.message,err.stack);}\n\t_satellite.logger.error("OffTryCV");\t\n}',language:"javascript"}}]},{id:"RL6960d527cf5e4f06b954e4283c73cc62",name:"MediaIQAppnexusFY20_CV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/*\nMedia IQ Appnexus FY20 Conversion Pixel  \nMediaIQAppnexusFY20_CV\n\nMSFT - Office Direct - Consumer - TY Page\n\n*/\n\ntry {\n\tvar imgurl = "https://secure.adnxs.com/px?id=1095391&seg=17503076&redir=https%3A%2F%2Fpixel.mediaiqdigital.com%2Fpixel"\n\t\t+"%3Fu1%3D"+_TMDL.purchaseID\n\t\t+"%26u2%3D"+_TMDL.ll.split("-")[1]\n\t\t+"%26u3%3D"\n\t\t+"%26u4%3D"\n\t\t+"%26u5%3D"+_TMDL.pidsku.join("_")\n\t\t+"%26u6%3D"+_TMDL.totamount\n\t\t+"%26u7%3D"+_TMDL.totqty\n\t\t+"%26u8%3D"+_TMDL.quantities.join("_")\n\t\t+"%26u9%3D"+_TMDL.sales.join("_")\n\t\t+"%26u10%3D"+_TMDL.cc\n\t\t+"%26pixel_id%3D1095391%26uid%3D%24%7BUID%7D&t=2";\n\n\t/*\n\t\t//old:\n\tvar imgurl = "https://secure.adnxs.com/px?id=929469&seg=10765629&redir=https%3A%2F%2Fsecure.adnxs.com%2Fgetuid%3Fhttps%3A%2F%2Fpixel.mediaiqdigital.com%2Fpixel%3Fu1%3DConsPurchase%26u2%3D"\n\t+_TMDL.ll\n\t+"%26u3%3D"+_TMDL.ll.split("-")[1]\n\t+"%26u6%3D"+"thankyoupage"\n\t+"%26u20%3D"+_TMDL.pidsku.join("_")\n\t+"%26u26%3D"+encodeURIComponent(_TMDL.pnames.join("_"))\n\t+"%26u31%3D"+_TMDL.cc\n\t+"%26u34%3D"+_TMDL.purchaseID\n\t+"%26u35%3D"+_TMDL.totqty\n\t+"%26u39%3D"+_TMDL.sales.join("_")\n\t+"%26u40%3D"+_TMDL.quantities.join("_")\n\t+"%26pixel_id%3D929469%26uid%3D%24UID&t=2";\n\t*/\n\n\tif (imgurl && _TMDL.isprod && _TMDL.pageType=="receipt") {\n\t\tBootstrapper.imageRequest(imgurl);\n\t}\n} catch(e) {console.log("MediaIQAppnexusFY20_CV err");}',language:"javascript"}}]},{id:"RL6a1ffa017a6447ce99ac33bf53bffe46",name:"Surface_XANDR LP",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/p/surface-go/8v9dp4lnknsz",valueIsRegex:!0},{value:"/en-us/p/surface-book-2/8mcpzjjcc98c",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'if (~window.location.pathname.toLowerCase().indexOf("surface") && ~window.location.pathname.toLowerCase().indexOf("/p/")) {\n\tif (~window.location.pathname.toLowerCase().indexOf("/en-us/p/surface-go/8v9dp4lnknsz")){\n\t\tBootstrapper.imageRequest("https://secure.adnxs.com/px?id=1182093&seg=19686450&t=2");\t\n\t} else if (~window.location.pathname.toLowerCase().indexOf("/en-us/p/surface-book-2/8mcpzjjcc98c")){\n\t\tBootstrapper.imageRequest("https://secure.adnxs.com/px?id=1182149&seg=19686725&t=2");\t\t\n\t} \t\n}',language:"javascript"}}]},{id:"RL6aa63bb8d47c4dd5b51460f0542eefe4",name:"GBLDL",events:[{modulePath:"core/src/lib/events/libraryLoaded.js",settings:{},ruleOrder:-80}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n    var _TMDL = {\n        busgrp: [],\n        cc: "Unknown",\n        isprod: false,\n        geo: "",\n        host: window.location.hostname.toLowerCase(),\n        itemprices: [],\n        lineItems: [],\n        ll: "other",\n        muid: "",\n        pagename: "other",\n        pageName: "other",\n        pageType: "other",\n        path: window.location.pathname.toLowerCase(),\n        pids: [],\n        pidsku: [],\n        pnames: [],\n        prdCt: [],\n        prdFam: [],\n        prdPrCat: [],\n        prdSecCat: [],\n        prdSubCat: [],\n        prdType: [],\n        pT: "",\n        purchaseID: "",\n        quantities: [],\n        reflc: "",\n        revsumdiv: [],\n        sales: [],\n        skus: [],\n        totamount: 0,\n        totAmountWTax: 0,\n        totqty: 0,\n\n        logRuleCall: function (r, d, i) {\n            if (typeof _TMutils === \'object\') {\n                _TMutils.logRuleCall(r, d, i);\n            } else {\n                try {\n                    _satellite.logger.error("error in logging and no _satellite obj");\n                } catch (_saterr) { }\n            }\n        },\n\n        getQSParam: function (arr, param2find) {\n            var n,\n                i = 0,\n                j = arr.length,\n                nvpair = [];\n\n            for (i = 0; i < j; i++) {\n                nvpair = arr[i].split("=");\n                if (nvpair[0].toLowerCase() == param2find.toLowerCase() && nvpair[1]) {\n                    return nvpair[1];\n                }\n            }\n            return "";\n        },\n\n        readCookie: function (name) {\n            var nameEQ = name + "=";\n            var ca = document.cookie.split(\';\');\n            for (var i = 0; i < ca.length; i++) {\n                var c = ca[i];\n                while (c.charAt(0) == \' \') c = c.substring(1, c.length);\n                if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);\n            }\n            return null;\n        },\n\n        createCookie: function (name, value, days) {\n            var expires = "";\n            var date;\n            var domainstr = (~window.location.host.indexOf("microsoft.com")) ? "; domain=.microsoft.com; path=/; " : "; path=/; ";\n            if (days) {\n                date = new Date();\n                date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));\n                expires = "; expires=" + date.toGMTString();\n            }\n            document.cookie = name + "=" + value + expires + domainstr;\n        }\n    };\n\n    var qs = "",\n        qsdecoded = "",\n        qs2 = "",\n        qsarr = [],\n        jsonstr = "",\n        jsonobj = {},\n        jsonstr,\n        pt,\n        pc,\n        ptlower,\n        _pagetypemap = {}\n        ;\n\n    if (document.referrer) {\n        reflc = document.referrer.toLowerCase();\n    }\n\n    qs = (window.location.search) ? window.location.search : "";\n    if (qs.indexOf("?n=ensighten.html?") == 0) {\n        qs = qs.substring(17);\n    }\n\n    if (qs.indexOf("?") == 0) {\n        qs = qs.substring(1);\n    }\n\n    qs = qs.replace(/%20&%20/g, "%20%26%20");\n    qs = qs.replace(/ & /g, "%20%26%20");\n    qsarr = qs.split("&");\n\n    if (~window.location.host.indexOf("compass-ssl.xboxlive.com") || ~window.location.host.indexOf("query.prod.cms.rt.microsoft.com")) {\n        // top level params from iframe:  pN=cart&cl=en-US&market=US\n        _TMDL.purchaseID = _TMDL.getQSParam(qsarr, "orderId") || _TMDL.getQSParam(qsarr, "id");\n        _TMDL.muid = _TMDL.getQSParam(qsarr, "muid");\n        _TMDL.pageName = _TMDL.getQSParam(qsarr, "pN");\n        _TMDL.pageType = _TMDL.pageName;\n        _TMDL.geo = _TMDL.getQSParam(qsarr, "market");\n        _TMDL.ll = _TMDL.getQSParam(qsarr, "culture") || _TMDL.getQSParam(qsarr, "cl");\n        _TMDL.totamount = _TMDL.getQSParam(qsarr, "totAmtWoTx");\n        _TMDL.totAmountWTax = _TMDL.getQSParam(qsarr, "totAmt");\n        jsonstr = _TMDL.getQSParam(qsarr, "orderLineItems");\n\n        if (~reflc.indexOf("www.microsoft.com") && window.navigator.userAgent.toLowerCase().indexOf("soasta") < 0) { _TMDL.isprod = true; }\n\n        if (!jsonstr) {\n            _TMDL.logRuleCall("orderLineItems json missing");\n        } else {\n            try {\n                if (jsonstr.indexOf("[") > -1) {\n                    jsonstr = jsonstr.replace(/%22%20Dis/g, \'%20Dis\');\n                    jsonstr = jsonstr.replace(/portable%2013%22%20/g, \'portable%2013%20\');\n                    jsonstr = jsonstr.replace(/%22%204K/g, \'%204K\');\n                    jsonstr = jsonstr.replace(/%22Samsung%2049%22%20/g, \'%22Samsung%2049%20\');\n                    jsonstr = jsonstr.replace(/%22%2F/g, \'%2F\');\n                    jsonstr = jsonstr.replace(/5%22%20%2F/g, \'5%2F\');\n                    jsonstr = jsonstr.replace(/%223%2F4%22%20/g, \'%223%2F4%20\');\n                    jsonstr = jsonstr.replace(/15.6%22%20/g, \'15.6%20\');\n                    jsonstr = jsonstr.replace(/%22/g, \'"\');\n                    _TMDL.lineItems = JSON.parse(jsonstr);\n                } else {\n                    jsonstr = jsonstr.replace(/%22%20Dis/g, \'%20Dis\');\n                    jsonstr = jsonstr.replace(/portable%2013%22%20/g, \'portable%2013%20\');\n                    jsonstr = jsonstr.replace(/%22Samsung%2049%22%20/g, \'%22Samsung%2049%20\');\n                    jsonstr = jsonstr.replace(/%22%204K/g, \'%204K\');\n                    jsonstr = jsonstr.replace(/%22%2F/g, \'%2F\');\n                    jsonstr = jsonstr.replace(/5%22%20%2F/g, \'5%2F\');\n                    jsonstr = jsonstr.replace(/%223%2F4%22%20/g, \'%223%2F4%20\');\n                    jsonstr = jsonstr.replace(/15.6%22%20/g, \'15.6%20\');\n                    _TMDL.lineItems = JSON.parse(decodeURIComponent(jsonstr));\n                }\n            } catch (jsonparseerr) { _TMDL.logRuleCall("jsonparse error", "jsonparse error", window.location.search); _satellite.logger.error("jsonparse error"); }\n        }\n\n    } else if (typeof _pageBITags == "object") {\n        // consume _pageBITags object from the non-iframe pages (e.g. OneRF)\n        pt = _pageBITags.pageTags;\n        ptlower = pt.pageType.toLowerCase();\n        _TMDL.pageName = pt.pageName;\n        _TMDL.ll = pt.mkt;\n        _TMDL.lang = pt.mkt.split("-")[0];\n        _TMDL.geo = pt.mkt.split("-")[1];\n        _TMDL.pageType = pt.pageType;\n        if (~window.location.host.toLowerCase().indexOf("www.microsoft.com") && window.navigator.userAgent.toLowerCase().indexOf("soasta") < 0) { _TMDL.isprod = true; }\n\n        try {\n            _TMDL.muid = _TMDL.readCookie("MUID");\n        } catch (muiderr) { _TMDL.logRuleCall("muid err"); }\n\n        if (~ptlower.indexOf("category")) {\n\n            // CATEGORY PAGE\n\n            // https://onestore-ppe.microsoft.com/en-sg/store/b/surface?icid=CNavDevicesSurface&setswitch=optimizely_disabled%3A1%2Censighten_disabled%3D0\n\n        } else if ((~ptlower.indexOf("pdp") || ~ptlower.indexOf("detail")) && (typeof _pageBITags == "object" && typeof _pageBITags.pageContracts == "object" && typeof _pageBITags.pageContracts.ProductInfo == "object")) {\n            // PDP PAGE\n            pc = _pageBITags.pageContracts.ProductInfo;\n            _TMDL.pids.push(pc.id);\n            _TMDL.skus.push(pc.sku);\n            _TMDL.pidsku.push(pc.id + "-" + pc.sku);\n            _TMDL.prdCt.push(pc.prdCt);\n            _TMDL.prdPrCat.push(pc.priCat);\n            _TMDL.prdSecCat.push(pc.prdSecCat);\n            _TMDL.prdSubCat.push(pc.prdSubCat);\n            _TMDL.prdType.push(pc.family);\n            _TMDL.pnames.push(pc.title);\n            _TMDL.cc = pc.cur;\n            _TMDL.quantities.push(1);\n            _TMDL.sales.push(_pageBITags.pageContracts.ProductInfo.rtPrice);\n            _TMDL.quantities.push(1);\n            _TMDL.itemprices.push(_TMDL.sales[0]);\n        } else if ((~ptlower.indexOf("pdp") || ~ptlower.indexOf("detail")) && ~_TMDL.path.indexOf("/configure/")) {\n            ptlower = "configure";\n            _TMDL.pageType = "configure";\n        }\n    }\n\n    try {\n        // remap pagetypes\n        _pagetypemap = {\n            // old : new\n            "pdp": "detail",\n            "product details": "detail",\n            "sfw-pdp-pagetemplate": "detail",\n            "sfw-category-pagetemplate": "category",\n            "onestore-shoppingcart-template": "cart",\n            "congrats": "receipt"\n        };\n\n        if (_pagetypemap[_TMDL.pageType.toLowerCase()]) {\n            _TMDL.pageType = _pagetypemap[_TMDL.pageType.toLowerCase()];\n        }\n\n        _TMDL.pT = (_TMDL.pageType == "receipt") ? "rP" : _TMDL.pageType;\n\n        // added 7/12/18 due to Convergence making category pagetype less reliable\n\n        if (~window.location.pathname.indexOf("/b/") && window.location.pathname.indexOf("RETg7o") < 0) {\n            _TMDL.pageType = "category";\n        }\n\n    } catch (err) { _TMDL.logRuleCall("pageTypeMapError", _TMDL.pageType); }\n\n    //--------------------------------------------------------\n    // create backwards compatible arrays from orderLineItems\n    //--------------------------------------------------------\n\n    var temppname;\n    for (var i = 0; i < _TMDL.lineItems.length; i++) {\n        temppname = "";\n        _TMDL.pids.push((_TMDL.lineItems[i].pId) ? _TMDL.lineItems[i].pId : "");\n        _TMDL.skus.push((_TMDL.lineItems[i].sku) ? _TMDL.lineItems[i].sku : "");\n        try {\n            temppname = decodeURIComponent(_TMDL.lineItems[i].ti);\n        } catch (pnameerr) {\n            temppname = (_TMDL.lineItems[i].ti) ? _TMDL.lineItems[i].ti : "";\n        }\n        _TMDL.pnames.push(temppname);\n        _TMDL.sales.push((_TMDL.lineItems[i].tot && typeof _TMDL.lineItems[i].txA !== \'undefined\' && typeof _TMDL.lineItems[i].q !== \'undefined\') ? (_TMDL.lineItems[i].tot - (_TMDL.lineItems[i].q * _TMDL.lineItems[i].txA)) : _TMDL.lineItems[i].tot);\n        _TMDL.prdPrCat.push((_TMDL.lineItems[i].pC) ? _TMDL.lineItems[i].pC : "");\n        _TMDL.prdFam.push((_TMDL.lineItems[i].pF) ? _TMDL.lineItems[i].pF : "");\n        _TMDL.prdType.push((_TMDL.lineItems[i].pT) ? _TMDL.lineItems[i].pT : "");\n        _TMDL.pidsku.push(_TMDL.pids[i] + "-" + _TMDL.skus[i]);\n        _TMDL.quantities.push((_TMDL.lineItems[i].q) ? _TMDL.lineItems[i].q : 1);\n\n        if (_TMDL.lineItems[i].cur) {\n            _TMDL.cc = _TMDL.lineItems[i].cur;\n        }\n\n        _TMDL.totqty += _TMDL.quantities[i];\n        _TMDL.itemprices.push(_TMDL.sales[i] / _TMDL.quantities[i]);\n    }\n\n\n\n    var missingCCpagetype = "";\n    if (_TMDL.cc == "Unknown" && ~window.location.host.indexOf("query.prod.cms.rt.microsoft.com")) {\n        missingCCpagetype = (~window.location.href.indexOf("pN=congrats")) ? "receipt" : "cart";\n        if (missingCCpagetype == "receipt") { _TMDL.logRuleCall("missingCC" + missingCCpagetype + "_" + _TMDL.geo, "missingCC" + "_" + _TMDL.geo, window.location.search); }\n    }\n\n    var ccmap = {\n        \'US\': \'USD\',\n        \'AU\': \'AUD\',\n        \'BR\': \'BRL\',\n        \'CA\': \'CAD\',\n        \'CH\': \'CHF\',\n        \'DK\': \'DKK\',\n        \'GB\': \'GBP\',\n        \'JP\': \'JPY\',\n        \'MX\': \'MXN\',\n        \'NO\': \'NOK\',\n        \'RU\': \'RUB\',\n        \'SE\': \'SEK\',\n        \'AT\': \'EUR\',\n        \'BE\': \'EUR\',\n        \'CY\': \'EUR\',\n        \'DE\': \'EUR\',\n        \'ES\': \'EUR\',\n        \'FI\': \'EUR\',\n        \'FR\': \'EUR\',\n        \'GR\': \'EUR\',\n        \'IR\': \'EUR\',\n        \'IT\': \'EUR\',\n        \'LU\': \'EUR\',\n        \'NL\': \'EUR\',\n        \'PT\': \'EUR\',\n        \'NEVERHIT\': \'Unknown\'\n    };\n\n    if (_TMDL.cc == "Unknown" || _TMDL.cc == "") {\n        try {\n            if (ccmap[_TMDL.geo.toUpperCase()]) {\n                _TMDL.cc = ccmap[_TMDL.geo.toUpperCase()];\n            }\n        } catch (ccerr) { }\n    }\n\n    if (_TMDL.cc == "Unknown" && (window.location.href.indexOf(\'"EUR"\') > -1 || window.location.href.indexOf("%22EUR%22") > -1)) {\n        _TMDL.cc = "EUR";\n    }\n\n    _TMDL.pagename = _TMDL.pageName; // backwards compatibility for some tags\n    // make global for access in other tags\n    window._TMDL = window._TMDL || _TMDL;\n\n}\n\ncatch (err) { console.log("DataLayer: " + err.message); }',language:"javascript"}}]},{id:"RL6c53f8ac4ba649b88623621dc16038a2",name:"TradeDesk SurfacePurchase/FY24/US-CA-GB",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2024-07-31T00:00:00Z",start:"2023-10-01T00:00:00Z"}},{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")&&-1!==window.location.search.indexOf("Surface")&&(-1!==window.location.search.indexOf("market=US")||-1!==window.location.search.indexOf("market=GB")||-1!==window.location.search.indexOf("cl=en-CA"))}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!1,source:'try {\n    var pageLoad = new Image(1, 1);\n    pageLoad.src = "https://insight.adsrvr.org/track/pxl/?adv=f0kcflz&ct=0:cx75fgs&fmt=3";\n}\ncatch (err) {\n    console.log("Trade Desk Purchase Failed");\n}',language:"javascript"}}]},{id:"RL6e837a4ee338456db500b886b2d772c3",name:"Media_/en-au/store/b/student",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-au/store/b/student",valueIsRegex:!0},{value:"/en-au/store/b/student/",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",
settings:{source:'try\n{\n//DCM Hero\n  jQuery("div[id*=\'coreui-multihero-yko9tu6\']").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Check Eligibility Student"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?";\n});\n  \n//DCM Quick Links\n  jQuery("div[id*=\'oneStore-quicklinksmodule-hl74ock\']").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Check Eligibility Student"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?";\n}); \n  \n//ADNXS Hero\n  jQuery("div[id*=\'coreui-multihero-yko9tu6\']").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="//secure.adnxs.com/px?id=1268102&t=2";\n});\n  \n//ADNXS Quick Links\n  jQuery("div[id*=\'oneStore-quicklinksmodule-hl74ock\']").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="//secure.adnxs.com/px?id=1268102&t=2";\n});   \n  \n//Yahoo Hero\n  jQuery("div[id*=\'coreui-multihero-yko9tu6\']").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick";\n});\n  \n//Yahoo Quick Links\n  jQuery("div[id*=\'oneStore-quicklinksmodule-hl74ock\']").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick";\n});     \n   \n  \n }\ncatch(err)\n{\n\t_satellite.logger.error("Media_/en-au/store/b/student");\n}\n',language:"javascript"}}]},{id:"RL70810c3d3c384d509f69ecd9fbc30178",name:"LinkedIn Purchase/US-Surface/H1FY24",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")&&-1!==window.location.search.indexOf("market=US")&&-1!==window.location.search.indexOf("Surface")}}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2024-01-31T00:00:00Z",start:"2023-08-01T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n    var pageLoad = new Image(1, 1);\n    pageLoad.src = "https://px.ads.linkedin.com/collect/?pid=7850&conversionId=13710572&fmt=gif";\n}\ncatch (err) {\n    console.log("LinkedIn Purchase failed");\n}\n',language:"javascript"}}]},{id:"RL7d79c8419a9a418b8b1c73ae64a0c9e1",name:"DIGSHELL",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:45}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"\\/p\\/",valueIsRegex:!0},{value:"\\/d\\/",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n\twindow.shell_Tracking = {\n\n\t\t_init: function () {\n\t\t\tshell_Tracking.hostname = window.location.hostname.replace(/\\.microsoft\\.com$/i, \'\');\n\t\t\tshell_Tracking.URI = window.location.pathname.toString();\n\t\t\t//setup page path dimensions\n\t\t\tshell_Tracking._getPath();\n\t\t},\n\n\t\t_getIsProd: function () {\n\t\t\tvar env = \'test\';\n\t\t\tif (shell_Tracking.hostname.match(/\\./g)) {\n\t\t\t\tenv = \'test\';\n\t\t\t\tshell_Tracking.env = \'test\';\n\t\t\t} else if (window.location.hostname.match(/\\.microsoft\\.com$/i)) {\n\t\t\t\tenv = \'\';\n\t\t\t\tshell_Tracking.env = \'prod\';\n\t\t\t\tshell_Tracking.hostname = \'onestore\';\n\t\t\t}\n\t\t\treturn env;\n\t\t},\n\n\t\t_getLocale: function () {\n\t\t\tshell_Tracking.locale = shell_Tracking.URI.replace(/^\\/(..\\-..).*/i, \'$1\');\n\t\t\tvar locale = shell_Tracking.locale.replace(/\\-/ig, \'\').replace(/\\//ig, \'\').toLowerCase();\n\t\t\treturn locale;\n\t\t},\n\n\t\t_removeLocale: function () {\n\t\t\tvar path = shell_Tracking.URI.replace(/^\\/..\\-..\\/?(.*)/i, \'$1\').toLowerCase();\n\t\t\treturn path;\n\t\t},\n\n\t\t_getPath: function () {\n\t\t\tvar path = shell_Tracking._removeLocale();\n\t\t\tpath = path.replace(/\\/$/, \'\').replace(/^\\//, \'\');\n\t\t\tshell_Tracking.path = path;\n\t\t},\n\n\t\t_onBeforePageView: function () {\n\t\t\t/*\n\t\t\tvar authCookie = shell_Tracking._getCookie(\'StoreMsaUser\');\n\t\t\tif (authCookie) {\n\t\t\t\tshell_Tracking.auth = \'y\';\n\t\t\t} else {\n\t\t\t\tshell_Tracking.auth = \'n\';\n\t\t\t}\n\t\t\t*/\n\t\t},\n\n\t\t_getCookie: function (name) {\n\t\t\tvar nameEQ = name + "=";\n\t\t\tvar ca = document.cookie.split(\';\');\n\t\t\tfor (var i = 0; i < ca.length; i++) {\n\t\t\t\tvar c = ca[i];\n\t\t\t\twhile (c.charAt(0) == \' \') { c = c.substring(1, c.length); }\n\t\t\t\tif (c.indexOf(nameEQ) == 0) { return unescape(c.substring(nameEQ.length, c.length)); }\n\t\t\t}\n\t\t\treturn null;\n\t\t},\n\n\t\t_getMetaValue: function(name) {\n\t\t\treturn $(\'meta[name="\' + name + \'"]\').attr(\'content\');\n\t\t},\n\n\t\t_recordXboxDigitalPurchase: function (data) {\n\t\t\tvar worksonxbox = ((shell_Tracking._getMetaValue("ms\\\\.prod_worksonxbox") && shell_Tracking._getMetaValue("ms\\\\.prod_worksonxbox")!==\'false\') || (window.location.pathname.indexOf("xbox") > -1)) ? true : false;\n\t\t\tvar pass_type = shell_Tracking._getMetaValue("ms\\\\.prod_pass_type");\n\t\t\tvar productFamily = shell_Tracking._getMetaValue("ms\\\\.prod_family");\n\t\t\tvar lcpath = window.location.pathname.toLowerCase();\n\n\t\t   var tax = data.lineItems[0].taxAmount;\n\t\t   var price = data.lineItems[0].totalAmount - tax;\n\t\t   \n\t\t\t// original floodlight\n\t\t\t//shell_Tracking._dispatchDCMpurchase(worksonxbox,pass_type,productFamily,data,"src=6952136;type=store00;cat=store00");  // added 6/26/17 -- keep as the generic version\n\n\t\t\t\n\t\t\t//xbox live gold : \n\t\t\t\t// \tCFQ7TTC0K5ZM -- physical\n\t\t\t\t// \tcfq7ttc0k5dj -- digital\n\t\t\t\t//   /src=8391497;type=xlg_sale;cat=pch_dgtl;qty=1;cost=[Revenue];\n\t\t\t// games and gamepass:  //src=8406391;type=xgpg_sls;cat=pch_dgtl;qty=1;cost=[Revenue];\n\n\n\n\t\t\tif (~window.location.pathname.toLowerCase().indexOf("cfq7ttc0k5zm") || ~window.location.pathname.toLowerCase().indexOf("cfq7ttc0k5dj")) {\n\t\t\t\t// XboxLiveGold_GBL_PchComplete_Transaction_DigitalStore:  src=8391497;type=xlg_sale;cat=pch_dgtl\n\t\t\t\tshell_Tracking._dispatchDCMpurchase(worksonxbox,pass_type,productFamily,data,"src=8391497;type=xlg_sale;cat=pch_dgtl");\n\t\t\t\tif(_TMDL.fbpchurl) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t//fire facebook purchase pixel\n\t\t\t\t\t\tBootstrapper.imageRequest(_TMDL.fbpchurl+"&cd[value]="+price+"&cd[order_id]="+data.orderId);\n\t\t\t\t\t\tBootstrapper.imageRequest((_TMDL.fbpchurl+"&cd[value]="+price+"&cd[order_id]="+data.orderId).replace("464550763913771","1770559986549030"));\t\t\t\t\t\t\t\n\t\t\t\t\t} catch(fberr) {}\n\t\t\t\t}\n\t\t\t} else if (~lcpath.indexOf("cfq7ttc0k6l8") || ~lcpath.indexOf("cfq7ttc0kgq8") ||~lcpath.indexOf("cfq7ttc0khs0") || (productFamily && productFamily.toLowerCase() == \'passes\' && pass_type && pass_type.toLowerCase() == \'xbox\') || (productFamily.toLowerCase() == \'games\' && (worksonxbox || ~lcpath.indexOf("xbox") ) )) {\n\t\t\t\t//XboxGamePassGames_GBL_PchComplete_Transaction_DigitalStore\t/src=8406391;type=xgpg_sls;cat=pch_dgtl;qty=1;cost=[Revenue];\n\t\t\t\tshell_Tracking._dispatchDCMpurchase(worksonxbox,pass_type,productFamily,data,"src=8406391;type=xgpg_sls;cat=pch_dgtl");\n\t\t\t\tif(_TMDL.fbpchurl) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t//fire facebook purchase pixel\n\t\t\t\t\t\tBootstrapper.imageRequest(_TMDL.fbpchurl+"&cd[value]="+price+"&cd[order_id]="+data.orderId);\n\t\t\t\t\t\tBootstrapper.imageRequest((_TMDL.fbpchurl+"&cd[value]="+price+"&cd[order_id]="+data.orderId).replace("464550763913771","1770559986549030"));\t\t\t\t\t\t\t\n\t\t\t\t\t} catch(fberr) {}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t//WindowsSoftware_GBL_PchComplete_Transaction_DigitalStore:  src=8406157;type=stot_sl;cat=pch_dgtl\n\t\t\t\t//WindowsSoftware_GBL_PchComplete_Transaction_DigitalStore:   src=8406727;type=wsft_sls;cat=pch_dgtl;  (CORRECT ONE)\n\t\t\t\t//Store-Other_GBL_PchComplete_Transaction_DigitalStore:  src=8406391;type=xgpg;cat=pdv_dgtl\n\t\t\t\t\n\t\t\t\t//shell_Tracking._dispatchDCMpurchase(worksonxbox,pass_type,productFamily,data,"src=8406391;type=xgpg;cat=pdv_dgtl");\n\t\t\t\tshell_Tracking._dispatchDCMpurchase(worksonxbox,pass_type,productFamily,data,"src=8406727;type=wsft_sls;cat=pch_dgtl;");\n\t\t\t}\n\t\t\t\n\t\t\ttry {\n\t\t\t\tif (typeof _TMDL.convcallbacks!==\'undefined\') {\n\t\t\t\t\tfor (var i=0; i< _TMDL.convcallbacks.length; i++) {\n\t\t\t\t\t\t_TMDL.convcallbacks[i](data,price,tax,data.orderId);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch(callbackerr) {}\n\t\t\t\n\t\t},\n\t\t_dispatchDCMpurchase: function(worksonxbox,pass_type,productFamily,data,floodlightparams) {\n\t\t\t// added 6/26/17 -- this will be the older tag from before the DCM restructure\n\t\t\tvar a = "" + parseInt(1E5 * 1E4 * Math.random() * Math.random(),10)+ parseInt((Math.random() * 100000000),10);\n\t\t\t//var shell_locale = shell_Tracking.locale || shell_Tracking.URI.replace(/^\\/(..\\-..).*/i, \'$1\');\n\t\t\t//var geo = shell_locale.split("-")[1];\n\t\t   //var locale = shell_locale.replace(/\\-/ig, \'\').replace(/\\//ig, \'\').toLowerCase();\n\t\t   var title = data.lineItems[0].title;\n\t\t   var productType = data.lineItems[0].productType;\n\t\t   var productId = data.lineItems[0].productId;\n\t\t   var availabilityId = data.lineItems[0].availabilityId;\n\t\t   var tax = data.lineItems[0].taxAmount;\n\t\t   var price = data.lineItems[0].totalAmount - tax;\n\t\t   var currencyCode = data.lineItems[0].currencyCode;\n\t\t   //var paymentTypeEvent = \'\';\n\t\t\tvar url = "https://ad.doubleclick.net/ddm/activity/"+floodlightparams+";qty=1;cost="+price+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t +";u25="+productId\n\t\t\t +";u26="+encodeURIComponent(title)\n\t\t\t +";u30="+productType\n\t\t\t +";u31="+currencyCode\n\t\t\t +";u32="+productId\n\t\t\t +";u33="+productId\n\t\t\t +";u34="+data.orderId\n\t\t\t //+";u35="+_TMDL.totqty\n\t\t\t +";u35=1"\n\t\t\t +";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+data.orderId;\n\n\t\t var px = new Image(1, 1);\n\t\t px.src = url;\n\t  },\n\t\t\n\t\t_dispatchGamePassGamesRT: function () {\n\t\t\tvar url = "https://www.facebook.com/tr?id=1218689904914212&ev=PageView&noscript=1";\n\t\t\tvar px = new Image(1, 1);\n\t\t\tpx.src = url;\n\t\t\tBootstrapper.imageRequest("https://googleads.g.doubleclick.net/pagead/viewthroughconversion/968413686/?value=0&guid=ON&script=0");\n\t\t\tBootstrapper.imageRequest("https://bat.bing.com/action/0?ti=4000034&Ver=2");\n\t\t},\n\n\t};\n\t\n\tvar url="";\n\tvar worksonxbox = shell_Tracking._getMetaValue("ms\\\\.prod_worksonxbox")=="true" || (window.location.pathname.toLowerCase().indexOf("xbox") > -1) || (typeof _TMDL.pnames[0] !== \'undefined\' && _TMDL.pnames[0].toLowerCase().indexOf("xbox")>-1);\n\tvar type = $(\'meta[name="ms\\\\.prod_type"]\').attr(\'content\') || \'\';\n\tvar pass_type = $(\'meta[name="ms\\\\.prod_pass_type"]\').attr(\'content\') || \'\';\n\tif (worksonxbox && type && (type.toLowerCase() == \'games\' || type.toLowerCase() == \'addons\') || (window.location.pathname.match(/\\/xbox$/i)) || (pass_type && pass_type.toLowerCase() == \'xbox\')) {\n\n\t\tshell_Tracking._init();\n\n\t\trequire([\'jquery\'], function ($) {\n\t\t\t$(\'document\').ready(function () {\n\t\t\t\ttry {\n\t\t\t\t\t//shell_Tracking._onBeforePageView();\n\t\t\t\t\t//shell_Tracking._recordOmniturePageView();\n\t\t\t\t\t//shell_Tracking._initClickTracking();\n\t\t\t\t} catch (ex) { }\n\t\t\t});\n\t\t});\n\t}\n}\ncatch(err)\n{\n\t_satellite.logger.error("DIGSHELL");\t\n}\n\n',language:"javascript"}}]},{id:"RL804049235a48433cb1e82263436fba08",name:"ADOBEDCORTG",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/*  Adobe DCO Retargeting tag\n*/\n\ntry {\n\t// landing pages\n\tvar rand = parseInt(1E5 * 1E4 * Math.random() * Math.random());\n\tvar u="";\n\tvar lang = (_TMDL.ll.indexOf("-")>-1) ? _TMDL.ll.split("-")[0].toLowerCase() : "";\n\tvar utstring = "&ut1="+_TMDL.pidsku.join("%2C")+"&ut2="+lang+"&ut3="+_TMDL.geo.toLowerCase()+"&cachebuster="+rand;\n\n\tif (_TMDL.pT.indexOf("cart")<0 && _TMDL.pageType!==\'rP\' ) {\n\t\t// landing pages\n\t\tu="https://ats.everesttech.net/ats/ats?cmd=RT&AdvertiserID=4249&platform=TUMRI&ActionID=20114&ActionName=Microsoft_Store_RT_Pixel"+utstring;\n\t\tBootstrapper.imageRequest(u); \n\t}\n\n\tif (~_TMDL.pT.indexOf("rP") && _TMDL.isprod) {\n\t\tu="https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50081&ActionName=Microsoft_Store_Conv_Pixel&Revenue="+_TMDL.totamount+"&TransactionID="+_TMDL.purchaseID+"&Currency="+_TMDL.cc+utstring;\n\t\tBootstrapper.imageRequest(u); \n\t} else if (~_TMDL.pageType.toLowerCase().indexOf("cart") && _TMDL.isprod) {\n\t\tu="https://ats.everesttech.net/ats/ats?cmd=RT&AdvertiserID=4249&platform=TUMRI&ActionID=20132&ActionName=Microsoft_Store_Cart_Abandoner"+utstring;\n\t\tBootstrapper.imageRequest(u); \n\t}\n} catch(err){\n\tif (_satellite) {\n\t  _satellite.logger.error("Adobe DCO Retargeting Error");\n\t  if (_TMutils){_TMutils.logRuleCall("Adobe DCO Retargeting",err.message,u);}\n\t} \n}\n',language:"javascript"}}]},{id:"RL81d828f12cec453ba0309f909a2aaf39",name:"Media_/EN-US/d/surface Twitter (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/d/surface",valueIsRegex:!0},{value:"/en-us/d/surface/",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n  \n  //Page Load\n  var image = new Image(1,1);\n  image.src = "https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n  var image2 = new Image(1,1);\n  image2.src="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n\n  \n   //Configure Now button\njQuery("a:contains(\'Configure now\'),button:contains(\'Configure now\')").on("mousedown", function(){\nvar image = new Image(1,1);\n  image.src = "https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9u&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\nvar image2 = new Image(1,1);  \n  image2.src="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n});\n  \n   //Surface Laptop Go for Business Button\njQuery("[href=\'https://www.microsoft.com/en-us/p/surface-laptop-go-for-business/8NR6D2WCLC72?icid=PDP_LaptopGo_forbusiness_C97_060421\']").on("mousedown", function(){\nvar image = new Image(1,1);\n  image.src = "https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\nvar image2 = new Image(1,1);\n  image2.src="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("Media_/EN-US/d/surface Twitter (AEM/RT)");\n}',language:"javascript"}}]},{id:"RL83f784964f9f4aeb89f164274dec4c93",name:"XANDR Universal LP",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/*\nxandr universal \nhttps://ib.adnxs.com/pixie?pi=8b1ad172-7b69-4621-be02-60f12c250344&e=Purchase&ii=CFQ7TTC0K7C8&in=Office%20Home%20%20Student%202019%2CUS%2CUSD&itp=office&va=1.99&script=0\n//imgurl = "https://ib.adnxs.com/pixie?pi=8b1ad172-7b69-4621-be02-60f12c250344&e=Purchase&ii=test&in=test&itp=test&va=0&script=0";\n*/\n\n\n(function() {\n\ttry {\n\t\tvar imgurl="",pn=[],itp=[],c=",";\n\t\tfor (var i=0; i<_TMDL.pids.length; i++) {\n\t\t\tpn[i]=encodeURIComponent(_TMDL.pnames[i]).slice(0,100);\n\t\t\tif ((typeof(_TMDL.dcmcat)==\'object\') && (typeof(_TMDL.dcmcat[i])==\'string\')) {\n\t\t\t\titp.push(encodeURIComponent(_TMDL.dcmcat[i]).slice(0,100));\n\t\t\t}\n\t\t}\n\t\tif (_TMDL.pT=="rP") {\n\t\t\timgurl = "https://ib.adnxs.com/pixie?pi=8b1ad172-7b69-4621-be02-60f12c250344&e=Purchase&ii="+_TMDL.pids.join(c)\n\t\t\t\t+"&in="+_TMDL.geo+c+_TMDL.cc+c+pn.join(c)\n\t\t\t\t+"&itp="+itp.join(c)+"&va="+_TMDL.totamount+"&u="+encodeURIComponent(window.location.protocol+"//"+window.location.host+window.location.pathname)+"&script=0";\n\t\t\tBootstrapper.imageRequest(imgurl);\n\t\t}\n\t} catch(e) { _satellite.logger.log("warn: "+e);\t}\n})();\n',language:"javascript"}}]},{id:"RL9092ef86ecbc48cebb72d1cd61b6a4f1",name:"Media.SurfaceDuo_CPE (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/surface/devices/surface-duo"},{value:"/en-us/surface/devices/surface-duo/"}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n//Note - This page belongs with the Surface property. Rule likely can be removed.\n  \n// ADNXS\n   //Main & Sticky Header\n  jQuery("a:contains(\'SHOP NOW\')").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n});\n //Bottom of page - Removing as this is no longer on page\n /*\njQuery("a.c-call-to-action.c-glyph:eq(17)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n});\n*/\n  \n\n//DoubleClick\n  //Main & Sticky Header\n jQuery("a:contains(\'SHOP NOW\')").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u50=PRE-ORDER"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=;gdpr_consent=${gdpr_consent_755};ord=1?";\n});\n  \n   \n //Bottom of page  Removing as this is no longer on page\n /*\njQuery("a.c-call-to-action.c-glyph:lt(17)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u50=PRE-ORDER"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=;gdpr_consent=${gdpr_consent_755};ord=1?";\n});\n*/\n  \n}\ncatch(err)\n{\n\t_satellite.logger.error("Media.SurfaceDuo_CPE (AEM/RT)");\n}\n',language:"javascript"}}]},{id:"RL9287f2337be44c2fba49bde96a312917",name:"GOOGRTG",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n\tvar totamount = 0,\n\t  totvalstring = "",\n\t  googpagetype = "other",\n\t  prodstring = "",\n\t  img="";\n\tvar pagetypemap = {\n\t  "home": "home",\n\t  "search": "searchresults",\n\t  "detail": "product",\n\t  "category": "category",\n\t  "checkout_shopping_cart": "cart",\n\t  "cart": "cart",\n\t  "list": "category",\n\t  "receipt": "purchase"\n\t};\n\n\ttry {\n\t  if (_TMDL.pageType && pagetypemap[_TMDL.pageType.toLowerCase()]) {\n\t\tgoogpagetype = pagetypemap[_TMDL.pageType.toLowerCase()];\n\t  }\n\t  for (var i = 0; i < _TMDL.pids.length; i++) {\n\t\tif (parseFloat(_TMDL.sales[i]) > 0) {\n\t\t  totamount += parseFloat(_TMDL.sales[i]);\n\t\t}\n\t  }\n\t} catch (e) {}\n\n\tif (_TMDL.pidsku.length) {\n\t  prodstring = "%3Becomm_prodid%3D" + _TMDL.pidsku.join("%2C"); \n\t}\n\n\tif (totamount > 0) {\n\t  totvalstring = "%3Becomm_totalvalue%3D" + totamount;\n\t}\n\n\timg = "//googleads.g.doubleclick.net/pagead/viewthroughconversion/923371515/?guid=ON&script=0&url=" + encodeURIComponent(window.location.hostname + window.location.pathname) + "&data=ecomm_pagetype%3D" + googpagetype + prodstring + totvalstring;\n\n\tvar c=new Image(0,0);\n\tc.src=img;\n}\ncatch(err)\n{\n\t_satellite.logger.error("GOOGRTG");\t\n}\n',language:"javascript"}}]},{id:"RL9db76557933946afb2f25ace5add098c",name:"BoostHomepage",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"https://www.microsoft.com/en-us"==window.location.href||"https://www.microsoft.com/en-us/"==window.location.href}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"var firstConfig = '[data-automation-test-id*=\"HighlightCarouselInnerSectionListItem\"]';\n\ntry {\n    attachPixels(firstConfig);\n} catch (e) {\n    console.log(\"Boost Homepage has failed\");\n}\n\nfunction attachPixels(elementAddress) {\n    $(document).on('mousedown', elementAddress, '', function () {\n        window.boost = window.boost || [];\n        window.boost.push('event', 'click', { 'event_label': _TMDL.pageName });\n    });\n}",language:"javascript"}}]},{id:"RL9e4616553b5a4f2591e696eba0cfde85",name:"Media_/LL-LL/ Xandr Purchase",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2024-07-31T00:00:00Z",start:"2021-08-18T00:00:00Z"}},{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// Xandr Purchase\ntry\n{\nvar LimitString = function (item, index, arr) {\narr[index] = item.substr(0,98)};\n_TMDL.pnames.forEach(LimitString);\nvar image = new Image(1, 1);\nimage.src ="https://ib.adnxs.com/pixie?pi=94211d4b-5aba-46aa-8d38-30818c4beba9&e=Purchase&ii="+_TMDL.pids+"&in="+_TMDL.pnames.toString().substr(0,1800)+","+_TMDL.geo+","+_TMDL.cc+"&itp="+_TMDL.prdType+"&va="+_TMDL.totamount+"&script=0";\n}\ncatch(err)\n{\n_satellite.logger.error("Media_/LL-LL/ Xandr Purchase");\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n',language:"javascript"}}]},{id:"RL9effe5e8fdb64618b9c8c6b182f342ae",name:"XboxGrCPE_PMP CTA",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"(us|ca|au|gb)\\/store\\/b\\/xbox",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// OVERWRITES jquery contains to make it case insensitive\njQuery.expr[\':\'].contains = function(a, i, m) {\n  return jQuery(a).text().toUpperCase()\n      .indexOf(m[3].toUpperCase()) >= 0;\n};\n\nvar debug=0,fireDCM=1;\nvar ll=_TMDL.geo.toLowerCase();\n\nfunction attachAnalyticsToElement(elementAddress, actionName, actionURL) {\n\t$(document).on(\'mousedown\', elementAddress, \'\', function() {\n\t\tif (debug) { \n\t\t\tconsole.log(actionName); \n\t\t}\n\n\t\tvar j={},pid="",cN="",u="",hr="";\n\t\tvar\ta = "" + (Math.random() * 10000000000000);\n\n\t\ttry {\n\t\t\tj=JSON.parse($(this).attr("data-m"));\n\t\t\tpid = j.pid;\n\t\t\tcN= j.cN;\n\t\t\t//hr=this.href;\n\t\t} catch(proderr) {\n\t\t\tif (debug) { \n\t\t\t\tconsole.log("catch "+ actionName + " " + hr); \n\t\t\t}\n\t\t}\n\n\t\tu=actionURL + ";u1="\n\t\t+_TMDL.geo\n\t\t+";u2="+_TMDL.ll\n\t\t+";u6="+encodeURIComponent(window.location.pathname)\n\t\t+";u25="+pid\n\t\t+";u26="+encodeURIComponent(cN)\n\t\t+";u50="+encodeURIComponent(cN)\n\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="\t+ a + "?";\n\n\t\tif (debug) { \n\t\t\tconsole.log(actionName+" u25="+pid+" u26="+cN+"\\t"+u); \n\t\t}\n\n\t\tif (fireDCM) {\n\t\t\tBootstrapper.imageRequest(u);\n\t\t}\n\t});\n}\n\n\nif (ll=="us" || ll=="ca" || ll=="gb" || ll=="au") {\n\ttry {\n\t\tattachAnalyticsToElement(\n\t\t\t\'a.small-icon, a.f-image\',\n\t\t\t\'Hero banner click on Learn More or Free Return & Shipping Icons above the hero\',\n\t\t\t\'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=lrn_std\');\n\n\t\tattachAnalyticsToElement(\n\t\t\t"div[id*=\'oneStore-quicklinksmodule-\'] a.large-icon, div[id*=\'coreui-hero-\'] ul li:contains(\'SHOP NOW\'), div[id*=\'coreui-hero-\'] ul li:contains(\'Shop now\')",\n\t\t\t\'Hero banner click on Shop Now or icon menu below banner\',\n\t\t\t\'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=pchn_std\');\n\n\t\tattachAnalyticsToElement(\n\t\t\t"div[id*=\'coreui-hero-\'] ul li:contains(\'Learn more\')",\n\t\t\t\'Hero banner click on Learn More\',\n\t\t\t\'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=lrn_std\');\n\n\t\tattachAnalyticsToElement(\n\t\t\t"div:contains(\'Shop\') section.m-content-placement-item, div:contains(\'Join\') section.m-content-placement-item",\n\t\t\t\'Click on c-call-to-action Shop Now\',\n\t\t\t\'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=pchn_std\');\n\n\t\tattachAnalyticsToElement(\n\t\t\t"div[id*=\'coreui-productplacement\'] div.m-channel-placement-item, div[id*=\'coreui-productplacement\'] a.c-hyperlink",\n\t\t\t\'Click on m-channel-placement on the product trays\',\n\t\t\t\'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=pchn_std\');\n\n\t\tattachAnalyticsToElement(\n\t\t\t"div:contains(\'Learn more\') section.m-content-placement-item",\n\t\t\t\'Click on c-call-to-action Learn More\',\n\t\t\t\'https://ad.doubleclick.net/ddm/activity/src=8391491;type=xbxp;cat=lrn_std\');\n\t} catch(clkerr) {\n\t\tconsole.log("Xbox PMP CPE Error");\n\t}\n}',language:"javascript"}}]},{id:"RLa67f4dc061f942af82f4b73a8ddb9b42",name:"VRZNCVF",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/*\nVerizonCVF\n*/\n\ntry {\n\tvar i=0,inScope=0,imageURL="",g=_TMDL.geo.toLowerCase();\n\tif (g=="us" || g=="de" || g=="fr" || g=="gb" || g=="au" || g=="jp" || g=="ca") {\n\t\tfor (i=0; i<_TMDL.pidsku.length; i++) {\n\t\t\tif (~_TMDL.pnames[i].toLowerCase().indexOf("surface") || ~_TMDL.pnames[i].toLowerCase().indexOf("xbox")) {\n\t\t\t\tinScope=1;\n\t\t\t} \n\t\t}\n\t}\n\tif (g=="sg" || g=="nl" || g=="se" || g=="no" || g=="dk" || g=="ie" || g=="es" || g=="ch") {\n\t\tfor (i=0; i<_TMDL.pidsku.length; i++) {\n\t\t\tif (~_TMDL.pnames[i].toLowerCase().indexOf("surface")) {\n\t\t\t\tinScope=1;\n\t\t\t} \n\t\t}\n\t}\n\n\tif (inScope) {\n\t\tif (_TMDL.pT=="cart") {\n\t\t\timageURL = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=AddToCart&langgeo="+_TMDL.ll+"&product_id="+_TMDL.pidsku.join(",");  \n\t\t} else if (_TMDL.pT=="rP") {\n\t\t\timageURL = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=Purchase&langgeo="+_TMDL.ll+"&product_id="+_TMDL.pidsku.join(",")+"&gv="+_TMDL.totamount;\n\t\t} \n\t\tBootstrapper.imageRequest(imageURL);\n\t}\n} catch(e) {\n  _satellite.logger.error("VerizonCVF");\n}',language:"javascript"}}]},{id:"RLa7f4e9bd070e4fedb22dccc5fbfd1f05",name:"DCM.HomeBar",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/store/b/sale"},{value:"/en-us/store/b/sale/"},{value:"/fr-ca/store/b/sale/"},{value:"/fr-ca/store/b/sale/"},{value:"/en-ca/store/b/sale"},{value:"/en-ca/store/b/sale/"},{value:"/en-gb/store/b/student"},{value:"/en-gb/store/b/student/"},{value:"/fr-fr/store/b/student"},{value:"/fr-fr/store/b/student/"},{value:"/de-de/store/b/student"},{value:"/de-de/store/b/student/"}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\njQuery("#uhf-g-nav").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Homebar Options "+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n\t});\n} \ncatch(err) {\n\t_satellite.logger.error("DCM.Homebar");\n}',language:"javascript"}}]},{id:"RLa95c5c1f9ffa4ad69c72b6459e7ef0bc",name:"AU/ConsumerConsultationTag",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-au/store/b/online-computer-shopping-appointments",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// JavaScript source code\ntry {\n    //Floodlight pv\n    var image = new Image(1, 1);\n    image.src = "https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo0;u1=" + _TMDL.geo + ";u2=" + _TMDL.ll + ";u6=" + encodeURIComponent(_TMDL.pagename) + ";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u52=Visit;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?";\n\n    // Yahoo pv\n    var image = new Image(1, 1);\n    image.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&he={INSERT_MACRO_HERE}&ea=AUSLandingPageVisit";\n\n    // training - training\n    $(\'a[href*="https://digitalreservations.microsoft.com/en-au/appointment/create"]\').on("mousedown", function () {\n        var cN = $(this).attr("data-bi-cn");\n        \n        var image = new Image(1, 1);\n        image.src = "https://ad.doubleclick.net/ddm/activity/src=8406733;type=corpothe;cat=corpo000;u1=" + _TMDL.geo + ";u2=" + _TMDL.ll + ";u6=" + encodeURIComponent(_TMDL.pagename) + ";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u50=" + cN + ";u52=Click;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?";\n\n        //Yahoo clk\n        image2 = new Image(1, 1);\n        image2.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&he={INSERT_MACRO_HERE}&ea=AUSbuttonclick";\n    });\n\n}\ncatch (err) {\n    _satellite.logger.error("AU/ConsumerConsultationTag");\n}',language:"javascript"}}]},{id:"RLab2298c7467f48a6ad45da5d885a3a2d",name:"AUSurfSMB",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return~window.location.href.toLowerCase().indexOf("www.microsoft.com/en-au/p/surface-pro-6-for-business-choice-of-accessory/8p88kcx6r5s7")||~window.location.href.toLowerCase().indexOf("www.microsoft.com/en-au/d/surface-pro-6-for-business-choice-of-accessory/8p88kcx6r5s7")||~window.location.href.toLowerCase().indexOf("www.microsoft.com/en-au/p/surface-book-2-for-business-choice-of-accessory/8pcw0wkflz2x")||~window.location.href.toLowerCase().indexOf("www.microsoft.com/en-au/d/surface-book-2-for-business-choice-of-accessory/8pcw0wkflz2x")||~window.location.href.toLowerCase().indexOf("www.microsoft.com/en-au/store/b/business")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{
source:'/*  AU Surface SMB \n\nCampaign:  AU Surface SMB\nContact: Lauren Ward @ Carat\nTags:  Outbrain, DV360\n*/\n\n// Landing Page Tags\n\n// DV360 Activity Name: Microsoft_LP_landing page\nvar\ta = "" + (Math.random() * 10000000000000);\nBootstrapper.imageRequest(\'https://ad.doubleclick.net/ddm/activity/src=6487971;type=invmedia;cat=micro00;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=\' + a + \'?\');\n// Appnexus Microsoft_LP_landing page\nBootstrapper.imageRequest("https://secure.adnxs.com/px?id=1120808&seg=18111539&t=2");\n\n\n$(document).on(\'mousedown\',\'button[id*="buttons_BuildABundleButton"]\',\'\', function() {\n\t// Outbrain\n\tBootstrapper.imageRequest("https://tr.outbrain.com/pixel?marketerId=00fbc5a6837b6c040daa1e33bdf0cadcaa&name=lead");\n\t// DV360 Activity Name:  Microsoft_Int_button click\n\tBootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=6487971;type=invmedia;cat=micro000;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=1?");\n\t// Appnexus Microsoft_Int_button click\n\tBootstrapper.imageRequest("https://secure.adnxs.com/px?id=1120809&seg=18111541&t=2");\n});\n',language:"javascript"}}]},{id:"RLab4fd1d7566a4c858a54b382ad0c6b73",name:"BingSurfClkCustom (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:80}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return~window.location.pathname.toLowerCase().indexOf("/d/")&&~window.location.pathname.toLowerCase().indexOf("surface")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"/*\n\nRule: BingSurfClkCustom\n\nreturn (~window.location.pathname.toLowerCase().indexOf(\"/p/\") && ~window.location.pathname.toLowerCase().indexOf(\"surface\")\t)\n\n*/\n\nvar tempobj; \n\ntry {\n\n\tif (~window.location.pathname.toLowerCase().indexOf(\"surface\") && ~window.location.pathname.toLowerCase().indexOf(\"/d/\") && window.navigator.userAgent.toLowerCase().indexOf(\"soasta\")<0 && (typeof uetq=='object')) {\n\n\t\ttempobj={};\n\t\t\n\t\tif (_TMDL.pidsku.length > 0) {\n\t\t\ttempobj.ecomm_prodid = (_TMDL.pidsku.length>0) ? _TMDL.pidsku : \"\";\n\t\t\ttempobj.ecomm_pagetype = \"product\";\n\t\t\ttempobj.items = [\n\t\t\t\t{\n\t\t\t\t  'id': _TMDL.pidsku[0],\n\t\t\t\t  'category': 'surface',\n\t\t\t\t  'price' : _TMDL.sales[0]\n\t\t\t\t}\n\t\t\t]\n\t\t}\n\t\t\n\t\t// Configure Now CTA\n        /*\n\t\t$(document).on('mousedown','button[id*=\"ConfigureDeviceButton\"]','', function() {\n\t\t\twindow.uetq.push('event','configurenow', tempobj); \n\t\t});\n        */\n      \n\t\t// Configure Now CTA - Updated 7/19 to correct ID\n        jQuery(\"a:contains('Configure now'),button:contains('Configure now')\").on(\"mousedown\", function(){\n            window.uetq.push('event','configurenow', tempobj); \n         });\n      \n\t\t// BuildYourBundle CTA\n        $(document).on('mousedown','button[id*=\"buttons_BuildABundleButton\"],a[href*=\"/store/build/\"]','', function() {\n\t\t\twindow.uetq.push('event','buildyourbundle', tempobj); \n\t\t});\n\t\t\t\n\t\t\n\t\t// check your eligibility CTA\n\t\t\n\t\t$(document).on('mousedown',\"a[href*='student-discounts?successurl']\",'', function() {\n\t\t\twindow.uetq.push('event','checkeligibility', tempobj); \n\t\t});\n      \n      \t// Add to Cart button, particularly needed for Surface Go PDP\n\t\t$(document).on('mousedown','button[id*=\"buttons_AddToCartButton\"]','', function() {\n\t\t\twindow.uetq.push('event','addtocartbutton', tempobj); \n\t\t});\t\t\n\t}\n} catch(bingerr) {console.log(\"bing onclick err\");}\n",language:"javascript"}}]},{id:"RLae38a03ca6914b4dbd6fc77c006a5ad3",name:"XTAAMCVFSignals",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// AAM Image Pixel for Cart Flow\ntry\n{\n\tvar pn = _TMDL.pageName,extraSignals = "",imgurl="",_ts;\n\n\tif (pn == "receipt" || pn=="congrats") {\n\t\textraSignals = \t"&c_purchasepid="+encodeURIComponent(_TMDL.pids.join("|"))\n\t\t\t\t\t\t+"&c_purchasepidsku="+encodeURIComponent(_TMDL.pidsku.join("|"))\n\t\t\t\t\t\t+"&c_purchasepnames="+encodeURIComponent(_TMDL.pnames.join("|"))\n\t\t\t\t\t\t\n\t} else if (~pn.indexOf("interstitial") || ~pn.indexOf("cart")) {\n\t\textraSignals = \t"&c_cartpid="+encodeURIComponent(_TMDL.pids.join("|"))\n\t\t\t\t\t+"&c_cartpidsku="+encodeURIComponent(_TMDL.pidsku.join("|"))\n\t\t\t\t\t+"&c_cartpnames="+encodeURIComponent(_TMDL.pnames.join("|"));\n\t} \n\n\tif (extraSignals) {\n\t\t_ts= (new Date).getTime();\n\t\timgurl = "https://mscom.demdex.net/event?d_nsid=0&d_ld=_ts%3D"+_ts+"&d_rtbd=json&d_jsonv=1&d_dst=1"\n\t\t//+"&d_cb=demdexRequestCallback_0_1521748306026"\n\t\t+"&c_ms.siteorg=Retail&c_ms.sitename=Store"\n\t\t+"&c_ms.pagetype="+_TMDL.pageType\n\t\t+"&c_ms.sup_ln="+_TMDL.ll\n\t\t+extraSignals;\n\n\t\tBootstrapper.imageRequest(imgurl);\n\t}\n}\ncatch(err)\n{\n\t_satellite.logger.error("XTAAMCVG");\t\n}',language:"javascript"}}]},{id:"RLafca8ec24b594c8e8d900f5fd9373a36",name:"VRZN_LP_Srfc",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"^/en-us/d/surface.*",valueIsRegex:!0},{value:"^/en-ca/d/surface.*",valueIsRegex:!0},{value:"^/de-de/d/surface.*",valueIsRegex:!0},{value:"^/fr-fr/d/surface.*",valueIsRegex:!0},{value:"^/en-gb/d/surface.*",valueIsRegex:!0},{value:"^/en-au/d/surface.*",valueIsRegex:!0},{value:"^/jp-jp/d/surface.*",valueIsRegex:!0},{value:"^/en-ca/d/surface.*",valueIsRegex:!0},{value:"^/fr-ca/d/surface.*",valueIsRegex:!0},{value:"^/en-sg/d/surface.*",valueIsRegex:!0},{value:"^/nl-nl/d/surface.*",valueIsRegex:!0},{value:"^/sv-se/d/surface.*",valueIsRegex:!0},{value:"^/nb-no/d/surface.*",valueIsRegex:!0},{value:"^/da-dk/d/surface.*",valueIsRegex:!0},{value:"^/en-ie/d/surface.*",valueIsRegex:!0},{value:"^/es-es/d/surface.*",valueIsRegex:!0},{value:"^/de-ch/d/surface.*",valueIsRegex:!0},{value:"^/fr-ch/d/surface.*",valueIsRegex:!0},{value:"^/(d|p)/surface.*",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n  var image = new Image(1,1);\n  image.src = "//sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=ViewProduct&product_id=" + _pageBITags.pageContracts.ProductInfo.id + "-" + _pageBITags.pageContracts.ProductInfo.sku;\n}\ncatch(err)\n{\n\t_satellite.logger.error("Verizon_LP");\n}',language:"javascript"}}]},{id:"RLb84483393e0944389f21094936208317",name:"Media_/ja-jpr/store/b/sale",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/ja-jp/store/b/sale"},{value:"/ja-jp/store/b/sale/"}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n  \n// ADNXS\n \n //Featured Product Image Links\njQuery(".m-content-placement-item:lt(11)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n});\n //Product Cards  \njQuery("div.m-channel-placement-item.f-wide.f-full-bleed-image").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n});\n  \n\n\n//DoubleClick\n \n  //Featured Product Image Links\njQuery(".m-content-placement-item:lt(11)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Shop Now"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n  \n  //Product Cards  \njQuery("div.m-channel-placement-item.f-wide.f-full-bleed-image").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Product Options"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n  \n  \n//Yahoo\n \n  //Featured Product Image Links\njQuery(".m-content-placement-item:lt(11)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick");\n});\n  \n  //Product Cards  \njQuery("div.m-channel-placement-item.f-wide.f-full-bleed-image").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick");\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("Media_/ja-jp/store/b/sale");\n}\n  ',language:"javascript"}}]},{id:"RLb9638e6a11854c11b48d315d3f8fc064",name:"Media.ja-jp.store.b.surface-studentdeals",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/ja-jp/store/b/surface-studentdeals"},{value:"/ja-jp/store/b/surface-studentdeals/"}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// JavaScript source code\ntry {\n    //ADNXS\n    jQuery(".m-hero, #primaryR4, #primaryR6, #onestore-quicklinksmodule-s99z4gv-quicklink1, #onestore-quicklinksmodule-s99z4gv-quicklink2, #onestore-quicklinksmodule-s99z4gv-quicklink3").on("mousedown", function () {\n        var image = new Image(1, 1);\n        image.src = "//secure.adnxs.com/px?id=1268102&t=2";\n    });\n\n    //DCM\n    jQuery(".m-hero, #primaryR4, #primaryR6, #onestore-quicklinksmodule-s99z4gv-quicklink1, #onestore-quicklinksmodule-s99z4gv-quicklink2, #onestore-quicklinksmodule-s99z4gv-quicklink3").on("mousedown", function () {\n        var image = new Image(1, 1);\n        image.src = "https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1=" + _TMDL.geo + ";u2=" + _TMDL.ll + ";u6=" + encodeURIComponent(_TMDL.pagename) + ";u25=" + _TMDL.pids[0] + ";u26=" + encodeURIComponent(_TMDL.pnames[0]) + ";u50=Check Eligibility Student" + ";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?";\n    });\n\n    //Yahoo\n    jQuery(".m-hero, #primaryR4, #primaryR6, #onestore-quicklinksmodule-s99z4gv-quicklink1, #onestore-quicklinksmodule-s99z4gv-quicklink2, #onestore-quicklinksmodule-s99z4gv-quicklink3").on("mousedown", function () {\n        var image = new Image(1, 1);\n        image.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick";\n    });\n\n    //Adobe DCO\n    var rand = parseInt(Math.random() * 10000000000000);\n    jQuery(".m-hero, #primaryR4, #primaryR6, #onestore-quicklinksmodule-s99z4gv-quicklink1, #onestore-quicklinksmodule-s99z4gv-quicklink2, #onestore-quicklinksmodule-s99z4gv-quicklink3").on("mousedown", function () {\n        var image = new Image(1, 1);\n        image.src = "https://ats.everesttech.net/ats/ats?cmd=ACTION&MerchantID=MICROSOFTSTORE&ActionID=50188&ActionName=Store_Site_Visit&cachebuster=" + rand;\n    });\n\n}\ncatch (err) { satellite.logger.error("Media.ja-jp.store.b.surface-studentdeals"); }\n\n',language:"javascript"}}]},{id:"RLbabdaaa9429a4087b3d39b2cae35a0ff",name:"Media.Verizon.Surface_081620 (RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"(/en-ca|/en-au|/en-gb|/fr-fr|fr-ca)\\/p\\/surface",valueIsRegex:!0},{value:"(/en-ca|/en-au|/en-gb|/fr-fr|fr-ca)\\/d\\/surface",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n  \n//Yahoo\n   //Shop now \njQuery("#PromotionBar a").on("mousedown", function(){\n  var image = new Image(1, 1);\n  image.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick";\n});\n //Get started\njQuery("#purchaseColumn a").on("mousedown", function(){\n  var image = new Image(1, 1);\n  image.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick";\n});\n //Configure now & Sticky\njQuery(\'button[id*="ConfigureDeviceButton"]\').on("mousedown", function(){\n  var image = new Image(1, 1);\n  image.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick";\n});\n  \n}\ncatch(err)\n{\n\t_satellite.logger.error("Media.Verizon.Surface_081620(RT)");\n}\n',language:"javascript"}}]},{id:"RLbce7faddd577453299ebe0a2cad2a168",name:"Media.Verizon.Surface_081620 (AEM/RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"(/en-us)\\/p\\/surface",valueIsRegex:!0},{value:"(/en-us)\\/d\\/surface",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n  \n // Promo Bar\n  \njQuery("a:contains(\'Book your online appointment\')")\n.on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick";\n});\n  \njQuery("a:contains(\'Build your bundle\')")\n.on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick";\n});\n  \njQuery("a:contains(\'Learn more about promise\')")\n.on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick";\n});\n  \njQuery("a[href*=\'/en-us/p/surface\']").filter(\'a:contains("BUSINESS")\')\n.on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick";\n});\n  \n \n //Configure now & Sticky\njQuery("a:contains(\'Configure now\'),button:contains(\'Configure now\')")\n.on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=SurfaceButtonClick";\n});\n  \n}\ncatch(err)\n{\n\t_satellite.logger.error("Media.Verizon.Surface_081620 (AEM/RT)");\n}\n',language:"javascript"}}]},{id:"RLc0091ae7ec8549d2947cec9fe6d70168",name:"Media_/en-us/ TikTok Purchase",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/(en-us|en-gb|fr-fr|de-de)",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n!function (w, d, t) {\n  w.TiktokAnalyticsObject=t;var ttq=w[t]=w[t]||[];ttq.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie"],ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}};for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);ttq.instance=function(t){for(var e=ttq._i[t]||[],n=0;n<ttq.methods.length;n++)ttq.setAndDefer(e,ttq.methods[n]);return e},ttq.load=function(e,n){var i="https://analytics.tiktok.com/i18n/pixel/events.js";ttq._i=ttq._i||{},ttq._i[e]=[],ttq._i[e]._u=i,ttq._t=ttq._t||{},ttq._t[e]=+new Date,ttq._o=ttq._o||{},ttq._o[e]=n||{};var o=document.createElement("script");o.type="text/javascript",o.async=!0,o.src=i+"?sdkid="+e+"&lib="+t;var a=document.getElementsByTagName("script")[0];a.parentNode.insertBefore(o,a)};\n\n//part2\n  ttq.load(\'C5S71GC247CAE4T3VM1G\');\n  ttq.track(\'CompletePayment\');\n}(window, document, \'ttq\');\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("TikTok Purchase");\n}\n\n',language:"javascript"}}]},{id:"RLc26ce7186e9b40ebb1f276401c30be3b",name:"FBLP",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:40}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"www.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n\tvar marketMap = {\n\t\t"AT": "562684790554330",  \n\t\t"AU": "284489665351238", // iProspect\n\t\t"BE": "1441341485948213", // iProspect  (FR) \n\t\t"BR": "1351385668312384", // iProspect\n\t\t"CA": "822106911286239", // iProspect\n\t\t"CH": "1701617263415580",   \n\t\t"CN": "1675926909345981", \n\t\t"DE": "108292966463738",  // iProspect\n\t\t"DK": "254705608267657",  // iProspect\n\t\t"ES": "1626525834066953",  // iProspect\n\t\t"FI": "1719588481615214", \n\t\t"FR": "824192544408978", // iProspect\n\t\t"GB": "120587825211084", // iProspect\n\t\t"HK": "539267979583843", \n\t\t"IE": "249404655562787", // IProspect (added 9/13/17)\n\t\t"IN": "1974106256199230",  // (EN) iProspect\n\t\t"IR": "172987109739933",  \n\t\t"IT": "1598310580201695",  // iProspect\n\t\t"JP": "288860468248601", // iProspect\n\t\t"KR": "1413279412072377", // iProspect\n\t\t"MX": "113583175941450",  // iProspect\n\t\t"NL": "656219287899900", // iProspect\n\t\t"NO": "1675926909345981",  \n\t\t"NZ": "1925863447693257", // iProspect 9/13/17\n\t\t"PH" : "109126313071654", // iProspect  (NEW)\n\t\t"PT" : "1368140109922230",\n\t\t"RU": "514282922073511",  \n\t\t"SE": "1400129366740315", // iProspect\n\t\t"SG": "1240252356085595", // iProspect\n\t\t"TW": "266771177060777",  // iProspect\n\t\t"US": "141890703034968" // iProspect\n\t};\n\n\tvar llfbmap = {\n\t\t"fr-ca": "165913903949482",  \n\t\t"hi-in": "1419329368162069", \n\t\t"nl-be": "129122374248830", \n\t\t"de-ch": "1674321202841213", // iProspect\n\t\t"never": "1111111111111111"\n\t};\n\t\n\tvar baseurl="",imgurlcart="",imgurlpurchase="",imgurllead="",dbugimgurl="";\n\tvar ts = new Date().valueOf();\n\tvar contentIDs="";\n\tvar i=0;\n\tvar pidstringarr=[];\n\tvar pnamearr=[];\n\tvar feedID="";\n\n\ttry {\n\t\tif(_TMDL && marketMap[(_TMDL.geo).toUpperCase()] ){\n\t\t\tfeedID = marketMap[(_TMDL.geo).toUpperCase()].toLowerCase();\n\t\t}\n\t} catch(err) {}\n\n\ttry {\n\t\tif(_TMDL && llfbmap[(_TMDL.ll).toLowerCase()]){\n\t\t\tfeedID = llfbmap[(_TMDL.ll).toLowerCase()].toLowerCase();\n\t\t}\n\t} catch(llerr) {}\n\n\tif (_TMDL.cc=="Unknown" && _TMDL.geo=="US") {_TMDL.cc="USD";}\n\n\tbaseurl = "https://www.facebook.com/tr?id="; \n\n\tpageviewurl = baseurl+"1770559986549030"+"&ev=PageView"+"&dpo=LDU&dpoco=0&dpost=0"+"&ts="+ts;\n\tiniturl = baseurl+"1770559986549030"+"&ev=PixelInitialized"+"&dpo=LDU&dpoco=0&dpost=0"+"&ts="+ts;\n\tpdpurl = baseurl+"1770559986549030"+"&ev=ViewContent"+"&dpo=LDU&dpoco=0&dpost=0"\n\t\t+"&ts="+ts\n        +"&cd[content_ids]=["+encodeURIComponent(_TMDL.pidsku.join(",").toLowerCase()) + "]"\n\t\t+"&cd[content_names]=["+encodeURIComponent(_TMDL.pnames.join(",")) + "]"\n\t\t+"&cd[content_type]=product";\n\n\tif (_TMDL.isprod)\n\t{\n\t\tdbugimgurl = initurl; \n\t\tBootstrapper.imageRequest(initurl);\n\t\tBootstrapper.imageRequest(initurl.replace("1770559986549030"));\t\n\t\tdbugimgurl = pageviewurl;\n\t\tBootstrapper.imageRequest(pageviewurl);\t\n\t\tBootstrapper.imageRequest(pageviewurl.replace("1770559986549030"));\t\n\t\tif (_TMDL.pageType=="detail" || _TMDL.pageType=="pdp") {\n\t\t\tdbugimgurl = pdpurl; \n\t\t\tBootstrapper.imageRequest(pdpurl);\t\n\t\t\tBootstrapper.imageRequest(pdpurl.replace("1770559986549030"));\t\n\t\t} \n\t}\n\n\tfor (i=0; i<_TMDL.pidsku.length;i++){\n\t\tpidstringarr.push(\'"\'+_TMDL.pidsku[i]+\'"\');\n\t\tpnamearr.push(\'"\'+_TMDL.pnames[i]+\'"\');\n\t}\n\n\timgurlcart = baseurl+"1770559986549030"+"&ev=AddToCart"+"&dpo=LDU&dpoco=0&dpost=0"\n\t\t+"&ts="+ts\n\t\t+"&cd[content_ids]=["+encodeURIComponent(pidstringarr.join(",").toLowerCase()) + "]"\n\t\t+"&cd[content_names]=["+encodeURIComponent(pnamearr.join(",")) + "]"\n\t\t+"&cd[content_type]=product";\n\n\timgurlpurchase = baseurl+"1770559986549030"+"&ev=Purchase"+"&dpo=LDU&dpoco=0&dpost=0"\n\t\t+"&ts="+ts\n\t\t+"&cd[currency]="+_TMDL.cc\n\t\t+"&cd[content_ids]=["+encodeURIComponent(pidstringarr.join(",").toLowerCase()) + "]"\n\t\t+"&cd[content_names]=["+encodeURIComponent(pnamearr.join(",")) + "]"\n\t\t+"&cd[content_type]=product";\n\n\t// Digital Games or Xbox Passes\n  \tif (feedID && _TMDL.isprod && (typeof _TMDL.prdType[0] !== \'undefined\') && (typeof _TMDL.pnames[0] !== \'undefined\') && (_TMDL.prdType[0]=="Games" || ( ~_TMDL.prdType[0].indexOf("Pass") && ~_TMDL.pnames[0].indexOf("Xbox")))) {\n\t\t$(document).on(\'mousedown\',\'button[id*="BuyButton"]\',\'\', function() {\n\t\t\tdbugimgurl = imgurlcart;\n\t\t\tBootstrapper.imageRequest(imgurlcart);\n\t\t\tBootstrapper.imageRequest(imgurlcart.replace("1770559986549030"));\t\n\t\t});\n\t\t_TMDL.fbpchurl = imgurlpurchase;\n\t}\n\n\timgurllead = baseurl+"1770559986549030"+"&ev=Lead"+"&dpo=LDU&dpoco=0&dpost=0"\n\t\t+"&ts="+ts\n\t\t+"&cd[content_ids]=["+encodeURIComponent(pidstringarr.join(",").toLowerCase()) + "]"\n\t\t+"&cd[content_names]=["+encodeURIComponent(pnamearr.join(",")) + "]"\n\t\t+"&cd[content_type]=product";\n\t\t\n\tif (feedID && ~window.location.pathname.indexOf("/p/") && typeof _TMDL.prdType[0] !== \'undefined\' && (_TMDL.prdType[0]=="Devices" || _TMDL.prdType[0]=="Passes" || _TMDL.prdType[0]=="Bundles")) {\n\t\t$(document).on(\'mousedown\',\'button[id*="AddToCartButton"],button[id*="buttons_BuildABundleButton"],button[id*="ConfigureDeviceButton"],a[href*="student-discounts?successurl"]\',\'\', function() {\n\t\t\tdbugimgurl = imgurllead;\n\t\t\tBootstrapper.imageRequest(imgurllead);\n\t\t\tBootstrapper.imageRequest(imgurllead.replace("1770559986549030"));\t\n\t\t});\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("FB LP",err.message,dbugimgurl);}\n\t_satellite.logger.error("FB LP");\t\n}',language:"javascript"}}]},{id:"RLc2d5fa61d50b4b45a207ebcf269f2176",name:"CopilotPro/US",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/store/b/copilotpro",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2024-07-31T00:00:00Z",start:"2024-04-09T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n    var trialClick = \'a[href*="LinkID=2243582"]\';\n    attachPixels(trialClick);\n} catch (e) {\n    console.log("Rule has failed");\n}\n\nfunction attachPixels(elementAddress) {\n    $(document).on(\'mousedown\', elementAddress, \'\', function () {\n        var pid = $(this).attr("data-bi-pid");\n        pid = pid === undefined ? "cfq7ttc0mntq" : pid;\n        var pname = $(this).attr("data-bi-ehn");\n        var cta = $(this).attr("data-bi-cn");\n\n        var yahoo = new Image(1, 1);\n        yahoo.src = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&he={INSERT_MACRO_HERE}&hph={INSERT_MACRO_HERE}&ea=BuyCopilotPro";\n\n        var xandr = new Image(1, 1);\n        xandr.src = "https://secure.adnxs.com/px?id=1773571&t=2";\n\n        var linkedIn = new Image(1, 1);\n        linkedIn.src = "https://px.ads.linkedin.com/collect/?pid=7850&fmt=gif";\n\n        var meta = new Image(1, 1);\n        meta.src = "https://www.facebook.com/tr?id=1770559986549030&ev=PageView&noscript=1";\n\n        var floodlight = new Image(1, 1);\n        floodlight.src = "https://ad.doubleclick.net/ddm/activity/src=8406157;type=stoth;cat=copilot;u1=" + _TMDL.geo + ";u2=" + _TMDL.ll +";u6=" + _TMDL.pageName +";u25=" + pid +";u26=" + pname +";u50=" + cta +";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;gdpr=${GDPR};gdpr_consent=${GDPR_CONSENT_755};ord=1?";\n    });\n}',language:"javascript"}}]},{id:"RLca931e3a8bdd4e39806aa727a11e9f40",name:"SundaySkyCart",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=cart")&&(-1!==window.location.search.indexOf("market=US")||-1!==window.location.search.indexOf("market=CA"))}}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2024-08-01T00:00:00Z",start:"2023-03-20T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'// SundaySkyCart\ntry {\n    var rand1 = parseInt(Math.random() * 10000000000000);\n    var rand2 = parseInt(Math.random() * 10000000000000);\n    var rand3 = parseInt(Math.random() * 10000000000000);\n    var rand4 = parseInt(Math.random() * 10000000000000);\n    \n    var image = new Image(1, 1);\n    image.src = "https://s-vop.sundaysky.com/t/v1/img?a=microsoft&ap=1&pb=f&sp=https://www.microsoft.com/" + _TMDL.ll + "/store/cart&cb=" + rand1 +"&m=cart&udt[segment]=[visitor,cart]&udt[userid]=[USER_ID]&udt[sku]=" + _TMDL.pids.map(x => x.toUpperCase()) + "&udt[cat]=" + _TMDL.pnames + "&udt[bu]=[surface]&udt[country]="+ _TMDL.geo + "&udt[language]=" + _TMDL.ll.substring(0,2);\n\n    var image2 = new Image(1, 1);\n    image2.src = "https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=" + rand2 +"&s=1";\n\n    var image3 = new Image(1, 1);\n    image3.src = "https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=" + rand3 +"&s=2";\n\n    var image4 = new Image(1, 1);\n    image4.src = "https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=" + rand4 +"&s=3";\n} catch {\n    console.log("Sunday Sky Cart");\n}',language:"javascript"}}]},{id:"RLce0fa31d96d6437587d129d15e835b8a",name:"CandyCrush/Bing",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/p/candy-crush-saga",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2024-07-31T00:00:00Z",start:"2023-11-01T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n    (function (w, d, t, r, u) { var f, n, i; w[u] = w[u] || [], f = function () { var o = { ti: "355025700", enableAutoSpaTracking: true }; o.q = w[u], w[u] = new UET(o), w[u].push("pageLoad") }, n = d.createElement(t), n.src = r, n.async = 1, n.onload = n.onreadystatechange = function () { var s = this.readyState; s && s !== "loaded" && s !== "complete" || (f(), n.onload = n.onreadystatechange = null) }, i = d.getElementsByTagName(t)[0], i.parentNode.insertBefore(n, i) })(window, document, "script", "//bat.bing.com/bat.js", "uetq_Candy");\n    \n    var getButton = \'button[id*="buttonPanel_AppIdentityBuyButton"]\';\n    var installButton = \'button[id*="PlayBar_AppIdentityOpenButton"]\';\n\n    attachPixels(getButton);\n    attachPixels(installButton);\n} catch (e) {\n    console.log("Candy Crush-Bing has failed");\n}\n\nfunction attachPixels(elementAddress) {\n    $(document).on(\'mousedown\', elementAddress, \'\', function () {\n        window.uetq_Candy = window.uetq_Candy || []; \n        window.uetq_Candy.push(\'event\', \'click\', {});\n    });\n}\n',language:"javascript"}}]},{id:"RLd2efe62bee8d45ecbf62d39c15613ec0",name:"Media_/de-de/store/b/sale",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/de-de/store/b/sale"},{value:"/de-de/store/b/sale/"}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n  \n// ADNXS\n \n //Surface Starter Packages Product Tiles\njQuery("section.m-product-placement-item:lt(4)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n});\n //Further Information  \njQuery("a.c-call-to-action.c-glyph:eq(11)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n});\n  \n\n\n//DoubleClick\n \n  //Surface Starter Packages Product Tiles\njQuery("section.m-product-placement-item:lt(4)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Shop Now"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n  \n  //Further Information  \njQuery("a.c-call-to-action.c-glyph:eq(11)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Product Options"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n  \n  \n//Yahoo\n \n  //Surface Starter Packages Product Tiles\njQuery("section.m-product-placement-item:lt(4)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick");\n});\n  \n  //Further Information \njQuery("a.c-call-to-action.c-glyph:eq(11)").on("mousedown", function(){\n    Bootstrapper.imageRequest("https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=SurfaceButtonClick");\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("Media_/de-de/store/b/sale");\n}\n  ',language:"javascript"}}]},{id:"RLd73c3b4bf4e447aa9825807eb823eca1",name:"Media_/LL-LL/d/surface Twitter (RT)",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/d/surface",valueIsRegex:!0},{value:"/d/surface/",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/d/surface",valueIsRegex:!0},{value:"/en-us/d/surface/",valueIsRegex:!0}]},negate:!0}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n  \n  //Page Load\n  var image = new Image(1,1);\n  image.src = "https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n  var image2 = new Image(1,1);\n  image2.src="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n\n  \n   //Configure Now button\njQuery("button.c-button.f-primary:eq(0)").on("mousedown", function(){\nvar image = new Image(1,1);\n  image.src = "https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9u&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\nvar image2 = new Image(1,1);  \n  image2.src="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n});\n  \n   //Surface Laptop Go for Business Button\njQuery("a.c-hyperlink:eq(2)").on("mousedown", function(){\nvar image = new Image(1,1);\n  image.src = "https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\nvar image2 = new Image(1,1);\n  image2.src="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=o4co9&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("Media_/LL-LL/d/surface Twitter (RT)");\n}',language:"javascript"}}]},{id:"RLd9f12b194a604a99a9dc5999d499c6f3",name:"Surface-US/Amazon",events:[{
modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2024-07-31T00:00:00Z",start:"2023-01-01T00:00:00Z"}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"us.*surface",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/sessions.js",settings:{count:1,operator:"="}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"// US-Amazon\nvar webClick = '[href*=\"https\"]';\nvar phoneClick = '[href*=\"tel\"]';\nvar digClick = '[href*=\"#dig_\"]';\nvar secondConfig = 'button[data-action*=\"Configure\"]';\nvar cardClick = 'div[class*=\"slide-item\"]';\nvar cardClick2 = 'div[class*=\"material-card\"]';\nvar hasClicked = false;\n\nfunction attachPixels(elementAddress) {\n    $(document).on('mousedown', elementAddress, '', function () {\n        if (!hasClicked) {\n            var image = new Image(1, 1);\n            image.src = 'https://s.amazon-adsystem.com/iu3?pid=8115fd00-1fc2-4248-9443-b679afb76f92&event=PageView';\n            hasClicked = true;\n        }\n    });\n}\n\ntry {\n    attachPixels(webClick);\n    attachPixels(phoneClick);\n    attachPixels(digClick);\n    attachPixels(secondConfig);\n    attachPixels(cardClick);\n    attachPixels(cardClick2);\n}\ncatch (err) {\n    _satellite.logger.error(\"US-Amazon-Pixel\");\n}",language:"javascript"}}]},{id:"RLdbc68a5be23544c7a1845148fdd85757",name:"Dstillery Purchase",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2024-07-31T00:00:00Z",start:"2023-10-01T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n    var pageLoad = new Image(1, 1);\n    pageLoad.src = "//action.dstillery.com/orbserv/nspix?adv=cl1025915&ns=3495&nc=Checkoutpageviews&ncv=47&dstOrderId=" + _TMDL.purchaseID + "&dstOrderAmount=" + _TMDL.totamount;\n}\ncatch (err) {\n    console.log("Dstillery Purchase failed");\n}\n',language:"javascript"}}]},{id:"RLdc101373a5e7415e876f8ac4e95a3db7",name:"ContentSquare - Confirmation Page",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"try {\nfunction loadjsfile(filename){\n    if (!filename) {\n        return;\n    }\n    var fileref=document.createElement('script')\n    fileref.setAttribute(\"type\",\"text/javascript\")\n    fileref.setAttribute(\"src\", filename)\n   if (typeof fileref!=\"undefined\")\n    document.getElementsByTagName(\"head\")[0].appendChild(fileref)\n}\nfunction getGeoMarketLink() {\n    var geoMarket = /&market=([a-z]{2})&/im.exec(window.location.search) && /&market=([a-z]{2})&/im.exec(window.location.search)[1]; //Extract market location from the query param\n    var CSGeoGUID; //define placeholder for market specific GUID\n    switch (geoMarket) { //Assign GUID to its respective market\n    case 'US':\n    \xa0\xa0  CSGeoGUID = '05d32363-d534-4d93-9b65-cde674775e71';\n    \xa0\xa0  break;\n    case 'CA':\n    \xa0\xa0\xa0 CSGeoGUID = '63ed781a-0b4b-47a5-bbec-c555ac4835f3';\n    \xa0\xa0\xa0 break;\n    case 'BR':\n    \xa0\xa0\xa0 CSGeoGUID = 'e5577ace-d4c5-461f-b2a3-97eea3f39911';\n    \xa0\xa0\xa0 break;\n    case 'AU':\n    \xa0\xa0\xa0 CSGeoGUID = 'b8569749-38c8-434f-a4e5-457de94c4196';\n    \xa0\xa0\xa0 break;\n    case 'JP':\n    \xa0\xa0\xa0 CSGeoGUID = '82cbb6ea-e5bd-42bc-a3ed-9ab7ce1b5163';\n    \xa0\xa0\xa0 break;\n    case 'GB':\n    \xa0\xa0\xa0 CSGeoGUID = '554c90f5-1a44-4097-9def-c02c0e5a3718';\n    \xa0\xa0\xa0 break;\n    case 'FR':\n    \xa0\xa0\xa0 CSGeoGUID = 'a08fefef-0f4f-4c7d-8f54-2abbf4ab7d61';\n    \xa0\xa0\xa0 break;\n    case 'DE':\n    \xa0\xa0\xa0 CSGeoGUID = '77a061a5-1c09-4b9a-bf5f-1b5b67bba94c';\n    \xa0\xa0\xa0 break;\n    case 'IT':\n    \xa0\xa0\xa0 CSGeoGUID = '67b0cfc3-fb2e-44cb-b361-72a4c939e3dc';\n    \xa0\xa0\xa0 break;\n    case 'NL':\n    \xa0\xa0\xa0 CSGeoGUID = 'a1967146-1da8-459a-a731-7aed4cca30fb';\n    \xa0\xa0\xa0 break;\n    case 'NZ':\n    \xa0\xa0\xa0 CSGeoGUID = 'c4b2b846-8b73-415f-abbe-016f561ebfec';\n    \xa0\xa0\xa0 break;\n    case 'SG':\n    \xa0\xa0\xa0 CSGeoGUID = '53de0804-eb07-467b-bda1-1d5b5116d441';\n    \xa0\xa0\xa0 break;\n    case 'ES':\n    \xa0\xa0\xa0 CSGeoGUID = '1fac8122-e96d-4248-891b-bcfeadb26d0d';\n    \xa0\xa0\xa0 break;\n    default:\n    \xa0\xa0\xa0 break;\n    }\n    var CSLink = CSGeoGUID && 'https://cdnssl.clicktale.net/www32/ptc/' + CSGeoGUID + '.js';\n    return CSLink;\n}\nloadjsfile(getGeoMarketLink());\n  } \ncatch (err) { satellite.logger.error(\"ContentSquare - Confirmation Page\");}",language:"javascript"}}]},{id:"RLde28aecd30d74703bdf3a1ed721c0109",name:"Media.LL-LL.store.b.student",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-gb/store/b/student"},{value:"/en-gb/store/b/student/"},{value:"/fr-fr/store/b/student"},{value:"/fr-fr/store/b/student/"},{value:"/de-de/store/b/student"},{value:"/de-de/store/b/student/"}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n  {\n    \n //ADNXS\n    \n //Hero\njQuery(".m-hero").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n    });\n \n//QuickLinks\njQuery(".m-updated-quicklinks li:lt(2)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n    });\n\n    \n //"Shop Surface" - Only capturing first \'card\' (anchor + img). Remainder of isn\'t identified in spec.   \njQuery("#primaryR5 img:eq(0)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n    });\n \njQuery("#primaryR5 a:eq(0)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n    });\n    \n//Surface Bundles\njQuery("#primaryR7 a:gt(1)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src = "//secure.adnxs.com/px?id=1268102&t=2";\n    });\n    \n\n //DoubleClick\n    \njQuery(".m-hero").on("mousedown", function(){\nBootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=lrn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Learn More"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n\njQuery(".m-updated-quicklinks li:lt(2)").on("mousedown", function(){\nBootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Surface for Students Surface Accessories"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n\njQuery("#primaryR5").on("mousedown", function(){ Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Shop Surface"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n\njQuery("#primaryR7 a:gt(1)").on("mousedown", function(){ Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=Shop Surface"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1?");\n});\n \n    \n  }\ncatch(err)\n  {\n\t_satellite.logger.error("Media.LL-LL.store.b.student");\n  }',language:"javascript"}}]},{id:"RLde75a20693bd4fb18a1f30e9505db8c0",name:"Media_/en-us/ TikTok Clicks",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-us/d/",valueIsRegex:!0},{value:"/en-us/p/",valueIsRegex:!0},{value:"/en-us/store/configure/Surface",valueIsRegex:!0},{value:"/en-gb/d/",valueIsRegex:!0},{value:"/fr-fr/d/",valueIsRegex:!0},{value:"/de-de/d/",valueIsRegex:!0},{value:"/en-gb/p/",valueIsRegex:!0},{value:"/fr-fr/p/",valueIsRegex:!0},{value:"/de-de/p/",valueIsRegex:!0},{value:"/en-gb/store/configure/Surface",valueIsRegex:!0},{value:"/fr-fr/store/configure/Surface",valueIsRegex:!0},{value:"/de-de/store/configure/Surface",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"try {\n//PlaceAnOrder\njQuery(\"button:contains('Buy')\").on(\"mousedown\", function(){\n    var ttp = {};\n    ttp.content_id = _TMDL.pids[0];\n    ttp.content_name = _TMDL.pnames;\n    ttp.quantity =_TMDL.totqty[0];\n    ttp.price = _TMDL.itemprices[0];\n      ttq.track('PlaceAnOrder', ttp);\n  });\n        \n//AddToCart\njQuery(\"button:contains('Add to cart')\").on(\"mousedown\", function(){\n    var ttp = {};\n    ttp.content_id = _TMDL.pids[0];\n    ttp.content_name = _TMDL.pnames;\n    ttp.content_type = _TMDL.prdType;\n    ttp.quantity =_TMDL.totqty[0];\n    ttp.price = _TMDL.itemprices[0];\n      ttq.track('AddToCart', ttp);\n  });\n  \n//ClickButton\njQuery(\"button:contains('Rent'), button:contains('Get'), button:contains('Free'), button:contains('Configure now')\").on(\"mousedown\", function(){\n    var ttp = {};\n    ttp.content_id = _TMDL.pids[0];\n    ttp.content_name = _TMDL.pnames;\n    ttp.quantity =_TMDL.totqty[0];\n    ttp.price = _TMDL.itemprices[0];\n      ttq.track('ClickButton', ttp);  \n  });                                                                  \n}\ncatch(err)\n{\n\t_satellite.logger.error(\"Media_/en-us/ TikTok Clicks\");\n}",language:"javascript"}}]},{id:"RLe040c5eabaf4405db3051b8b14c37a12",name:"GBLCV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/* GBL CV\n\nAmnet Oath\nAOL\nBidTellect\nHCode\nMediaIQ\nMediaMath\ntaboola_url\nQuantcast \n\n*/\n\ntry\n{\n\tvar \n\thcode_u="",\n\tmediaIQ_imgurl="",\n\tmediamath_url="",\n\tamnetOath="",\n\ttaboola_url="",\n\toathdot="",\n\tquantcast="",\n\tdbugimgurl=""\n\t;\n\n\tif (_TMDL.isprod && _TMDL.pT=="rP")\n\t{\n\n\t\tdbugimgurl="BidTellect";\n\t\tBootstrapper.imageRequest("https://bttrack.com/pixel/uconversion/2682");\n\n\t\t// --------------------------------------------------------------------------------\n\t\t// HCode, from Carat <NAME REMOVED>, potentially decommissionable end of Q3FY19\n\t\t// --------------------------------------------------------------------------------\n\n\t\thcode_u="https://api.retargetly.com/track?t=eBWRHK&r_type=consumer"\n\t\t+"&r_market="+_TMDL.geo\n\t\t+"&r_product="+encodeURIComponent(_TMDL.pnames.join("_"))\n\t\t+"&r_currency="+_TMDL.cc\n\t\t+"&r_SKU="+_TMDL.pidsku.join("_")\n\t\t+"&r_irderid="+_TMDL.purchaseID\n\t\t+"&r_units="+_TMDL.quantities.join("_")\n\t\t+"&r-seats="+_TMDL.sales.join("_")\n\t\t+"&r_quanity="+_TMDL.quantities.join("_");\n\t\t\n\t\tdbugimgurl=hcode_u;\n\t\tBootstrapper.imageRequest(hcode_u);\n\n\t\t/*\n\t\tMedia IQ Appnexus \n\t\t*/\n\n\t\tmediaIQ_imgurl = "https://secure.adnxs.com/px?id=929469&seg=10765629&redir=https%3A%2F%2Fsecure.adnxs.com%2Fgetuid%3Fhttps%3A%2F%2Fpixel.mediaiqdigital.com%2Fpixel%3Fu1%3DConsPurchase%26u2%3D"\n\t\t+_TMDL.ll\n\t\t+"%26u3%3D"+_TMDL.ll.split("-")[1]\n\t\t+"%26u6%3D"+"thankyoupage"\n\t\t+"%26u20%3D"+_TMDL.pidsku.join("_")\n\t\t+"%26u26%3D"+encodeURIComponent(_TMDL.pnames.join("_"))\n\t\t+"%26u31%3D"+_TMDL.cc\n\t\t+"%26u34%3D"+_TMDL.purchaseID\n\t\t+"%26u35%3D"+_TMDL.totqty\n\t\t+"%26u39%3D"+_TMDL.sales.join("_")\n\t\t+"%26u40%3D"+_TMDL.quantities.join("_")\n\t\t+"%26pixel_id%3D929469%26uid%3D%24UID&t=2";\n\n\t\tdbugimgurl=mediaIQ_imgurl;\n\t\tBootstrapper.imageRequest(mediaIQ_imgurl);\n\n\t\t//-----------\n\t\t// MediaMath\n\t\t//-----------\n\n\n\t\tmediamath_url="https://pixel.mathtag.com/event/img?mt_id=1259909&mt_adid=166372"\n\t\t\t+"&site_language="+_TMDL.ll\n\t\t\t+"&page_name=thankyou"\n\t\t\t+"&product_name="+encodeURIComponent(_TMDL.pnames.join("_"))\n\t\t\t+"&currency_code="+_TMDL.cc\n\t\t\t+"&total_units="+_TMDL.totqty\n\t\t\t+"&s2="+_TMDL.ll\n\t\t\t+"&s3="+_TMDL.geo\n\t\t\t+"&s6=thankyou"\n\t\t\t+"&s20="+_TMDL.pidsku.join("_")\n\t\t\t+"&s26="+encodeURIComponent(_TMDL.pnames.join("_"))\n\t\t\t+"&s31="+_TMDL.cc\n\t\t\t+"&s34="+_TMDL.purchaseID\n\t\t\t+"&s35="+_TMDL.totqty\n\t\t\t+"&s39="+_TMDL.sales.join("_")\n\t\t\t+"&s40="+_TMDL.quantities.join("_")\n\t\t\t+"&v1=ConsPurchase&v5="+_TMDL.pidsku.join("_")+"&v11="+_TMDL.geo\n\t\t\t;\n\n\t\tdbugimgurl=mediamath_url;\n\t\tBootstrapper.imageRequest(mediamath_url);\n\t\n\t\t//---------------------\t\n\t\t// Oath Dot \n\t\t//---------------------\t\n\n\t\toathdot = "https://sp.analytics.yahoo.com/spp.pl?a=10000&.yp=413318&ea=ConsPurchase&qua="+_TMDL.totqty+"&off="+_TMDL.pidsku.join("|");\n\t\tdbugimgurl=oathdot;\n\t\tBootstrapper.imageRequest(oathdot);\n\n\t\t//-----------------------------------\n\t\t// Quantcast\n\t\t//    similar tags on other pages\n\t\t//-----------------------------------\n\n\t\tquantcast = "https://pixel.quantserve.com/pixel/p-tTB93UFC5vepM.gif?labels=_fp.channel."+_TMDL.geo+",_fp.event.receipt,_fp.subchannel."+_TMDL.totqty+",_fp.customer."+_TMDL.ll+",_fp.pcat."+_TMDL.pidsku.join(",")+"&orderid="+_TMDL.purchaseID+"&revenue="+_TMDL.totamount;\n\t\t\n\t\tdbugimgurl=quantcast;\n\t\tBootstrapper.imageRequest(quantcast);\n\n\t\t//------------------------------------------\t\n\t\t// Taboola for Office Direct\n\t\t//------------------------------------------\t\n\n\t\ttaboola_url="//trc.taboola.com/globalpixelhome/log/3/action?name=microsoft_global&item-url="+_TMDL.pidsku.join("_");\n\t\tdbugimgurl=taboola_url;\n\t\tBootstrapper.imageRequest(taboola_url);\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("GBLCV",err.message,dbugimgurl);}\n\t_satellite.logger.error("GBLCV");\t\n}',language:"javascript"}}]},{id:"RLe0cc225913f545938bfe93d2d92dd419",name:"SundaySkySurface",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/(en-us|en-ca|fr-ca)/.*surface",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2024-08-01T00:00:00Z",start:"2023-03-20T00:00:00Z"}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{global:!1,source:'var firstConfig = \'a[href*="/store/configure"]\';\nvar secondConfig = \'button[data-action*="Configure"]\';\n\nfunction attachPixels(elementAddress) {\n    $(document).on(\'mousedown\', elementAddress, \'\', function () {\n        const rand5 = parseInt(Math.random() * 10000000000000);\n        const rand6 = parseInt(Math.random() * 10000000000000);\n        const rand7 = parseInt(Math.random() * 10000000000000);\n        const rand8 = parseInt(Math.random() * 10000000000000);\n\n        var image = new Image(1, 1);\n        image.src = "https://s-vop.sundaysky.com/t/v1/img?a=microsoft&ap=1&pb=f&sp=" + _TMDL.host + _TMDL.path + "&cb=" + rand5 + "&m=atc&udt[segment]=[visitor,atc]&udt[userid]=[USER_ID]&udt[sku]=" + _TMDL.pids.map(x => x.toUpperCase()) + "&udt[cat]=" + _TMDL.pnames + "&udt[ptype]=" + _TMDL.pageType + "&udt[bu]=[surface]&udt[country]=" + _TMDL.geo + "&udt[language]=" + _TMDL.lang;\n\n        var image2 = new Image(1, 1);\n        image2.src = "https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=" + rand6 + "&s=1";\n\n        var image3 = new Image(1, 1);\n        image3.src = "https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=" + rand7 + "&s=2";\n\n        var image4 = new Image(1, 1);\n        image4.src = "https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=" + rand8 + "&s=3";\n    });\n}\n\ntry {\n    const rand1 = parseInt(Math.random() * 10000000000000);\n    const rand2 = parseInt(Math.random() * 10000000000000);\n    const rand3 = parseInt(Math.random() * 10000000000000);\n    const rand4 = parseInt(Math.random() * 10000000000000);\n    const pids = _TMDL.path.includes("configure") ? [].concat(_TMDL.pageName.toUpperCase()) : _TMDL.pids.map(x => x.toUpperCase());\n\n    var pageLoad = new Image(1, 1);\n    pageLoad.src = "https://s-vop.sundaysky.com/t/v1/img?a=microsoft&ap=1&pb=f&sp=" + _TMDL.host + _TMDL.path + "&cb=" + rand1 + "&m=uui&udt[segment]=[visitor]&udt[userid]=[USER_ID]&udt[sku]=" + pids + "&udt[cat]=" + _TMDL.pnames + "&udt[bu]=[surface]&udt[country]=" + _TMDL.geo + "&udt[language]=" + _TMDL.lang;\n\n    var image2 = new Image(1, 1);\n    image2.src = "https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=" + rand2 + "&s=1";\n\n    var image3 = new Image(1, 1);\n    image3.src = "https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=" + rand3 + "&s=2";\n\n    var image4 = new Image(1, 1);\n    image4.src = "https://s-vop.sundaysky.com/t/v1/img?a=microsoft&cb=" + rand4 + "&s=3";\n\n    attachPixels(firstConfig);\n    attachPixels(secondConfig);\n    \n}\ncatch (err) {\n    console.log("Sunday Sky Category/PDP/Config");\n}',language:"javascript"}}]},{id:"RLe32dfc4ecd3c4eb3a3d788c34106b57c",name:"US-TikTok-Surface-Purchase",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/dateRange.js",settings:{end:"2024-01-31T00:00:00Z",start:"2023-10-09T00:00:00Z"}},{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")&&-1!==window.location.search.indexOf("market=US")&&-1!==window.location.search.indexOf("Surface")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n    var\ta = "" + (Math.random() * 10000000000000);\n    var pageLoad = new Image(1, 1);\n    pageLoad.src = "https://analytics.tiktok.com/api/v2/pixel_event_track?pixel_code=IDCKEOVFBC77U6580FHDM0&event=CompletePayment&event_id=" + a;\n}\ncatch (err) {\n    _satellite.logger.error("TikTok Purchase failed");\n}',language:"javascript"}}]},{id:"RLe377a68ea5f544699a1d32b4a92b2986",name:"Media_/en-au/store/b/surfaceforbusiness Tax Day",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-au/store/b/surfaceforbusiness",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'\ntry\n{\n\njQuery("div.m-content-placement:Lt(1)").on("mousedown", function(){  \nvar image = new Image(1, 1);\nimage.src ="https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u50=CTA;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;npa=;ord=1?";\n\n});\n\n}\ncatch(err)\n{\n\t_satellite.logger.error("Media_/en-au/store/b/surfaceforbusiness Tax Day");\n}\n\n',language:"javascript"}}]},{id:"RLe52da1fab16d428ea026e1de5275cfe7",name:"US/DE/JP Comscore Surface",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/(de-de|en-us|ja-jp)/d/surface-pro-9/",valueIsRegex:!0},{value:"/(de-de|en-us|ja-jp)/d/surface-laptop-5/",valueIsRegex:!0},{value:"/(de-de|en-us|ja-jp)/store/configure/surface-pro-9/93vkd8np4fvk",valueIsRegex:!0},{value:"/(de-de|en-us|ja-jp)/store/configure/surface-laptop-5/8xn49v61s1bn",valueIsRegex:!0},{value:"/en-us/microsoft-365/buy/compare-all-microsoft-365-products",valueIsRegex:!0},{value:"/en-us/d/surface-pro-9-for-business/8xjc219dg79z",valueIsRegex:!0},{value:"/en-us/d/surface-pro-8-for-business/8x957cqqp1t4",valueIsRegex:!0},{value:"/en-us/d/surface-go-4-for-business/8qczkbwf3t77",valueIsRegex:!0},{value:"/en-us/d/surface-go-3-for-business/8msjbnl8hbxw",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-5-for-business/8wx8rsm6l09n",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-4-for-business/929894rg3gd7",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-studio-2-for-business/935xfv68l29f",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-studio-for-business/8wvj5p8dd2th",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-go-3-for-business/90qlzjm26q6s",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-go-2-for-business/8vw8gdhtn92d",valueIsRegex:!0},{value:"/en-us/d/surface-pro-9-for-business-essentials-bundle/8nd51zvkkxwz",valueIsRegex:!0},{value:"/en-us/d/surface-pro-8-for-business-essentials-bundle/8wxf074l71zp",valueIsRegex:!0},{value:"/en-us/d/surface-go-4-for-business-essentials-bundle/90q5n4b7xwvh",valueIsRegex:!0},{value:"/en-us/d/surface-go-3-for-business-essentials-bundle/92lclmzs07cm",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-5-for-business-essentials-bundle/8nczs6n6k6k2",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-4-for-business-essentials-bundle/90mrqz4cb2mp",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-studio-2-for-business-essentials-bundle/8n9bx99ffgz7",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-studio-for-business-essentials-bundle/8v7qcgx7j27q",valueIsRegex:!0},{value:"/en-us/d/xbox-series-s-gilded-hunter-bundle/92hndf5m5291",valueIsRegex:!0},{value:"/en-us/d/Surface-Laptop-Go-2-for-Business-Essentials-Bundle/94j25vhqh58r",valueIsRegex:!0},{value:"/en-us/d/surface-pro-9-essentials-bundle/944qkwh6r8ds",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-5-essentials-bundle/8rnkq7msksmf",valueIsRegex:!0},{value:"/en-us/d/surface-go-3-essentials-bundle/8p5dqh206jw0",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-4-essentials-bundle/8q410j30qwvb",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-studio-2-essentials-bundle/8s2f4n61zn15",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-go-3-essentials-bundle/90mfgpb9pxgf",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-go-2-essentials-bundle/8rpj1ck09v7t",valueIsRegex:!0},{value:"/en-us/d/surface-pro-9-and-pro-keyboard-bundle/93x926bp90dx",valueIsRegex:!0},{value:"/en-us/d/surface-go-3/904h27d0cbwn",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-4/946627fb12t1",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-studio-2/8rqr54krf1dz",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-go-3/8p0wwgj6c6l2",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-go-2/8pglpv76mjhn",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Pro-9-for-Business/8xjc219dg79z",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Pro-8-for-Business/8x957cqqp1t4",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Go-4-for-Business/8qczkbwf3t77",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Go-3-for-Business/8msjbnl8hbxw",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Laptop-5-for-Business/8wx8rsm6l09n",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Laptop-4-for-Business/929894rg3gd7",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Laptop-Studio-2-for-Business/935xfv68l29f",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Laptop-Studio-for-Business/8wvj5p8dd2th",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Laptop-Go-3-for-Business/90qlzjm26q6s",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Laptop-Go-2-for-Business/8vw8gdhtn92d",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Pro-9-for-Business-Essentials-Bundle/8nd51zvkkxwz",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Pro-8-for-Business-Essentials-Bundle/8wxf074l71zp",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Go-4-for-Business-Essentials-Bundle/90q5n4b7xwvh",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Go-3-for-Business-Essentials-Bundle/92lclmzs07cm",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Laptop-5-for-Business-Essentials-Bundle/8nczs6n6k6k2",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Laptop-4-for-Business-Essentials-Bundle/90mrqz4cb2mp",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Laptop-Studio-2-for-Business-Essentials-Bundle/8n9bx99ffgz7",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Laptop-Studio-for-Business-Essentials-Bundle/8v7qcgx7j27q",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Laptop-Go-3-for-Business-Essentials-Bundle/92hndf5m5291",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Laptop-Go-2-for-Business-Essentials-Bundle/94j25vhqh58r",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Pro-9-Essentials-Bundle/944qkwh6r8ds",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Laptop-5-Essentials-Bundle/8rnkq7msksmf",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Go-3-Essentials-Bundle/8p5dqh206jw0",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Laptop-4-Essentials-Bundle/8q410j30qwvb",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Laptop-Studio-2-Essentials-Bundle/8s2f4n61zn15",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Laptop-Go-3-Essentials-Bundle/90mfgpb9pxgf",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Laptop-Go-2-Essentials-Bundle/8rpj1ck09v7t",valueIsRegex:!0},{value:"/en-us/store/build/Surface-Pro-9-and-Pro-Keyboard-Bundle/93x926bp90dx",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Go-3/904h27d0cbwn",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Laptop-4/946627fb12t1",valueIsRegex:!0},{value:"/en-us/store/configure/surface-laptop-studio-2/8rqr54krf1dz",valueIsRegex:!0},{value:"/en-us/store/configure/surface-laptop-go-3/8p0wwgj6c6l2",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Laptop-Go-2/8pglpv76mjhn",valueIsRegex:!0},{value:"/en-us/store/b/copilotpro",valueIsRegex:!0},{value:"/en-us/d/surface-pro-10-for-business/8v73d6qwrss1",valueIsRegex:!0},{value:"/en-us/store/configure/Surface-Pro-10-for-Business/8v73d6qwrss1",valueIsRegex:!0},{value:"/en-us/d/surface-laptop-6-for-business/8pz3fvs57qcv",valueIsRegex:!0},{value:"/en-us/store/configure/surface-laptop-6-for-business/8pz3fvs57qcv",valueIsRegex:!0},{value:"/en-us/.*/(9012t0lxhjnf|9012T0LXHJNF)",valueIsRegex:!0},{value:"/en-us/.*/(92vpfztck8h9|92VPFZTCK8H9)",valueIsRegex:!0},{value:"/en-us/.*/(94BF9JDFDDQP|94bf9jdfddqp)",valueIsRegex:!0},{value:"/en-us/.*/(8sgwwqqlp3df|8SGWWQQLP3DF)",valueIsRegex:!0},{value:"/en-us/.*/(8n9t09p96cmj|8N9T09P96CMJ)",valueIsRegex:!0},{value:"/en-us/.*/(8tq2hq5xxkj9|8TQ2HQ5XXKJ9)",valueIsRegex:!0},{value:"/en-us/.*/(8tkcbz02bdvk|8TKCBZ02BDVK)",valueIsRegex:!0},{value:"/en-us/.*/(8nl1w61jw8zm|8NL1W61JW8ZM)",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:"<script src=https://www.microsoft.com/library/svy/store/broker.js></script>",language:"html"}}]},{id:"RLef0315aa87014acb9bc9a60708599d11",name:"VRZNLPXbox",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}},{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"^/en-us/p/xbox.*",valueIsRegex:!0},{value:"^/de-de/p/xbox.*",valueIsRegex:!0},{value:"^/fr-fr/p/xbox.*",valueIsRegex:!0},{value:"^/en-gb/p/xbox.*",valueIsRegex:!0},{value:"^/en-au/p/xbox.*",valueIsRegex:!0},{value:"^/jp-jp/p/xbox.*",valueIsRegex:!0},{value:"^/en-ca/p/xbox.*",valueIsRegex:!0},{value:"^/fr-ca/p/xbox.*",valueIsRegex:!0},{value:"^/en-us/d/xbox.*",valueIsRegex:!0},{value:"^/de-de/d/xbox.*",valueIsRegex:!0},{value:"^/fr-fr/d/xbox.*",valueIsRegex:!0},{value:"^/en-gb/d/xbox.*",valueIsRegex:!0},{value:"^/en-au/d/xbox.*",valueIsRegex:!0},{value:"^/jp-jp/d/xbox.*",valueIsRegex:!0},{value:"^/en-ca/d/xbox.*",valueIsRegex:!0},{value:"^/fr-ca/d/xbox.*",valueIsRegex:!0}]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try {\n  var image = new Image(1,1);\n  image.src = "//sp.analytics.yahoo.com/spp.pl?a=10000&.yp=10084084&ea=ViewProduct&product_id=" + _pageBITags.pageContracts.ProductInfo.id + "-" + _pageBITags.pageContracts.ProductInfo.sku;\n}\ncatch(err)\n{\n\t_satellite.logger.error("Verizon_LP");\n}',language:"javascript"}}]},{id:"RLf09c4e2b3a1a48e2aff0ef3e101b1029",name:"Media_/en-gb/p/surface-pro-7 Twitter",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:50}],conditions:[{modulePath:"core/src/lib/conditions/path.js",settings:{paths:[{value:"/en-gb/p/surface-pro-7",valueIsRegex:!0},{value:"/en-gb/d/surface-pro-7",valueIsRegex:!0}]}},{modulePath:"core/src/lib/conditions/domain.js",settings:{domains:["microsoft.com"]}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n//Page View  \nvar image = new Image(1, 1);\nimage.src ="https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=nzzcs&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n  \nvar image2 = new Image(1, 1);\nimage2.src ="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=nzzcs&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";  \n\n }\ncatch(err)\n{\n\t_satellite.logger.error("Media_/en-gb/p/surface-pro-7 Twitter");\n}\n',language:"javascript"}},{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n  \n//Clicks\n jQuery("a.c-button:Lt(1),a.c-hyperlink:Lt(2)").on("mousedown", function(){\nvar image = new Image(1, 1);\nimage.src ="https://analytics.twitter.com/i/adsct?p_id=Twitter&p_user_id=0&txn_id=nzzcs&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";\n  \nvar image2 = new Image(1, 1);\nimage2.src ="//t.co/i/adsct?p_id=Twitter&p_user_id=0&txn_id=nzzcs&events=%5B%5B%22pageview%22%2Cnull%5D%5D&tw_sale_amount=0&tw_order_quantity=0&type=image&version=1.1.0";   \n });\n\n\n }\ncatch(err)\n{\n\t_satellite.logger.error("Media_/en-gb/p/surface-pro-7 Twitter");\n}\n',language:"javascript"}}]},{id:"RLf59cc3afd51d44a0ab67112e57bf6e7c",name:"BINGLPCVF",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:70}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"www.microsoft.com"==window.location.host.toLowerCase()||"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()}}},{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){-1!==window.location.search.indexOf("pN=cart")||window.location.search.indexOf("pN=congrats")}},negate:!0}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{
source:'// BINGUET\ntry\n{\n\t(function (w, d, t, r, u) {\n\t\tvar f,\n\t\tn,\n\t\ti;\n\t\tw[u] = w[u] || [],\n\t\tf = function () {\n\t\t\tvar o = {\n\t\t\t\tti: "4000034", navTimingApi:true  // set navTimingApi flag\n\t\t\t};\n\t\t\to.q = w[u],\n\t\t\tw[u] = new UET(o),\n\t\t\tw[u].push("pageLoad")\n\t\t},\n\t\tn = d.createElement(t),\n\t\tn.src = r,\n\t\tn.async = 1,\n\t\tn.onload = n.onreadystatechange = function () {\n\t\t\tvar s = this.readyState;\n\t\t\ts && s !== "loaded" && s !== "complete" || (f(), n.onload = n.onreadystatechange = null)\n\t\t},\n\t\ti = d.getElementsByTagName(t)[0],\n\t\ti.parentNode.insertBefore(n, i)\n\t})(window, document, "script", "//bat.bing.com/bat.js", "uetq");\n\n\tvar totamount = 0,\n\t  totvalstring = "",\n\t  googpagetype = "other",\n\t  prodstring = "",\n\t  img="";\n\tvar pagetypemap = {\n\t  // old : [new, eventname]\n\t  "home": ["general_visitor","page_view"],\n\t  "search": ["search_results","view_search_results"],\n\t  "detail": ["general_visitor","view_item"],\n\t  "category": ["general_visitor","view_item_list"],\n\t  "checkout_shopping_cart": ["cart","add_to_cart"],\n\t  "cart": ["cart","add_to_cart"],\n\t  "receipt": ["purchase","Purchase"]\n\t};\n\n\tvar lineitemObj={};\n\tvar itemsArray=[];\n\n\tvar tempobj = {};\n\tvar eventname="page_view";\n\n\tif (_TMDL.pageType && pagetypemap[_TMDL.pageType.toLowerCase()]) {\n\t\tgoogpagetype = pagetypemap[_TMDL.pageType.toLowerCase()][0];\n\t\teventname = pagetypemap[_TMDL.pageType.toLowerCase()][1];\n\t}\n\tfor (var i = 0; i < _TMDL.pids.length; i++) {\n\t  //TODO add name\n\t\titemsArray.push({\'id\' : _TMDL.pidsku[i], \'category\': (typeof _TMDL.dcmcat ==\'object\')?_TMDL.dcmcat[i]:\'\', \'price\' : _TMDL.sales[i], \'name\' : _TMDL.pnames[i]});\n\t\tif (parseFloat(_TMDL.sales[i]) > 0) {\n\t\t\ttotamount += parseFloat(_TMDL.sales[i]);\n\t\t}\n\t}\n    \n\tif (~window.location.pathname.indexOf("/b/")) {\n\t\tgoogpagetype="category";\n\t} else if (~window.location.pathname.indexOf("/p/")) {\n\t\tgoogpagetype="product";\n\t}\n    \n\twindow.uetq = window.uetq || [];\n\n\tif (_TMDL.pidsku.length > 0) {\n\t\ttempobj.ecomm_prodid = (_TMDL.pidsku.length>0) ? _TMDL.pidsku : "";\n\t\ttempobj.ecomm_pagetype = googpagetype;\n\t\t//tempobj.ecomm_items = itemsArray;\n\t\ttempobj.items = itemsArray;\n\t}\n\n\tif (~_TMDL.pageType.indexOf("cart") || ~_TMDL.pageType.indexOf("receipt")) {\n\t\ttempobj.currency = _TMDL.cc;\n\t\ttempobj.revenue_value = totamount;\n\t\ttempobj.transaction_id = _TMDL.purchaseID;\n\t}\n\n\twindow.uetq.push(\'event\',eventname, tempobj); \n}\ncatch(err)\n{\n\t_satellite.logger.error("BINGLPCVF");\t\n}\n\n',language:"javascript"}}]},{id:"RLf6485d219649415ab9f7aef1461c1c3a",name:"DCMLP",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"www.microsoft.com"==window.location.host.toLowerCase()}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'try\n{\n\tvar doFloodlights = function(debug) {\n\t\ttry {\n\t\t\t_TMDL.dcmcat = [];\n\n\t\t\tvar imgsrc1,imgsrc2,imgsrc3,imgscr4;\n\t\t\tvar\ta = "" + (Math.random() * 10000000000000);\n\t\t\tvar mc1 = "";\n\t\t\tvar pth = window.location.pathname.toLowerCase();\n\t\t\tvar pthmatch;\n\t\t\t\n\t\t\t// office and surface don\'t have the same structure for "cat" parameter\n\t\t\tvar landingpageCountFloodlights = {\n\t\t\t\t\twindowsdevices : "/src=8406115;type=wndv;cat=phy_std",\n\t\t\t\t\twindowssoftware : "/src=8406727;type=wsft;cat=phy_std",\n\t\t\t\t\tothersoftware : "/src=8406724;type=sftw;cat=phy_std",\n\t\t\t\t\tsurface : "/src=8400690;type=surf;cat=lp_phy",  // nonstandard\n\t\t\t\t\txboxplatform : "/src=8391491;type=xbxp;cat=phy_std",\n\t\t\t\t\txboxgames : "exclude",\n\t\t\t\t\txboxdesignlabs : "/src=8404966;type=xdl;cat=phy_std",\n\t\t\t\t\txboxgamepass : "/src=8406391;type=xgpg;cat=phy_std",\n\t\t\t\t\txboxlive : "/src=8391497;type=xlg;cat=phy_std",\n\t\t\t\t\thololens : "/src=8391509;type=hll;cat=phy_std",\n\t\t\t\t\toffice : "/src=8406097;type=ofco;cat=lpst_std",  // nonstandard\n\t\t\t\t\tminecraft : "exclude",\n\t\t\t\t\tother : "/src=8406157;type=stoth;cat=phy_std"\t\n\t\t\t};\n\n\t\t\tvar genericLandingpageFloodlights = {\n\t\t\t\t\twindowsdevices : "/src=8406115;type=wndv;cat=lp_std",\n\t\t\t\t\twindowssoftware : "exclude",\n\t\t\t\t\tothersoftware : "exclude",\n\t\t\t\t\tsurface : "/src=8400690;type=surf;cat=lp_std",  // nonstandard\n\t\t\t\t\txboxplatform : "/src=8391491;type=xbxp;cat=lp_std",\n\t\t\t\t\txboxgames : "/src=8406391;type=xbxgms;cat=lp_std",\n\t\t\t\t\txboxdesignlabs : "/src=8404966;type=xdl;cat=lp_std",\n\t\t\t\t\txboxgamepass : "/src=8406391;type=xgpg;cat=gplp_std",\n\t\t\t\t\txboxlive : "/src=8391497;type=xlg;cat=lp_std",\n\t\t\t\t\thololens : "/src=8391509;type=hll;cat=lp_std",\n\t\t\t\t\toffice : "exclude",  // nonstandard\n\t\t\t\t\tminecraft : "/src=8400687;type=mc;cat=lp_std",\n\t\t\t\t\tother : "exclude"\t\n\t\t\t};\n\t\t\t\n\t\t\tvar landingpageUniqueFloodlights = {\n\t\t\t\t\twindowsdevices : "/src=8406115;type=wndv;cat=phy_uni",\n\t\t\t\t\twindowssoftware : "/src=8406727;type=wsft;cat=phy_uni",\n\t\t\t\t\tothersoftware : "/src=8406724;type=sftw;cat=phy_uni",\n\t\t\t\t\tsurface : "/src=8400690;type=surf;cat=lp_uni",  // nonstandard\n\t\t\t\t\txboxplatform : "/src=8391491;type=xbxp;cat=phy_uni",\n\t\t\t\t\txboxgames : "exclude",\n\t\t\t\t\txboxdesignlabs : "/src=8404966;type=xdl;cat=phy_uni",\n\t\t\t\t\txboxgamepass : "/src=8406391;type=xgpg;cat=phy_uni",\n\t\t\t\t\txboxlive : "/src=8391497;type=xlg;cat=phy_uni",\n\t\t\t\t\thololens : "/src=8391509;type=hll;cat=phy_uni",\n\t\t\t\t\toffice : "/src=8406097;type=ofco;cat=lp_uni",  // nonstandard\n\t\t\t\t\tminecraft : "exclude",\n\t\t\t\t\tother : "exclude"\t\n\t\t\t};\n\n\t\t\t// only windowssoftware has a PrdCatVue tag (WindowsSoftware_GBL_PrdCatVue_Count_PhysicalStore)\n\t\t\tvar categoryFloodlights = {\n\t\t\t\t\twindowsdevices : "exclude",\n\t\t\t\t\twindowssoftware : "/src=8406727;type=wsft;cat=pdcv_phy",\n\t\t\t\t\tothersoftware : "exclude",\n\t\t\t\t\tsurface : "exclude",\n\t\t\t\t\txboxplatform : "exclude",\n\t\t\t\t\txboxgames : "exclude",\n\t\t\t\t\txboxdesignlabs : "exclude",\n\t\t\t\t\txboxgamepass : "exclude",\n\t\t\t\t\txboxlive : "exclude",\n\t\t\t\t\thololens : "exclude",\n\t\t\t\t\toffice : "exclude",\n\t\t\t\t\tminecraft : "exclude",\n\t\t\t\t\tother : "exclude"\t\n\t\t\t};\n\n\t\t\tvar pdpFloodlights = {\n\t\t\t\twindowsdevices : "/src=8406115;type=wndv;cat=prdv_std",  // nonstandard\n\t\t\t\twindowssoftware : "/src=8406727;type=wsft_sls;cat=pdv_phy",\n\t\t\t\tothersoftware : "/src=8406724;type=sftw_sls;cat=pdv_phy",\n\t\t\t\tsurface : "/src=8400690;type=surf;cat=prdv_std",  // nonstandard\n\t\t\t\txboxplatform : "/src=8391491;type=xbxp;cat=pdv_phy",\n\t\t\t\txboxgames : "xboxgames",\n\t\t\t\txboxdesignlabs : "/src=8404966;type=xdl_sls;cat=pdv_phy",\n\t\t\t\txboxgamepass : "/src=8406391;type=xgpg_sls;cat=pdv_phy",\n\t\t\t\txboxlive : "/src=8391497;type=xlg;cat=pdv_phy",\n\t\t\t\thololens : "/src=8391509;type=hll;cat=pdv_phy",\n\t\t\t\toffice : "/src=8406097;type=ofco;cat=prdv_std",  // nonstandard\n\t\t\t\tminecraft : "exclude",\n\t\t\t\tother : "exclude"\n\t\t\t};\n\t\t\t\n\t\t\tvar categoryCounts = {\n\t\t\t\twindowsdevices : 0,\n\t\t\t\twindowssoftware : 0,\n\t\t\t\tothersoftware : 0,\n\t\t\t\tsurface : 0,\n\t\t\t\txboxplatform : 0,\n\t\t\t\txboxgames : 0,\n\t\t\t\txboxdesignlabs : 0,\n\t\t\t\txboxgamepass : 0,\n\t\t\t\txboxlive : 0,\n\t\t\t\thololens : 0,\n\t\t\t\toffice : 0,\n\t\t\t\tminecraft : 0,\n\t\t\t\tother : 0\n\t\t\t};\n\t\t\t\n\t\t\tvar matchWindowBrand = function(pname) {\n\t\t\t\tvar brandnames = [\n\t\t\t\t\t["acer","windowsdevices"],\n\t\t\t\t\t["alienware","windowsdevices"],\n\t\t\t\t\t["asus","windowsdevices"],\n\t\t\t\t\t["cyberpowerpc","windowsdevices"],\n\t\t\t\t\t["dell","windowsdevices"],\n\t\t\t\t\t["hp","windowsdevices"],\n\t\t\t\t\t["huawei","windowsdevices"],\n\t\t\t\t\t["ibuypower","windowsdevices"],\n\t\t\t\t\t["lenovo","windowsdevices"],\n\t\t\t\t\t["linx","windowsdevices"],\n\t\t\t\t\t["logah","windowsdevices"],\n\t\t\t\t\t["millet","windowsdevices"],\n\t\t\t\t\t["porsche","windowsdevices"],\n\t\t\t\t\t["razer","windowsdevices"],\n\t\t\t\t\t["samsung","windowsdevices"],\n\t\t\t\t\t["toshiba","windowsdevices"],\n\t\t\t\t\t["/collections/laptops","windowsdevices"],\n\t\t\t\t\t["/store/b/pc","windowsdevices"],\t\t\n\t\t\t\t\t["/store/b/pc","windowsdevices"]\t\t\n\t\t\t\t];\n\t\t\t\tfor (var i=0; i<brandnames.length; i++){\n\t\t\t\t\tif (~pname.toLowerCase().indexOf(brandnames[i][0])) {\n\t\t\t\t\t\tif (debug) { console.log("matched windows brand");}\n\t\t\t\t\t\treturn brandnames[i][1];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t};\n\n\t\t\t// update pidlist\n\t\t\tvar pidlist={\n\t\t\t\t\n\t\t\t\'D76QX4BZNWK4\' : \'windowssoftware\',\n\t\t\t\'DF77X4D43RKT\' : \'windowssoftware\',\n\t\t\t\'DG7GMGF0DS12\' : \'windowssoftware\',\n\t\t\t\'DG7GMGF0DS1H\' : \'windowssoftware\',\n\t\t\t\n\t\t\t\'DG7GMGF0DST3\' : \'othersoftware\',\n\t\t\t\'DG7GMGF0DST4\' : \'othersoftware\',\n\t\t\t\'DG7GMGF0DST5\' : \'othersoftware\',\n\t\t\t\'DG7GMGF0DST6\' : \'othersoftware\',\n\t\t\t\'DG7GMGF0DWP2\' : \'othersoftware\',  \n\n\n\t\t\t\'8MB6CR05S1QD\' : \'xboxplatform\',\n\n\t\t\t\'8MC6K8M228SK\' : \'surface\',\n\t\t\t\'8MCPZJJCC98C\' : \'surface\',\n\t\t\t\'8N1V4QJ3GQ5X\' : \'surface\',\n\t\t\t\'8NKT9WTTRBJK\' : \'surface\',\n\t\t\t\'8RKCLMWPW1PP\' : \'surface\',\n\t\t\t\'8XCW9BBPVFV9\' : \'surface\',\n\t\t\t\'907TDS4DGWWV\' : \'surface\',\n\t\t\t\'90FC23DV6SNZ\' : \'surface\',\n\t\t\t\'93LTM69S3RFF\' : \'surface\',\n\n\t\t\t\'8XF18PQZ17TS\' : \'hololens\',\n\t\t\t\'90MDTZVL02K9\' : \'hololens\',\n\t\t\t\'944XGCF64Z5B\' : \'hololens\',\n\t\t\t\n\t\t\t\'900WZDF9XJVG\' : \'xboxdesignlabs\',\n\t\t\t\'93JLLWMDZ0V7\' : \'xboxdesignlabs\',\n\t\t\t\'941H3FP99RM3\' : \'xboxdesignlabs\',\n\t\t\t\'8TBJW32WJF8C\' : \'xboxdesignlabs\',\n\t\t\t\'90T6CGN08P38\' : \'xboxdesignlabs\',\n\t\t\t\'90K4SGTLSKML\' : \'xboxdesignlabs\',\n\t\t\t\'8VK59S4SSLWD\' : \'xboxdesignlabs\',\n\t\t\t\'8TVCQSJ7V6PT\' : \'xboxdesignlabs\',\n\t\t\t\'8T07Q5SRTV11\' : \'xboxdesignlabs\',\n\t\t\t\'8VKFWF7M03NJ\' : \'xboxdesignlabs\',\n\t\t\t\'90GBR9CZBHJ9\' : \'xboxdesignlabs\',\n\t\t\t\'9355VZP4KXB8\' : \'xboxdesignlabs\',\n\t\t\t\'8QT59S4FDX8Z\' : \'xboxdesignlabs\',\n\t\t\t\n\t\t\t\'CFQ7TTC0K5ZM\' : \'xboxlive\',\n\t\t\t\n\t\t\t\'CFQ7TTC0K5F8\' : \'office\',\n\t\t\t\'CFQ7TTC0K5FD\' : \'office\',\n\t\t\t\'CFQ7TTC0K5FF\' : \'office\',\n\t\t\t\'CFQ7TTC0K5BB\' : \'office\',\n\t\t\t\'CFQ7TTC0K5BC\' : \'office\',\n\t\t\t\'CFQ7TTC0K5BD\' : \'office\',\n\t\t\t\'8N0LL43Q1H85\' : \'office\',\n\t\t\t\'CFQ7TTC0K5DZ\' : \'office\',\n\t\t\t\'CFQ7TTC0K5F2\' : \'office\',\n\t\t\t\'CFQ7TTC0K5F3\' : \'office\',\n\t\t\t\'CFQ7TTC0K5BH\' : \'office\',\n\t\t\t\'CFQ7TTC0K5D6\' : \'office\',\n\t\t\t\'CFQ7TTC0K5D7\' : \'office\',\n\t\t\t\'CFQ7TTC0K5CD\' : \'office\',\n\t\t\t\'CFQ7TTC0K5CF\' : \'office\',\n\t\t\t\'CFQ7TTC0K5CP\' : \'office\',\n\t\t\t\'CFQ7TTC0K5CS\' : \'office\',\n\t\t\t\'CFQ7TTC0K5CT\' : \'office\',\n\t\t\t\'CFQ7TTC0K5D0\' : \'office\',\n\t\t\t\'CFQ7TTC0K5DN\' : \'office\',\n\t\t\t\'CFQ7TTC0K5DM\' : \'office\',\n\t\t\t\'CFQ7TTC0K5BF\' : \'office\',\n\t\t\t\'CFQ7TTC0K5FB\' : \'office\',\n\t\t\t\'CFQ7TTC0K5FC\' : \'office\',\n\t\t\t\n            // added 4/20/20 for alta\n            \'8PC5BJBHN74P\' : \'office\',\n            \'94CM694VJ57P\' : \'office\',\n            \'900RPBX20TS6\' : \'office\',\n            \'93R684WJ71VJ\' : \'office\',\n            \'8V9J0T4JFZ6W\' : \'office\',\n            \'8NFJC88FKMRZ\' : \'office\',\n            \'8SZWM812T6N1\' : \'office\',\n            \'CFQ7TTC0K5BG\' : \'office\',\n            \'8V883X3J1V40\' : \'office\',\n            // end alta\n              \n\t\t\t\'BPSWGQBW7R3G\': \'xboxplatform\',\n\t\t\t\'9NBLGGH4PBBM\': \'xboxplatform\', \n\n\n\t\t\t\'SHOULDNEVERMATCH\' : \'pc\'\n\t\t\t};\n\n\t\t\t// _TMDL.prdType and _TMDL.prdFam\n\t\t\t\n\t\t\tif ((~pth.indexOf("/d/") || ~pth.indexOf("/p/")) && _TMDL.pids && pidlist[_TMDL.pids[0]]) {\n\t\t\t\t// check pids for anything explicitly mapped\n\t\t\t\tcategoryCounts[pidlist[_TMDL.pids[0]]]++;\n\t\t\t\tif (debug) { console.log("matched PID", _TMDL.pids[0], pidlist[_TMDL.pids[0]]); }\n\t\t\t} else if (~pth.indexOf("surface") ) {\n\t\t\t\tcategoryCounts["surface"]++;\n\t\t\t} else if (~pth.indexOf("office") || ~pth.indexOf("o365")) {\n\t\t\t\tcategoryCounts["office"]++;\n\t\t\t} else if (~pth.indexOf("minecraft") ) {\n\t\t\t\tcategoryCounts["minecraft"]++;\n\t\t\t} else if (~pth.indexOf("xbox") ) {\n\t\t\t\tcategoryCounts["xboxplatform"]++;\n\t\t\t} else if (~pth.indexOf("hololens") ) {\n\t\t\t\tcategoryCounts["hololens"]++;\n\t\t\t} else {\n\t\t\t\tpthmatch = matchWindowBrand(pth);\n\t\t\t\tif (pthmatch) {\n\t\t\t\t\tcategoryCounts[pthmatch]++;\n\t\t\t\t} else {\n\t\t\t\t\t// TODO:  check if physical\n\t\t\t\t\tcategoryCounts["other"]++;\n\t\t\t\t}\n\t\t\t}\n\t\t\t\n\t\t\ttry {\n\t\t\t\tif (_TMutils.readCookie("MC1")) {\n\t\t\t\t\tmc1 = _TMutils.readCookie("MC1").split("&")[0].split("=")[1]; //use in u58\n\t\t\t\t}\n\t\t\t} catch(mc1err) {}\t\n\n\n\t\t\t/* set the floodlights based on the page */\n\t\t\tif (_TMDL.pageType=="receipt" || _TMDL.pageType=="congrats") {\n\t\t\t\tfloodlights = purchaseFloodlights;\n\t\t\t} else if (~_TMDL.pageType.indexOf("cart")) {\n\t\t\t\tfloodlights = cartFloodlights;\n\t\t\t}\n\t\t\t\n\t\t\tif(debug) {\tconsole.log(categoryCounts); }\n\n\t\t\tfor (key in categoryCounts) {\n\n\t\t\t\tif (categoryCounts[key]>0) {\t\t\n\t\t\t\t\tif (debug) {console.log(key,categoryCounts[key],landingpageUniqueFloodlights[key],"\\n");}\n\t\t\t\t\n\t\t\t\t\t// Activity Name: Store_AllProd_GBL_LandingPageVue_Unique_\n\t\t\t\t\tif (landingpageUniqueFloodlights[key] !== "exclude") {\n\t\t\t\t\t\timgsrc1 = "https://ad.doubleclick.net/ddm/activity"+landingpageUniqueFloodlights[key]+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t\t\t\t\t//+";u5="+encodeURIComponent(document.referrer)\n\t\t\t\t\t\t\t+";u6="+encodeURIComponent(_TMDL.pageName)\n\t\t\t\t\t\t\t+";u7="+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t\t\t+";u25="+_TMDL.pids+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u31="+_TMDL.cc+";u33="+_TMDL.pidsku\n\t\t\t\t\t\t\t+";u58="+mc1\n\t\t\t\t\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1;num="+a+"?";\n\t\t\t\t\t\timgsrc = imgsrc1;\n\t\t\t\t\t\tif (debug) { console.log(imgsrc1); }\n\t\t\t\t\t\tBootstrapper.imageRequest(imgsrc1);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\n\t\t\t\t\t/* Activity name of this tag: Store_AllProd_GBL_LandingPageVue_Count_  */\n\t\t\t\t\tif (landingpageCountFloodlights[key] !== "exclude") {\n\t\t\t\t\t\timgsrc2 = "https://ad.doubleclick.net/ddm/activity"+landingpageCountFloodlights[key]+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t\t\t\t\t+";u6="+encodeURIComponent(_TMDL.pageName)\n\t\t\t\t\t\t\t+";u7="+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t\t\t+";u25="+_TMDL.pids+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u31="+_TMDL.cc+";u33="+_TMDL.pidsku\n\t\t\t\t\t\t\t+";u58="+mc1\n\t\t\t\t\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1;num="+a+"?";\n\t\t\t\t\t\timgsrc = imgsrc2;\n\t\t\t\t\t\tif (debug) { console.log(imgsrc2); }\n\t\t\t\t\t\tBootstrapper.imageRequest(imgsrc2);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\t/*  genericLandingpageFloodlights  */\n\t\t\t\t\tif (genericLandingpageFloodlights[key] !== "exclude") {\n\t\t\t\t\t\timgsrc1 = "https://ad.doubleclick.net/ddm/activity"+genericLandingpageFloodlights[key]+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t\t\t\t\t//+";u5="+encodeURIComponent(document.referrer)\n\t\t\t\t\t\t\t+";u6="+encodeURIComponent(_TMDL.pageName)\n\t\t\t\t\t\t\t+";u7="+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t\t\t+";u25="+_TMDL.pids+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u31="+_TMDL.cc+";u33="+_TMDL.pidsku\n\t\t\t\t\t\t\t+";u58="+mc1\n\t\t\t\t\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord=1;num="+a+"?";\n\t\t\t\t\t\timgsrc = imgsrc1;\n\t\t\t\t\t\tif (debug) { console.log(imgsrc1); }\n\t\t\t\t\t\tBootstrapper.imageRequest(imgsrc1);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tif (_TMDL.pageType=="detail" && (~_TMDL.prdType[0].toLowerCase().indexOf("device") || ~_TMDL.prdType[0].toLowerCase().indexOf("pass"))) {\n\t\t\t\t\t\t_TMDL.dcmcat.push(key);\n\t\t\t\t\t\tif (pdpFloodlights[key] !== "exclude") {\n\t\t\t\t\t\t\t// Store_AllProd_GBL_PrdVue_Count_PhysicalStore\n\t\t\t\t\t\t\timgsrc3 = "https://ad.doubleclick.net/ddm/activity"+pdpFloodlights[key]+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t\t\t\t\t\t+";u6="+encodeURIComponent(_TMDL.pageName)\n\t\t\t\t\t\t\t\t+";u7="+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t\t\t\t+";u25="+_TMDL.pids+";u26="+encodeURIComponent(_TMDL.pnames)+";u32="+_TMDL.pids+";u33="+_TMDL.pidsku+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+a;\n\t\t\t\t\t\t\timgsrc = imgsrc3;\n\t\t\t\t\t\t\tBootstrapper.imageRequest(imgsrc3);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (~_TMDL.pageType.toLowerCase().indexOf("category") && ~window.location.pathname.indexOf("/b/")){\n\t\t\t\t\t\t_TMDL.dcmcat.push(key);\n\t\t\t\t\t\tif (categoryFloodlights[key] !== "exclude") {\n\t\t\t\t\t\t\timgsrc4 = "https://ad.doubleclick.net/ddm/activity"+categoryFloodlights[key]+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t\t\t\t\t\t+";u6="+encodeURIComponent(_TMDL.pageName)\n\t\t\t\t\t\t\t\t+";u7="+encodeURIComponent(window.location.pathname.toLowerCase())\n\t\t\t\t\t\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+a+"?";\n\t\t\t\t\t\t\timgsrc = imgsrc4;\n\t\t\t\t\t\t\tBootstrapper.imageRequest(imgsrc4);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif (debug) { console.log(_TMDL.dcmcat) ; }\n\t\t\t\t}\n\t\t\t}\n\t\t\n\t\t} catch(flerr) {\n\t\t\t_TMutils.logRuleCall("DCMLP err",flerr.name,flerr.message);\n\t\t}\n\n\t};\n\n\n\tvar pth = window.location.pathname.toLowerCase();\n\tvar debug = ~window.location.href.indexOf("debug") ? 1 : 0;\n\n\n\n\t// -----------------------------------------\n\t//   previously separate digital pages tags\n\t// -----------------------------------------\n\n\tvar _getMetaValue = function(name) {\n\t\t\treturn $(\'meta[name="\' + name + \'"]\').attr(\'content\');\n\t\t};\n\t\t\n\tvar fireDCM = function(params) {\n\t\tvar a, imgsrc1, imgsrc2;\n\t\ta = "" + (Math.random() * 10000000000000);\n\t\timgsrc1 = "https://ad.doubleclick.net/ddm/activity/"+params+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t+";u20="+_TMDL.pidsku\n\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+a+"?";\n\t\timgsrc = imgsrc1;\n\t\tBootstrapper.imageRequest(imgsrc1);\n\t\t\n\t\tif (debug) {console.log(params);}\n\t};\n\n\tvar matchXboxBrand = function(pname) {\n\t\tvar brandnames = [\n\t\t\t"forza",\n\t\t\t"call of duty",\n\t\t\t"tomb raider",\n\t\t\t"toy soldiers war chest",\n\t\t\t"red dead"\n\t\t\t];\n\t\tfor (var i=0; i<brandnames.length; i++){\n\t\t\tif (~pname.toLowerCase().indexOf(brandnames[i])) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t};\n\n\tvar pdpname = (_TMDL.pnames.length>0 && ~_TMDL.pnames[0]) ? _TMDL.pnames[0].toLowerCase() : "";\n\tvar isPhysicalPage = (~pth.indexOf("/store/") && pth.indexOf("/p/")<0) || (~pth.indexOf("/p/") && _TMDL.prdType[0]!=="Apps" && _TMDL.prdType[0]!=="Games");\n\tvar\ta = "" + (Math.random() * 10000000000000);\n\tvar configdeviceurl="",buildyourbundleurl="", checkeligibilityurl="", addtocarturl="";\n\tvar imgsrc="";\n\t\n\tif (isPhysicalPage) {doFloodlights(debug);}\n\n\tif (_TMDL.prdType=="Games" || _TMDL.prdType=="Passes" || _TMDL.prdType=="Apps") {\n\t\tif ( ~pth.indexOf("cfq7ttc0k5zm") || ~pth.indexOf("cfq7ttc0k5dj")) {\n\t\t\t// XboxLiveGold_GBL_PrdVue_Count_DigitalStore:  /src=8391497;type=xlg;cat=pdv_dgtl;\n\t\t\tfireDCM("src=8391497;type=xlg;cat=pdv_dgtl");  \n          $(document).on(\'mousedown\',\'button#buttons_AddToCartButton,button:contains("Buy"),a:contains("Buy"), button[id*="RedeemCodeButton"]\',\'\', function() {\n\t\t\t\t//console.log("AddToCart");  // XboxLiveGold_GBL_CartVue_Count_DigitalStore\n\t\t\t\tfireDCM("src=8391497;type=xlg;cat=crtd_std");\n\t\t\t});\n\t\t} else if (\t( _TMDL.prdType=="Games" && (_getMetaValue("ms\\\\.prod_worksonxbox")=="true" || matchXboxBrand(pdpname))) || (pth.indexOf("xbox") > -1) || ~pdpname.indexOf("xbox") ) {\n\t\t\t//XboxGamePassGames_GBL_PrdVue_Count_DigitalStore:  /src=8406391;type=xgpg;cat=pdv_dgtl;\n\t\t\t//console.log("XboxGamePassGames_GBL_PrdVue_Count_DigitalStore");\n\t\t\tfireDCM("src=8406391;type=xgpg;cat=pdv_dgtl");\n          $(document).on(\'mousedown\',\'button#buttons_AddToCartButton,button:contains("Buy"),a:contains("Buy"), button[id*="RedeemCodeButton"]\',\'\', function() {\n\t\t\t\t//console.log("AddToCart"); //XboxGamePassGames_GBL_CartVue_Count_DigitalStore\n\t\t\t\tfireDCM("src=8406391;type=xgpg;cat=crtd_std");\n\t\t\t});\n\t\t} else if (_TMDL.prdType=="Apps" || _TMDL.prdType=="Games") {\n\t\t\t//WindowsSoftware_GBL_PrdVue_Count_DigitalStore\n\t\t\t//console.log("WindowsSoftware_GBL_PrdVue_Count_DigitalStore");\n\t\t\tfireDCM("src=8406727;type=wsft;cat=pdv_dgtl");\n\t\t\t$(document).on(\'mousedown\',\'button#buttons_AddToCartButton,button:contains("Buy"),a:contains("Buy"), button[id*="RedeemCodeButton"]\',\'\', function() {\n\t\t\t\t//console.log("AddToCart"); //WindowsSoftware_GBL_CartVue_Count_DigitalStore\n\t\t\t\tfireDCM("src=8406727;type=wsft;cat=crtd_std");\n\t\t\t});\n\t\t}\n\t}\n\n\n\t// Surface Configure Device tag as Surface Learn More  (request from Ahmed Homsi)\n\tif (~window.location.pathname.toLowerCase().indexOf("surface") && ~window.location.pathname.toLowerCase().indexOf("/d/")) {\n\n\t\tconfigdeviceurl = "https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=lrn_std;u1="\n\t\t\t+_TMDL.geo\n\t\t\t+";u2="+_TMDL.ll\n\t\t\t+";u6="+encodeURIComponent(_TMDL.pagename)\n\t\t\t+";u25="+_TMDL.pids[0]\n\t\t\t+";u26="+encodeURIComponent(_TMDL.pnames[0])\n\t\t\t+";u50=Configure%20now"\n\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="\t+ a + "?";\n\t\timgsrc = configdeviceurl;\n\n\t\t// Configure Now CTA\n\t\t$(document).on(\'mousedown\',\'a:contains("Configure now"),button:contains("Configure now")\',\'\', function() {\n\t\t\tBootstrapper.imageRequest(configdeviceurl);\n\t\t});\n      \n      \tbuildyourbundleurl = "https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=lrn_std;u1="\n    \t\t+_TMDL.geo\n    \t\t+";u2="+_TMDL.ll\n    \t\t+";u6="+encodeURIComponent(_TMDL.pagename)\n    \t\t+";u25="+_TMDL.pids[0]\n    \t\t+";u26="+encodeURIComponent(_TMDL.pnames[0])\n    \t\t+";u50=BuildYourBundle"\n    \t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="\t+ a + "?";\n\n\n    \t// BuildYourBundle CTA\n        $(document).on(\'mousedown\',\'a:contains("Build your bundle"),button:contains("Build your bundle"),a[href*="/store/build/"]\',\'\', function() {\n    \t\tBootstrapper.imageRequest(buildyourbundleurl);\n    \t});\n      \n\t// Shop Now CTA from PDP (Surface_GBL_PchNow_Count_)  (src=8400690;type=surf;cat=pchn_std;)  added 5/6/19, modified 12/319 for exclusions\n\t$(document).on(\'mousedown\',\'div.pi-promotion-bar a\',\'\', function() {\n\t\tvar inScope=1;\n\t\ttry {\n\t\t\tif (~this.href.indexOf("/build/") || ~this.href.indexOf("student-discounts?successurl")) {\n\t\t\t\t_satellite.logger.log("out of scope");\n\t\t\t\tinScope=0;\n\t\t\t}\n\t\t} catch(shperr) {_satellite.logger.log("shopnow err");}\n\n\t\tif (inScope) { \n\t\t\tBootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="\n\t\t\t+_TMDL.geo\n\t\t\t+";u2="+_TMDL.ll\n\t\t\t+";u6="+encodeURIComponent(_TMDL.pagename)\n\t\t\t+";u25="+_TMDL.pids[0]\n\t\t\t+";u26="+encodeURIComponent(_TMDL.pnames[0])\n\t\t\t+";u50=ShopNow"\n\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="\t+ a + "?");\n\t\t}\n\t});\n\n        // added 12/2/19 to add in shop for business in non-promobar area\t\n        $(document).on(\'mousedown\',\'div.store-finance-offer a\',\'\', function() {\n                Bootstrapper.imageRequest("https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="\n                +_TMDL.geo\n                +";u2="+_TMDL.ll\n                +";u6="+encodeURIComponent(_TMDL.pagename)\n                +";u25="+_TMDL.pids[0]\n                +";u26="+encodeURIComponent(_TMDL.pnames[0])\n                +";u50=BusinessOffer"\n                +";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="\t+ a + "?");\n        });\n      \n        // check your eligibility CTA\n      \tcheckeligibilityurl = "https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=lrn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]\t+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=CheckYourEligibility;dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+a+"?";\n        $(document).on(\'mousedown\',"a[href*=\'student-discounts?successurl\']",\'\', function() {\n            Bootstrapper.imageRequest(checkeligibilityurl);\n        });\n      \n      \t// added 11/26/19\n\t\n        addtocarturl = "https://ad.doubleclick.net/ddm/activity/src=8400690;type=surf;cat=pchn_std;u1="+_TMDL.geo+";u2="+_TMDL.ll+";u6="+encodeURIComponent(_TMDL.pagename)+";u25="+_TMDL.pids[0]+";u26="+encodeURIComponent(_TMDL.pnames[0])+";u50=AddToCartClick"+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+ a + "?";\n\n        $(document).on(\'mousedown\',\'a:contains("Add to cart"),button:contains("Add to cart")\',\'\', function() {\n            Bootstrapper.imageRequest(addtocarturl);\n        });\t\n\t}\n}\ncatch(err)\n{\n\t_satellite.logger.error("DCM LP");\n}',language:"javascript"}}]},{id:"RLf78ee9c5c2c44d33972fc7ed9cab2aab",name:"GOOGCV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/* GOOGCV  */\nvar gclidstring = (_satellite.cookie.get("_tm_gclid"))? "&gclaw=" + _satellite.cookie.get("_tm_gclid") : "";\nvar googcvurl = "https://www.googleadservices.com/pagead/conversion/923371515/?value="+_TMDL.totamount\n\t+"&currency_code="+_TMDL.cc.toUpperCase()\n\t+gclidstring\n\t+"&label=yOJJCOecrGYQ-4-muAM&guid=ON&script=0";\n\n\t\nif (_TMDL.isprod) {\n\tBootstrapper.imageRequest(googcvurl);\n}\n\n',language:"javascript"}}]},{id:"RLff024ff211024496b1ca0dd8147087b9",name:"OffDCMCV",events:[{modulePath:"core/src/lib/events/pageBottom.js",settings:{},ruleOrder:60}],conditions:[{modulePath:"core/src/lib/conditions/customCode.js",settings:{source:function(){return"query.prod.cms.rt.microsoft.com"==window.location.host.toLowerCase()&&~window.location.search.indexOf("pN=congrats")}}}],actions:[{modulePath:"core/src/lib/actions/customCode.js",settings:{source:'/* Office DCM CV\n*/\ntry\n{\n\tvar a, imgsrc1, ps;\n\tvar inScope=0;\n\n\tvar mc1 = "";\n\tif (_TMutils.readCookie("MC1")) {\n\t\tmc1 = _TMutils.readCookie("MC1").split("&")[0].split("=")[1]; //use in u58\n\t}\n\n\tfor (var i=0; i<_TMDL.pidsku.length; i++) {\n\t\tps = _TMDL.pidsku[i].toUpperCase();\n\t\tif (ps=="CFQ7TTC0K5DM-007R" || ps=="CFQ7TTC0K5DM-007W"){\n\t\t\t// Home Annual\n\t\t\tinScope=1;\n\t\t} else if (ps=="CFQ7TTC0K5FB-0002" || ps=="CFQ7TTC0K5FC-0002" || ps=="CFQ7TTC0K5FB-000D" || ps=="CFQ7TTC0K5FC-000C") {\n\t\t\t// Home and Student 2016 (for Mac and Windows SKUs)\n\t\t\tinScope=1;\t\t\n\t\t} \n\t}\n\n\tif ((_TMDL.pageType=="receipt" || _TMDL.pageType=="congrats") && _TMDL.isprod && inScope==1) {\n\t\ta = "" + (Math.random() * 10000000000000);\n\t\timgsrc1 = "https://ad.doubleclick.net/ddm/activity/src=6952136;type=store00;cat=zzzst0;qty=1;cost="+_TMDL.totamount+";u1="+_TMDL.geo.toUpperCase()+";u2="+_TMDL.ll\n\t\t\t//+";u5="+encodeURIComponent(document.referrer)\n\t\t\t+";u25="+_TMDL.pids.join("_")\n\t\t\t+";u26="+encodeURIComponent(_TMDL.pnames.join("_"))\n\t\t\t+";u58="+mc1\n\t\t\t+";u31="+_TMDL.cc+";u32="+_TMDL.pids.join("_")+";u33="+_TMDL.pidsku.join("_")+";u34="+_TMDL.purchaseID+";u35="+_TMDL.totqty\n\t\t\t+";u39="+_TMDL.sales.join("_")+";u40="+_TMDL.quantities.join("_")\n\t\t\t+";dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;ord="+_TMDL.purchaseID+"?";\n\t\t//console.log(imgsrc1);\n\t\tBootstrapper.imageRequest(imgsrc1);\n\t\t\n\t\t// added 6/18/2018\n\t\tBootstrapper.imageRequest("//www.googleadservices.com/pagead/conversion/862646735/?value=1.00&currency_code=USD&label=KXsqCL2B2nEQz-OrmwM&uid=ON&script=0");\n\t}\n}\ncatch(err)\n{\n\tif (typeof(_TMutils) !== "undefined") {_TMutils.logRuleCall("OffDCMCV",err.message,imgsrc1);}\n\t_satellite.logger.error("OffDCMCV");\t\n}\n\n\n',language:"javascript"}}]}]};var _satellite=function(){"use strict";function t(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}function e(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(""))return!1;var o={};return"abcdefghijklmnopqrst".split("").forEach((function(t){o[t]=t})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},o)).join("")}catch(t){return!1}}function n(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach((function(n){var o=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,o.get?o:{enumerable:!0,get:function(){return t[n]}})})),e}function o(t){var e={exports:{}};return t(e,e.exports),e.exports}function a(t){var e=this.constructor;return this.then((function(n){return e.resolve(t()).then((function(){return n}))}),(function(n){return e.resolve(t()).then((function(){return e.reject(n)}))}))}function r(t){return Boolean(t&&void 0!==t.length)}function s(){}function i(t,e){return function(){t.apply(e,arguments)}}function c(t){if(!(this instanceof c))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],g(t,this)}function d(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,c._immediateFn((function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var o;try{o=n(t._value)}catch(t){return void l(e.promise,t)}u(e.promise,o)}else(1===t._state?u:l)(e.promise,t._value)}))):t._deferreds.push(e)}function u(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof c)return t._state=3,t._value=e,void p(t);if("function"==typeof n)return void g(i(n,e),t)}t._state=1,t._value=e,p(t)}catch(e){l(t,e)}}function l(t,e){t._state=2,t._value=e,p(t)}function p(t){2===t._state&&0===t._deferreds.length&&c._immediateFn((function(){t._handled||c._unhandledRejectionFn(t._value)}));for(var e=0,n=t._deferreds.length;e<n;e++)d(t,t._deferreds[e]);t._deferreds=null}function m(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function g(t,e){var n=!1;try{t((function(t){n||(n=!0,u(e,t))}),(function(t){n||(n=!0,l(e,t))}))}catch(t){if(n)return;n=!0,l(e,t)}}function f(t){return!0===Ut(t)&&"[object Object]"===Object.prototype.toString.call(t)}function h(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function _(t){return"string"==typeof t&&-1!==t.indexOf("[")&&-1!==t.indexOf("]")}function v(t){return t.substr(0,t.indexOf("["))}function b(t,e,n){if(t.length&&Nt(e)){var o=t[0];if(1!==t.length){var a=t.slice(1);if(!_(o))return b(a,e[o],n);var r=e[o=v(o)];Array.isArray(r)&&r.forEach((function(t){return b(a,t,n)}))}else e.hasOwnProperty(o)&&"string"==typeof e[o]&&(e[o]=n(e[o]))}}if(window.atob){var T=document,w=Object.getOwnPropertySymbols,y=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable,x=e()?Object.assign:function(e){for(var n,o,a=t(e),r=1;r<arguments.length;r++){for(var s in n=Object(arguments[r]))y.call(n,s)&&(a[s]=n[s]);if(w){o=w(n);for(var i=0;i<o.length;i++)C.call(n,o[i])&&(a[o[i]]=n[o[i]])}}return a},L=x,D=window,M=function(t,e,n,o){
var a,r=Boolean(e&&Array.isArray(n)),s=Boolean(r&&t),i=document.createElement("a");if(r){var c=function(){var t=new Error("Unable to find the Library Embed Code for Dynamic Host Resolution.");throw t.code="dynamic_host_resolver_constructor_error",t};if(t&&(/^((https?:)?\/\/).+/.test(t)||c(),/^\/\/.+/.test(t)?i.href=D.location.protocol+t:i.href=t),i.hostname||c(),-1===n.indexOf(i.hostname)){var d=new Error("This library is not authorized for this domain. Please contact your CSM for more information.");throw d.code="dynamic_host_not_allowed",d}}var u=function(){if(null!=a)return a;if(s){var t=i.host;/:80$/.test(t)?t=t.replace(":80",""):/:80\/$/.test(t)?t=t.replace(":80/",""):/:443$/.test(t)?t=t.replace(":443",""):/:443\/$/.test(t)&&(t=t.replace(":443/","")),a=i.protocol+"//"+t}else a="";return a},l=function(t){return s&&"string"==typeof t?[u(),"/"===t.charAt(0)?t.slice(1):t].join("/"):t},p={getTurbineHost:u,decorateWithDynamicHost:l,get isDynamicEnforced(){return r}};return D&&o.onDebugChanged((function(t){t?D.dynamicHostResolver=p:delete D.dynamicHostResolver})),p},I=function(t){var e=[];return t.forEach((function(t){t.events&&t.events.forEach((function(n){e.push({rule:t,event:n})}))})),e.sort((function(t,e){return t.event.ruleOrder-e.event.ruleOrder}))},R="debug",k=function(t,e){var n=function(){return"true"===t.getItem(R)},o=function(e){t.setItem(R,e)},a=[],r=function(t){a.push(t)};return e.outputEnabled=n(),{onDebugChanged:r,getDebugEnabled:n,setDebugEnabled:function(t){n()!==t&&(o(t),e.outputEnabled=t,a.forEach((function(e){e(t)})))}}},P="Module did not export a function.",j=function(t,e,n){return function(o,a,r){r=r||[];var s=t.getModuleExports(o.modulePath);if("function"!=typeof s)throw new Error(P);var i=t.getModuleDefinition(o.modulePath),c=o.settings||{};!o.hasTransformedFilePaths&&i.filePaths&&(n(c,i.filePaths,o.modulePath),o.hasTransformedFilePaths=!0);var d=e(c,a);return s.bind(null,d).apply(null,r)}},S=function(t){return"string"==typeof t?t.replace(/\s+/g," ").trim():t},B={LOG:"log",INFO:"info",DEBUG:"debug",WARN:"warn",ERROR:"error"},O="\ud83d\ude80",A=10===parseInt((/msie (\d+)/.exec(navigator.userAgent.toLowerCase())||[])[1])?"[Launch]":O,E=!1,q=function(t){if(E&&window.console){var e=Array.prototype.slice.call(arguments,1);e.unshift(A),t!==B.DEBUG||window.console[t]||(t=B.INFO),window.console[t].apply(window.console,e)}},F=q.bind(null,B.LOG),U=q.bind(null,B.INFO),N=q.bind(null,B.DEBUG),Q=q.bind(null,B.WARN),G=q.bind(null,B.ERROR),K=function(){var t=E;E=!0,q.apply(null,Array.prototype.concat(B.WARN,Array.prototype.slice.call(arguments))),t||(E=!1)},V={log:F,info:U,debug:N,warn:Q,error:G,deprecation:K,get outputEnabled(){return E},set outputEnabled(t){E=t},createPrefixedLogger:function(t){var e="["+t+"]";return{log:F.bind(null,e),info:U.bind(null,e),debug:N.bind(null,e),warn:Q.bind(null,e),error:G.bind(null,e)}}},H="com.adobe.reactor.",W=function(t,e){var n=H+(e||"");return{getItem:function(e){try{return D[t].getItem(n+e)}catch(t){return null}},setItem:function(e,o){try{return D[t].setItem(n+e,o),!0}catch(t){return!1}}}},z="dataElements.",Z=W("sessionStorage",z),X=W("localStorage",z),$={PAGEVIEW:"pageview",SESSION:"session",VISITOR:"visitor"},J={},Y=function(t){var e;try{e=JSON.stringify(t)}catch(t){}return e},tt={setValue:function(t,e,n){var o;switch(e){case $.PAGEVIEW:return void(J[t]=n);case $.SESSION:return void((o=Y(n))&&Z.setItem(t,o));case $.VISITOR:return void((o=Y(n))&&X.setItem(t,o))}},getValue:function(t,e){var n;switch(e){case $.PAGEVIEW:return J.hasOwnProperty(t)?J[t]:null;case $.SESSION:return null===(n=Z.getItem(t))?n:JSON.parse(n);case $.VISITOR:return null===(n=X.getItem(t))?n:JSON.parse(n)}}},et=function(t,e,n,o){return"Failed to execute data element module "+t.modulePath+" for data element "+e+". "+n+(o?"\n"+o:"")},nt=function(t,e,n,o,a){return function(r,s){var i=e(r);if(!i)return o?"":void 0;var c,d,u=i.storageDuration;try{c=t.getModuleExports(i.modulePath),d=t.getModuleDefinition(i.modulePath)}catch(t){return void V.error(et(i,r,t.message,t.stack))}if("function"==typeof c){var l,p=i.settings||{};!i.hasTransformedFilePaths&&d.filePaths&&(a(p,d.filePaths,i.modulePath),i.hasTransformedFilePaths=!0);try{l=c(n(p,s),s)}catch(t){return void V.error(et(i,r,t.message,t.stack))}return u&&(null!=l?tt.setValue(r,u,l):l=tt.getValue(r,u)),null==l&&null!=i.defaultValue&&(l=i.defaultValue),"string"==typeof l&&(i.cleanText&&(l=S(l)),i.forceLowerCase&&(l=l.toLowerCase())),l}V.error(et(i,r,"Module did not export a function."))}},ot={text:function(t){return t.textContent},cleanText:function(t){return S(t.textContent)}},at=function(t,e,n){for(var o,a=t,r=0,s=e.length;r<s;r++){if(null==a)return;var i=e[r];if(n&&"@"===i.charAt(0)){var c=i.slice(1);a=ot[c](a)}else if(a.getAttribute&&(o=i.match(/^getAttribute\((.+)\)$/))){var d=o[1];a=a.getAttribute(d)}else a=a[i]}return a},rt=function(t,e,n){return function(o,a){var r;if(e(o))r=n(o,a);else{var s=o.split("."),i=s.shift();"this"===i?a&&(r=at(a.element,s,!0)):"event"===i?a&&(r=at(a,s)):"target"===i?a&&(r=at(a.target,s)):r=at(t[i],s)}return r}},st=function(t,e){return function(n){var o=n.split(".")[0];return Boolean(e(n)||"this"===o||"event"===o||"target"===o||t.hasOwnProperty(o))}},it=function(t,e,n){var o={exports:{}};return t.call(o.exports,o,o.exports,e,n),o.exports},ct=function(){var t={},e=function(e){var n=t[e];if(!n)throw new Error("Module "+e+" not found.");return n},n=function(){Object.keys(t).forEach((function(t){try{o(t)}catch(n){var e="Error initializing module "+t+". "+n.message+(n.stack?"\n"+n.stack:"");V.error(e)}}))},o=function(t){var n=e(t);return n.hasOwnProperty("exports")||(n.exports=it(n.definition.script,n.require,n.turbine)),n.exports};return{registerModule:function(e,n,o,a,r){var s={definition:n,extensionName:o,require:a,turbine:r};s.require=a,t[e]=s},hydrateCache:n,getModuleExports:o,getModuleDefinition:function(t){return e(t).definition},getModuleExtensionName:function(t){return e(t).extensionName}}},dt=!1,ut=function(t){return function(e,n){var o=t._monitors;o&&(dt||(V.warn("The _satellite._monitors API may change at any time and should only be used for debugging."),dt=!0),o.forEach((function(t){t[e]&&t[e](n)})))}},lt=function(t,e,n){var o,a,r,s,i=[],c=function(o,a,r){if(!t(a))return o;i.push(a);var s=e(a,r);return i.pop(),null==s&&n?"":s};return o=function(t,e){var n=/^%([^%]+)%$/.exec(t);return n?c(t,n[1],e):t.replace(/%(.+?)%/g,(function(t,n){return c(t,n,e)}))},a=function(t,e){for(var n={},o=Object.keys(t),a=0;a<o.length;a++){var r=o[a],i=t[r];n[r]=s(i,e)}return n},r=function(t,e){for(var n=[],o=0,a=t.length;o<a;o++)n.push(s(t[o],e));return n},s=function(t,e){return"string"==typeof t?o(t,e):Array.isArray(t)?r(t,e):"object"==typeof t&&null!==t?a(t,e):t},function(t,e){return i.length>10?(V.error("Data element circular reference detected: "+i.join(" -> ")),t):s(t,e)}},pt=function(t){return function(){if("string"==typeof arguments[0])t[arguments[0]]=arguments[1];else if(arguments[0]){var e=arguments[0];for(var n in e)t[n]=e[n]}}},mt="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},gt=setTimeout;c.prototype.catch=function(t){return this.then(null,t)},c.prototype.then=function(t,e){var n=new this.constructor(s);return d(this,new m(t,e,n)),n},c.prototype.finally=a,c.all=function(t){return new c((function(e,n){function o(t,r){try{if(r&&("object"==typeof r||"function"==typeof r)){var i=r.then;if("function"==typeof i)return void i.call(r,(function(e){o(t,e)}),n)}a[t]=r,0==--s&&e(a)}catch(t){n(t)}}if(!r(t))return n(new TypeError("Promise.all accepts an array"));var a=Array.prototype.slice.call(t);if(0===a.length)return e([]);for(var s=a.length,i=0;i<a.length;i++)o(i,a[i])}))},c.resolve=function(t){return t&&"object"==typeof t&&t.constructor===c?t:new c((function(e){e(t)}))},c.reject=function(t){return new c((function(e,n){n(t)}))},c.race=function(t){return new c((function(e,n){if(!r(t))return n(new TypeError("Promise.race accepts an array"));for(var o=0,a=t.length;o<a;o++)c.resolve(t[o]).then(e,n)}))},c._immediateFn="function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){gt(t,0)},c._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};var ft=n(Object.freeze({__proto__:null,default:c})),ht="undefined"!=typeof window&&window.Promise||void 0!==mt&&mt.Promise||ft.default||ft,_t=function(t,e,n){return function(o,a,r,s){return s.then((function(){var s,i=o.delayNext;return new ht((function(e,n){var a=t(o,r,[r]);if(!i)return e();var c=o.timeout,d=new ht((function(t,e){s=setTimeout((function(){e(new Error("A timeout occurred because the action took longer than "+c/1e3+" seconds to complete. "))}),c)}));ht.race([a,d]).then(e,n)})).catch((function(t){return clearTimeout(s),t=e(t),n(o,a,t),ht.reject(t)})).then((function(){clearTimeout(s)}))}))}},vt=function(t,e,n,o,a){return function(r,s,i,c){return c.then((function(){var c;return new ht((function(e,n){var o=t(r,i,[i]),a=r.timeout,s=new ht((function(t,e){c=setTimeout((function(){e(new Error("A timeout occurred because the condition took longer than "+a/1e3+" seconds to complete. "))}),a)}));ht.race([o,s]).then(e,n)})).catch((function(t){return clearTimeout(c),t=e(t),o(r,s,t),ht.reject(t)})).then((function(t){if(clearTimeout(c),!n(r,t))return a(r,s),ht.reject()}))}))}},bt=ht.resolve(),Tt=function(t,e,n){return function(o,a){return o.conditions&&o.conditions.forEach((function(e){bt=t(e,o,a,bt)})),o.actions&&o.actions.forEach((function(t){bt=e(t,o,a,bt)})),bt=(bt=bt.then((function(){n(o)}))).catch((function(){}))}},wt=function(t){return Boolean(t&&"object"==typeof t&&"function"==typeof t.then)},yt=function(t,e,n,o){return function(a,r){var s;if(a.conditions)for(var i=0;i<a.conditions.length;i++){s=a.conditions[i];try{var c=t(s,r,[r]);if(wt(c))throw new Error("Rule component sequencing must be enabled on the property for this condition to function properly.");if(!e(s,c))return n(s,a),!1}catch(t){return o(s,a,t),!1}}return!0}},Ct=function(t,e){return function(n,o){t(n,o)&&e(n,o)}},xt=function(t){return function(e){var n=t.getModuleDefinition(e.modulePath);return n&&n.displayName||e.modulePath}},Lt=function(t){return function(e){var n=e.rule,o=e.event,a=t.getModuleDefinition(o.modulePath).name;return{$type:t.getModuleExtensionName(o.modulePath)+"."+a,$rule:{id:n.id,name:n.name}}}},Dt=function(t,e,n,o,a,r){return function(s,i){var c=i.rule,d=i.event;d.settings=d.settings||{};try{var u=a(i);e(d,null,[function(e){var o=n(u,e);s((function(){t(o,c)}))}])}catch(t){r.error(o(d,c,t))}}},Mt=function(t,e,n,o){return function(a,r,s){var i=e(a);n.error(t(i,r.name,s)),o("ruleActionFailed",{rule:r,action:a})}},It=function(t,e,n,o){return function(a,r,s){var i=e(a);n.error(t(i,r.name,s)),o("ruleConditionFailed",{rule:r,condition:a})}},Rt=function(t,e,n){return function(o,a){var r=t(o);e.log('Condition "'+r+'" for rule "'+a.name+'" was not met.'),n("ruleConditionFailed",{rule:a,condition:o})}},kt=function(t,e){return function(n){t.log('Rule "'+n.name+'" fired.'),e("ruleCompleted",{rule:n})}},Pt=function(t,e,n){return function(o,a){var r;if(o.actions)for(var s=0;s<o.actions.length;s++){r=o.actions[s];try{t(r,a,[a])}catch(t){return void e(r,o,t)}}n(o)}},jt=function(t,e,n,o){return function(a,r){o("ruleTriggered",{rule:r}),t?n(r,a):e(r,a)}},St=function(t,e,n){return'Failed to execute "'+t+'" for "'+e+'" rule. '+n.message+(n.stack?"\n"+n.stack:"")},Bt=function(t,e){return e&&!t.negate||!e&&t.negate},Ot=[],At=!1,Et=function(t){At?t():Ot.push(t)},qt=function(t,e,n){t(e).forEach((function(t){n(Et,t)})),At=!0,Ot.forEach((function(t){t()})),Ot=[]},Ft=function(t){if(t||(t=new Error("The extension triggered an error, but no error information was provided.")),!(t instanceof Error)){var e="object"==typeof t?JSON.stringify(t):String(t);t=new Error(e)}return t},Ut=function(t){return null!=t&&"object"==typeof t&&!1===Array.isArray(t)},Nt=function(t){var e,n;return!1!==f(t)&&("function"==typeof(e=t.constructor)&&(!1!==f(n=e.prototype)&&!1!==n.hasOwnProperty("isPrototypeOf")))},Qt=function(t,e){return Nt(e=e||{})?e=L({},e,t):L(e,t),e.hasOwnProperty("type")||Object.defineProperty(e,"type",{get:function(){return V.deprecation("Accessing event.type in Adobe Launch has been deprecated and will be removed soon. Please use event.$type instead."),e.$type}}),e},Gt=function(t,e){return function(n,o){var a=t[n];if(a){var r=a.modules;if(r)for(var s=Object.keys(r),i=0;i<s.length;i++){var c=s[i],d=r[c];if(d.shared&&d.name===o)return e.getModuleExports(c)}}}},Kt=function(t,e){return function(){return e?t(e):{}}},Vt=function(t,e,n){return function(o){if(n){var a=o.split(".");a.splice(a.length-1||1,0,"min"),o=a.join(".")}return t(e)+o}},Ht=".js",Wt=function(t){return t.substr(0,t.lastIndexOf("/"))},zt=function(t,e){return-1!==t.indexOf(e,t.length-e.length)},Zt=function(t,e){zt(e,Ht)||(e+=Ht);var n=e.split("/"),o=Wt(t).split("/");return n.forEach((function(t){t&&"."!==t&&(".."===t?o.length&&o.pop():o.push(t))})),o.join("/")},Xt=o((function(t){!function(e){if(t.exports=e(),!!0){var n=window.Cookies,o=window.Cookies=e();o.noConflict=function(){return window.Cookies=n,o}}}((function(){function t(){for(var t=0,e={};t<arguments.length;t++){var n=arguments[t];for(var o in n)e[o]=n[o]}return e}function e(t){return t.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}function n(o){function a(){}function r(e,n,r){if("undefined"!=typeof document){"number"==typeof(r=t({path:"/"},a.defaults,r)).expires&&(r.expires=new Date(1*new Date+864e5*r.expires)),r.expires=r.expires?r.expires.toUTCString():"";try{var s=JSON.stringify(n);/^[\{\[]/.test(s)&&(n=s)}catch(t){}n=o.write?o.write(n,e):encodeURIComponent(String(n)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var i="";for(var c in r)r[c]&&(i+="; "+c,!0!==r[c]&&(i+="="+r[c].split(";")[0]));return document.cookie=e+"="+n+i}}function s(t,n){if("undefined"!=typeof document){for(var a={},r=document.cookie?document.cookie.split("; "):[],s=0;s<r.length;s++){var i=r[s].split("="),c=i.slice(1).join("=");n||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var d=e(i[0]);if(c=(o.read||o)(c,d)||e(c),n)try{c=JSON.parse(c)}catch(t){}if(a[d]=c,t===d)break}catch(t){}}return t?a[t]:a}}return a.set=r,a.get=function(t){return s(t,!1)},a.getJSON=function(t){return s(t,!0)},a.remove=function(e,n){r(e,"",t(n,{expires:-1}))},a.defaults={},a.withConverter=n,a}return n((function(){}))}))})),$t={get:Xt.get,set:Xt.set,remove:Xt.remove},Jt=function(t,e){return new ht((function(n,o){e.onload=function(){n(e)},e.onerror=function(){o(new Error("Failed to load script "+t))}}))},Yt=function(t){var e=document.createElement("script");e.src=t,e.async=!0;var n=Jt(t,e);return document.getElementsByTagName("head")[0].appendChild(e),n},te=function(t,e,n,o){e=e||"&",n=n||"=";var a={};if("string"!=typeof t||0===t.length)return a;var r=/\+/g;t=t.split(e);var s=1e3;o&&"number"==typeof o.maxKeys&&(s=o.maxKeys);var i=t.length;s>0&&i>s&&(i=s);for(var c=0;c<i;++c){var d,u,l,p,m=t[c].replace(r,"%20"),g=m.indexOf(n);g>=0?(d=m.substr(0,g),u=m.substr(g+1)):(d=m,u=""),l=decodeURIComponent(d),p=decodeURIComponent(u),h(a,l)?Array.isArray(a[l])?a[l].push(p):a[l]=[a[l],p]:a[l]=p}return a},ee=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}},ne=function(t,e,n,o){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map((function(o){var a=encodeURIComponent(ee(o))+n;return Array.isArray(t[o])?t[o].map((function(t){return a+encodeURIComponent(ee(t))})).join(e):a+encodeURIComponent(ee(t[o]))})).join(e):o?encodeURIComponent(ee(o))+n+encodeURIComponent(ee(t)):""},oe=o((function(t,e){e.decode=e.parse=te,e.encode=e.stringify=ne})),ae="@adobe/reactor-",re={cookie:$t,document:T,"load-script":Yt,"object-assign":L,promise:ht,"query-string":{parse:function(t){return"string"==typeof t&&(t=t.trim().replace(/^[?#&]/,"")),oe.parse(t)},stringify:function(t){return oe.stringify(t)}},window:D},se=function(t){return function(e){if(0===e.indexOf(ae)){var n=e.substr(ae.length),o=re[n];if(o)return o}if(0===e.indexOf("./")||0===e.indexOf("../"))return t(e);throw new Error('Cannot resolve module "'+e+'".')}},ie=function(t,e,n,o,a,r,s){var i=t.extensions,c=t.buildInfo,d=t.environment,u=t.property.settings;if(i){var l=Gt(i,e);Object.keys(i).forEach((function(p){var m=i[p],g=m.settings;Array.isArray(m.filePaths)&&(g=r(g,m.filePaths));var f=Kt(o,g);if(m.modules){var h=V.createPrefixedLogger(m.displayName),_=Vt(s,m.hostedLibFilesBaseUrl,c.minified),v={buildInfo:c,environment:d,property:{name:t.property.name,id:t.property.id},getDataElementValue:a,getExtensionSettings:f,getHostedLibFileUrl:_,getSharedModule:l,logger:h,propertySettings:u,replaceTokens:o,onDebugChanged:n.onDebugChanged,get debugEnabled(){return n.getDebugEnabled()}};Object.keys(m.modules).forEach((function(t){var n=m.modules[t],o=se((function(n){var o=Zt(t,n);return e.getModuleExports(o)}));e.registerModule(t,n,p,o,v)}))}})),e.hydrateCache()}return e},ce=function(t,e,n,o,a){var r=V.createPrefixedLogger("Custom Script");t.track=function(t){V.log('"'+t+'" does not match any direct call identifiers.')},t.getVisitorId=function(){return null},t.property={name:e.property.name,id:e.property.id},t.company=e.company,t.buildInfo=e.buildInfo,t.environment=e.environment,t.logger=r,t.notify=function(t,e){switch(V.deprecation("_satellite.notify is deprecated. Please use the `_satellite.logger` API."),e){case 3:r.info(t);break;case 4:r.warn(t);break;case 5:r.error(t);break;default:r.log(t)}},t.getVar=o,t.setVar=a,t.setCookie=function(t,e,n){var o="",a={};n&&(o=", { expires: "+n+" }",a.expires=n);var r='_satellite.setCookie is deprecated. Please use _satellite.cookie.set("'+t+'", "'+e+'"'+o+").";V.deprecation(r),$t.set(t,e,a)},t.readCookie=function(t){return V.deprecation('_satellite.readCookie is deprecated. Please use _satellite.cookie.get("'+t+'").'),$t.get(t)},t.removeCookie=function(t){V.deprecation('_satellite.removeCookie is deprecated. Please use _satellite.cookie.remove("'+t+'").'),$t.remove(t)},t.cookie=$t,t.pageBottom=function(){},t.setDebug=n;var s=!1;Object.defineProperty(t,"_container",{get:function(){return s||(V.warn("_satellite._container may change at any time and should only be used for debugging."),s=!0),e}})},de=function(t,e){return function(n,o,a){return t&&Nt(n)&&Object.keys(n).length&&Array.isArray(o)&&o.length?(o.forEach((function(t){Boolean(null!=a&&/^core\/.*actions.*\/customCode\.js$/.test(a))&&"source"===t&&!n.isExternal||b(t.split("."),n,e)})),n):n}},ue=window._satellite;if(ue&&!window.__satelliteLoaded){window.__satelliteLoaded=!0;var le=ue.container;delete ue.container;var pe=L({},le.buildInfo);Object.defineProperty(pe,"environment",{get:function(){return V.deprecation("container.buildInfo.environment is deprecated.Please use `container.environment.stage` instead"),le.environment.stage}}),le.buildInfo=pe;var me,ge=k(W("localStorage"),V),fe="";T.currentScript&&T.currentScript.getAttribute("src")&&(fe=T.currentScript.getAttribute("src"));try{me=M(fe,Boolean(le.company.dynamicCdnEnabled),le.company.cdnAllowList,ge)}catch(t){throw V.warn("Please review the following error:"),t}var he,_e=de(me.isDynamicEnforced,me.decorateWithDynamicHost),ve=ct(),be=le.property.settings.undefinedVarsReturnEmpty,Te=le.property.settings.ruleComponentSequencingEnabled,we=le.dataElements||{},ye=function(t){return we[t]},Ce=function(){return he.apply(null,arguments)},xe=nt(ve,ye,Ce,be,_e),Le={},De=pt(Le),Me=st(Le,ye),Ie=rt(Le,ye,xe);he=lt(Me,Ie,be),ce(ue,le,ge.setDebugEnabled,Ie,De),ie(le,ve,ge,he,xe,_e,me.decorateWithDynamicHost);var Re=ut(ue),ke=j(ve,he,_e),Pe=xt(ve),je=Rt(Pe,V,Re),Se=It(St,Pe,V,Re),Be=Mt(St,Pe,V,Re),Oe=kt(V,Re),Ae=Dt(jt(Te,Ct(yt(ke,Bt,je,Se),Pt(ke,Be,Oe)),Tt(vt(ke,Ft,Bt,Se,je),_t(ke,Ft,Be),Oe),Re),ke,Qt,St,Lt(ve),V);qt(I,le.rules||[],Ae)}return ue}console.warn("Adobe Launch is unsupported in IE 9 and below.")}();